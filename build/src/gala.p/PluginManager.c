/* PluginManager.c generated by valac 0.56.17, the Vala compiler
 * generated from PluginManager.vala, do not modify */

/**/
/*  Copyright (C) 2014 Tom Beckmann*/
/**/
/*  This program is free software: you can redistribute it and/or modify*/
/*  it under the terms of the GNU General Public License as published by*/
/*  the Free Software Foundation, either version 3 of the License, or*/
/*  (at your option) any later version.*/
/**/
/*  This program is distributed in the hope that it will be useful,*/
/*  but WITHOUT ANY WARRANTY; without even the implied warranty of*/
/*  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the*/
/*  GNU General Public License for more details.*/
/**/
/*  You should have received a copy of the GNU General Public License*/
/*  along with this program.  If not, see <http://www.gnu.org/licenses/>.*/
/**/

#include <glib.h>
#include <glib-object.h>
#include <X11/Xlib.h>
#include <stdlib.h>
#include <string.h>
#include "gala.h"
#include <gio/gio.h>
#include <gee.h>
#include <gmodule.h>
#include "config.h"
#include <mtk/mtk.h>

#if !defined(VALA_STRICT_C)
#if !defined(__clang__) && defined(__GNUC__) && (__GNUC__ >= 14)
#pragma GCC diagnostic warning "-Wincompatible-pointer-types"
#elif defined(__clang__) && (__clang_major__ >= 16)
#pragma clang diagnostic ignored "-Wincompatible-function-pointer-types"
#pragma clang diagnostic ignored "-Wincompatible-pointer-types"
#endif
#endif
#if !defined(VALA_EXTERN)
#if defined(_MSC_VER)
#define VALA_EXTERN __declspec(dllexport) extern
#elif __GNUC__ >= 4
#define VALA_EXTERN __attribute__((visibility("default"))) extern
#else
#define VALA_EXTERN extern
#endif
#endif

typedef void (*GalaRegisterPluginFunction) (GalaPluginInfo* result, gpointer user_data);

#define GALA_TYPE_PLUGIN_MANAGER (gala_plugin_manager_get_type ())
#define GALA_PLUGIN_MANAGER(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), GALA_TYPE_PLUGIN_MANAGER, GalaPluginManager))
#define GALA_PLUGIN_MANAGER_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), GALA_TYPE_PLUGIN_MANAGER, GalaPluginManagerClass))
#define GALA_IS_PLUGIN_MANAGER(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), GALA_TYPE_PLUGIN_MANAGER))
#define GALA_IS_PLUGIN_MANAGER_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), GALA_TYPE_PLUGIN_MANAGER))
#define GALA_PLUGIN_MANAGER_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), GALA_TYPE_PLUGIN_MANAGER, GalaPluginManagerClass))

typedef struct _GalaPluginManager GalaPluginManager;
typedef struct _GalaPluginManagerClass GalaPluginManagerClass;
typedef struct _GalaPluginManagerPrivate GalaPluginManagerPrivate;
enum  {
	GALA_PLUGIN_MANAGER_0_PROPERTY,
	GALA_PLUGIN_MANAGER_INITIALIZED_PROPERTY,
	GALA_PLUGIN_MANAGER_WINDOW_SWITCHER_PROVIDER_PROPERTY,
	GALA_PLUGIN_MANAGER_WINDOW_OVERVIEW_PROVIDER_PROPERTY,
	GALA_PLUGIN_MANAGER_WORKSPACE_VIEW_PROVIDER_PROPERTY,
	GALA_PLUGIN_MANAGER_NUM_PROPERTIES
};
static GParamSpec* gala_plugin_manager_properties[GALA_PLUGIN_MANAGER_NUM_PROPERTIES];
#define _g_free0(var) (var = (g_free (var), NULL))
#define _g_hash_table_unref0(var) ((var == NULL) ? NULL : (var = (g_hash_table_unref (var), NULL)))
#define _g_object_unref0(var) ((var == NULL) ? NULL : (var = (g_object_unref (var), NULL)))
#define _g_error_free0(var) ((var == NULL) ? NULL : (var = (g_error_free (var), NULL)))
#define _g_module_close0(var) ((var == NULL) ? NULL : (var = (g_module_close (var), NULL)))
#define __vala_GalaPluginInfo_free0(var) ((var == NULL) ? NULL : (var = (_vala_GalaPluginInfo_free (var), NULL)))
typedef struct _Block4Data Block4Data;
enum  {
	GALA_PLUGIN_MANAGER_REGIONS_CHANGED_SIGNAL,
	GALA_PLUGIN_MANAGER_NUM_SIGNALS
};
static guint gala_plugin_manager_signals[GALA_PLUGIN_MANAGER_NUM_SIGNALS] = {0};

struct _GalaPluginManager {
	GObject parent_instance;
	GalaPluginManagerPrivate * priv;
};

struct _GalaPluginManagerClass {
	GObjectClass parent_class;
};

struct _GalaPluginManagerPrivate {
	gboolean _initialized;
	XRectangle* _regions;
	gint _regions_length1;
	gint __regions_size_;
	gchar* _window_switcher_provider;
	gchar* _window_overview_provider;
	gchar* _workspace_view_provider;
	GHashTable* plugins;
	GFile* plugin_dir;
	GalaWindowManager* wm;
	GeeLinkedList* load_later_plugins;
};

struct _Block4Data {
	int _ref_count_;
	GalaPluginManager* self;
	XRectangle* regions;
	gint regions_length1;
	gint _regions_size_;
};

static gint GalaPluginManager_private_offset;
static gpointer gala_plugin_manager_parent_class = NULL;
static GalaPluginManager* gala_plugin_manager_instance;
static GalaPluginManager* gala_plugin_manager_instance = NULL;

VALA_EXTERN GType gala_plugin_manager_get_type (void) G_GNUC_CONST ;
G_DEFINE_AUTOPTR_CLEANUP_FUNC (GalaPluginManager, g_object_unref)
VALA_EXTERN GalaPluginManager* gala_plugin_manager_get_default (void);
static GalaPluginManager* gala_plugin_manager_new (void);
static GalaPluginManager* gala_plugin_manager_construct (GType object_type);
VALA_EXTERN XRectangle* gala_plugin_manager_get_regions (GalaPluginManager* self,
                                             gint* result_length1);
static void _g_free0_ (gpointer var);
static void _g_object_unref0_ (gpointer var);
static GalaPluginInfo* _gala_plugin_info_dup (GalaPluginInfo* self);
static void _vala_GalaPluginInfo_free (GalaPluginInfo* self);
static gboolean gala_plugin_manager_load_module (GalaPluginManager* self,
                                          const gchar* plugin_name);
static void ___lambda11_ (GalaPluginManager* self,
                   GFile* file,
                   GFile* other_file,
                   GFileMonitorEvent type);
static void ____lambda11__g_file_monitor_changed (GFileMonitor* _sender,
                                           GFile* file,
                                           GFile* other_file,
                                           GFileMonitorEvent event_type,
                                           gpointer self);
static gboolean gala_plugin_manager_check_provides (GalaPluginManager* self,
                                             const gchar* name,
                                             GalaPluginFunction provides);
VALA_EXTERN gboolean gala_plugin_manager_get_initialized (GalaPluginManager* self);
static void gala_plugin_manager_load_plugin_class (GalaPluginManager* self,
                                            GalaPluginInfo* info);
static void gala_plugin_manager_initialize_plugin (GalaPluginManager* self,
                                            const gchar* plugin_name,
                                            GalaPlugin* plugin);
static void gala_plugin_manager_recalculate_regions (GalaPluginManager* self);
static void _gala_plugin_manager_recalculate_regions_gala_plugin_region_changed (GalaPlugin* _sender,
                                                                          gpointer self);
VALA_EXTERN const gchar* gala_plugin_manager_get_workspace_view_provider (GalaPluginManager* self);
static void gala_plugin_manager_set_workspace_view_provider (GalaPluginManager* self,
                                                      const gchar* value);
VALA_EXTERN const gchar* gala_plugin_manager_get_window_overview_provider (GalaPluginManager* self);
static void gala_plugin_manager_set_window_overview_provider (GalaPluginManager* self,
                                                       const gchar* value);
VALA_EXTERN const gchar* gala_plugin_manager_get_window_switcher_provider (GalaPluginManager* self);
static void gala_plugin_manager_set_window_switcher_provider (GalaPluginManager* self,
                                                       const gchar* value);
VALA_EXTERN void gala_plugin_manager_initialize (GalaPluginManager* self,
                                     GalaWindowManager* _wm);
static void _gala_plugin_manager_initialize_plugin_gh_func (gconstpointer key,
                                                     gconstpointer value,
                                                     gpointer self);
static void gala_plugin_manager_set_initialized (GalaPluginManager* self,
                                          gboolean value);
VALA_EXTERN void gala_plugin_manager_load_waiting_plugins (GalaPluginManager* self);
VALA_EXTERN GalaPlugin* gala_plugin_manager_get_plugin (GalaPluginManager* self,
                                            const gchar* id);
static Block4Data* block4_data_ref (Block4Data* _data4_);
static void block4_data_unref (void * _userdata_);
static void __lambda10_ (Block4Data* _data4_,
                  const gchar* name,
                  GalaPlugin* plugin);
static void _vala_array_add9 (XRectangle* * array,
                       gint* length,
                       gint* size,
                       XRectangle value);
static void ___lambda10__gh_func (gconstpointer key,
                           gconstpointer value,
                           gpointer self);
static XRectangle* _vala_array_dup1 (XRectangle* self,
                              gssize length);
static void gala_plugin_manager_finalize (GObject * obj);
static GType gala_plugin_manager_get_type_once (void);
static void _vala_gala_plugin_manager_get_property (GObject * object,
                                             guint property_id,
                                             GValue * value,
                                             GParamSpec * pspec);
static void _vala_gala_plugin_manager_set_property (GObject * object,
                                             guint property_id,
                                             const GValue * value,
                                             GParamSpec * pspec);

static inline gpointer
gala_plugin_manager_get_instance_private (GalaPluginManager* self)
{
	return G_STRUCT_MEMBER_P (self, GalaPluginManager_private_offset);
}

GalaPluginManager*
gala_plugin_manager_get_default (void)
{
	GalaPluginManager* _tmp0_;
	GalaPluginManager* _tmp2_;
	GalaPluginManager* result;
#line 24 "../src/PluginManager.vala"
	_tmp0_ = gala_plugin_manager_instance;
#line 24 "../src/PluginManager.vala"
	if (_tmp0_ == NULL) {
#line 216 "PluginManager.c"
		GalaPluginManager* _tmp1_;
#line 25 "../src/PluginManager.vala"
		_tmp1_ = gala_plugin_manager_new ();
#line 25 "../src/PluginManager.vala"
		_g_object_unref0 (gala_plugin_manager_instance);
#line 25 "../src/PluginManager.vala"
		gala_plugin_manager_instance = _tmp1_;
#line 224 "PluginManager.c"
	}
#line 27 "../src/PluginManager.vala"
	_tmp2_ = gala_plugin_manager_instance;
#line 27 "../src/PluginManager.vala"
	result = _tmp2_;
#line 27 "../src/PluginManager.vala"
	return result;
#line 232 "PluginManager.c"
}

XRectangle*
gala_plugin_manager_get_regions (GalaPluginManager* self,
                                 gint* result_length1)
{
	XRectangle* _tmp0_;
	gint _tmp0__length1;
	XRectangle* _tmp1_;
	gint _tmp1__length1;
	XRectangle* result;
#line 35 "../src/PluginManager.vala"
	g_return_val_if_fail (self != NULL, NULL);
#line 36 "../src/PluginManager.vala"
	_tmp0_ = self->priv->_regions;
#line 36 "../src/PluginManager.vala"
	_tmp0__length1 = self->priv->_regions_length1;
#line 36 "../src/PluginManager.vala"
	_tmp1_ = _tmp0_;
#line 36 "../src/PluginManager.vala"
	_tmp1__length1 = _tmp0__length1;
#line 36 "../src/PluginManager.vala"
	if (result_length1) {
#line 36 "../src/PluginManager.vala"
		*result_length1 = _tmp1__length1;
#line 258 "PluginManager.c"
	}
#line 36 "../src/PluginManager.vala"
	result = _tmp1_;
#line 36 "../src/PluginManager.vala"
	return result;
#line 264 "PluginManager.c"
}

static void
_g_free0_ (gpointer var)
{
#line 51 "../src/PluginManager.vala"
	var = (g_free (var), NULL);
#line 272 "PluginManager.c"
}

static void
_g_object_unref0_ (gpointer var)
{
#line 51 "../src/PluginManager.vala"
	(var == NULL) ? NULL : (var = (g_object_unref (var), NULL));
#line 280 "PluginManager.c"
}

static GalaPluginInfo*
_gala_plugin_info_dup (GalaPluginInfo* self)
{
	GalaPluginInfo* dup;
#line 52 "../src/PluginManager.vala"
	dup = g_new0 (GalaPluginInfo, 1);
#line 52 "../src/PluginManager.vala"
	gala_plugin_info_copy (self, dup);
#line 52 "../src/PluginManager.vala"
	return dup;
#line 293 "PluginManager.c"
}

static void
_vala_GalaPluginInfo_free (GalaPluginInfo* self)
{
#line 52 "../src/PluginManager.vala"
	gala_plugin_info_destroy (self);
#line 52 "../src/PluginManager.vala"
	g_free (self);
#line 303 "PluginManager.c"
}

static void
___lambda11_ (GalaPluginManager* self,
              GFile* file,
              GFile* other_file,
              GFileMonitorEvent type)
{
#line 76 "../src/PluginManager.vala"
	g_return_if_fail (file != NULL);
#line 77 "../src/PluginManager.vala"
	if (type == G_FILE_MONITOR_EVENT_CREATED) {
#line 316 "PluginManager.c"
		gchar* _tmp0_;
		gchar* _tmp1_;
#line 78 "../src/PluginManager.vala"
		_tmp0_ = g_file_get_basename (file);
#line 78 "../src/PluginManager.vala"
		_tmp1_ = _tmp0_;
#line 78 "../src/PluginManager.vala"
		gala_plugin_manager_load_module (self, _tmp1_);
#line 78 "../src/PluginManager.vala"
		_g_free0 (_tmp1_);
#line 327 "PluginManager.c"
	}
}

static void
____lambda11__g_file_monitor_changed (GFileMonitor* _sender,
                                      GFile* file,
                                      GFile* other_file,
                                      GFileMonitorEvent event_type,
                                      gpointer self)
{
#line 76 "../src/PluginManager.vala"
	___lambda11_ ((GalaPluginManager*) self, file, other_file, event_type);
#line 340 "PluginManager.c"
}

static GalaPluginManager*
gala_plugin_manager_construct (GType object_type)
{
	GalaPluginManager * self = NULL;
	GHashFunc _tmp0_;
	GEqualFunc _tmp1_;
	GHashTable* _tmp2_;
	GeeLinkedList* _tmp3_;
	GFile* _tmp4_;
	GFile* _tmp5_;
	GError* _inner_error0_ = NULL;
#line 50 "../src/PluginManager.vala"
	self = (GalaPluginManager*) g_object_new (object_type, NULL);
#line 51 "../src/PluginManager.vala"
	_tmp0_ = g_str_hash;
#line 51 "../src/PluginManager.vala"
	_tmp1_ = g_str_equal;
#line 51 "../src/PluginManager.vala"
	_tmp2_ = g_hash_table_new_full (_tmp0_, _tmp1_, _g_free0_, _g_object_unref0_);
#line 51 "../src/PluginManager.vala"
	_g_hash_table_unref0 (self->priv->plugins);
#line 51 "../src/PluginManager.vala"
	self->priv->plugins = _tmp2_;
#line 52 "../src/PluginManager.vala"
	_tmp3_ = gee_linked_list_new (GALA_TYPE_PLUGIN_INFO, (GBoxedCopyFunc) _gala_plugin_info_dup, (GDestroyNotify) _vala_GalaPluginInfo_free, NULL, NULL, NULL);
#line 52 "../src/PluginManager.vala"
	_g_object_unref0 (self->priv->load_later_plugins);
#line 52 "../src/PluginManager.vala"
	self->priv->load_later_plugins = _tmp3_;
#line 54 "../src/PluginManager.vala"
	if (!g_module_supported ()) {
#line 55 "../src/PluginManager.vala"
		g_warning ("PluginManager.vala:55: Modules are not supported on this platform");
#line 56 "../src/PluginManager.vala"
		return self;
#line 378 "PluginManager.c"
	}
#line 59 "../src/PluginManager.vala"
	_tmp4_ = g_file_new_for_path (PLUGINDIR);
#line 59 "../src/PluginManager.vala"
	_g_object_unref0 (self->priv->plugin_dir);
#line 59 "../src/PluginManager.vala"
	self->priv->plugin_dir = _tmp4_;
#line 60 "../src/PluginManager.vala"
	_tmp5_ = self->priv->plugin_dir;
#line 60 "../src/PluginManager.vala"
	if (!g_file_query_exists (_tmp5_, NULL)) {
#line 61 "../src/PluginManager.vala"
		return self;
#line 392 "PluginManager.c"
	}
	{
		GFileEnumerator* enumerator = NULL;
		GFile* _tmp6_;
		GFileEnumerator* _tmp7_;
		GFileInfo* info = NULL;
#line 64 "../src/PluginManager.vala"
		_tmp6_ = self->priv->plugin_dir;
#line 64 "../src/PluginManager.vala"
		_tmp7_ = g_file_enumerate_children (_tmp6_, G_FILE_ATTRIBUTE_STANDARD_NAME "," G_FILE_ATTRIBUTE_STANDARD_CONTENT_TYPE, 0, NULL, &_inner_error0_);
#line 64 "../src/PluginManager.vala"
		enumerator = _tmp7_;
#line 64 "../src/PluginManager.vala"
		if (G_UNLIKELY (_inner_error0_ != NULL)) {
#line 407 "PluginManager.c"
			goto __catch0_g_error;
		}
#line 67 "../src/PluginManager.vala"
		while (TRUE) {
#line 412 "PluginManager.c"
			GFileInfo* _tmp8_ = NULL;
			GFileEnumerator* _tmp9_;
			GFileInfo* _tmp10_;
			GFileInfo* _tmp11_;
			GFileInfo* _tmp12_;
			GFileInfo* _tmp13_;
			const gchar* _tmp14_;
#line 67 "../src/PluginManager.vala"
			_tmp9_ = enumerator;
#line 67 "../src/PluginManager.vala"
			_tmp10_ = g_file_enumerator_next_file (_tmp9_, NULL, &_inner_error0_);
#line 67 "../src/PluginManager.vala"
			_tmp8_ = _tmp10_;
#line 67 "../src/PluginManager.vala"
			if (G_UNLIKELY (_inner_error0_ != NULL)) {
#line 67 "../src/PluginManager.vala"
				_g_object_unref0 (info);
#line 67 "../src/PluginManager.vala"
				_g_object_unref0 (enumerator);
#line 432 "PluginManager.c"
				goto __catch0_g_error;
			}
#line 67 "../src/PluginManager.vala"
			_tmp11_ = _tmp8_;
#line 67 "../src/PluginManager.vala"
			_tmp8_ = NULL;
#line 67 "../src/PluginManager.vala"
			_g_object_unref0 (info);
#line 67 "../src/PluginManager.vala"
			info = _tmp11_;
#line 67 "../src/PluginManager.vala"
			_tmp12_ = info;
#line 67 "../src/PluginManager.vala"
			if (!(_tmp12_ != NULL)) {
#line 67 "../src/PluginManager.vala"
				_g_object_unref0 (_tmp8_);
#line 67 "../src/PluginManager.vala"
				break;
#line 451 "PluginManager.c"
			}
#line 68 "../src/PluginManager.vala"
			_tmp13_ = info;
#line 68 "../src/PluginManager.vala"
			_tmp14_ = g_file_info_get_content_type (_tmp13_);
#line 68 "../src/PluginManager.vala"
			if (g_strcmp0 (_tmp14_, "application/x-sharedlib") == 0) {
#line 459 "PluginManager.c"
				GFileInfo* _tmp15_;
				const gchar* _tmp16_;
#line 69 "../src/PluginManager.vala"
				_tmp15_ = info;
#line 69 "../src/PluginManager.vala"
				_tmp16_ = g_file_info_get_name (_tmp15_);
#line 69 "../src/PluginManager.vala"
				gala_plugin_manager_load_module (self, _tmp16_);
#line 468 "PluginManager.c"
			}
#line 67 "../src/PluginManager.vala"
			_g_object_unref0 (_tmp8_);
#line 472 "PluginManager.c"
		}
#line 63 "../src/PluginManager.vala"
		_g_object_unref0 (info);
#line 63 "../src/PluginManager.vala"
		_g_object_unref0 (enumerator);
#line 478 "PluginManager.c"
	}
	goto __finally0;
	__catch0_g_error:
	{
		GError* e = NULL;
		GError* _tmp17_;
		const gchar* _tmp18_;
#line 63 "../src/PluginManager.vala"
		e = _inner_error0_;
#line 63 "../src/PluginManager.vala"
		_inner_error0_ = NULL;
#line 72 "../src/PluginManager.vala"
		_tmp17_ = e;
#line 72 "../src/PluginManager.vala"
		_tmp18_ = _tmp17_->message;
#line 72 "../src/PluginManager.vala"
		g_warning ("PluginManager.vala:72: %s", _tmp18_);
#line 63 "../src/PluginManager.vala"
		_g_error_free0 (e);
#line 498 "PluginManager.c"
	}
	__finally0:
#line 63 "../src/PluginManager.vala"
	if (G_UNLIKELY (_inner_error0_ != NULL)) {
#line 63 "../src/PluginManager.vala"
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error0_->message, g_quark_to_string (_inner_error0_->domain), _inner_error0_->code);
#line 63 "../src/PluginManager.vala"
		g_clear_error (&_inner_error0_);
#line 63 "../src/PluginManager.vala"
		return NULL;
#line 509 "PluginManager.c"
	}
	{
		GFileMonitor* _tmp19_ = NULL;
		GFile* _tmp20_;
		GFileMonitor* _tmp21_;
#line 76 "../src/PluginManager.vala"
		_tmp20_ = self->priv->plugin_dir;
#line 76 "../src/PluginManager.vala"
		_tmp21_ = g_file_monitor_directory (_tmp20_, G_FILE_MONITOR_NONE, NULL, &_inner_error0_);
#line 76 "../src/PluginManager.vala"
		_tmp19_ = _tmp21_;
#line 76 "../src/PluginManager.vala"
		if (G_UNLIKELY (_inner_error0_ != NULL)) {
#line 523 "PluginManager.c"
			goto __catch1_g_error;
		}
#line 76 "../src/PluginManager.vala"
		g_signal_connect_object (_tmp19_, "changed", (GCallback) ____lambda11__g_file_monitor_changed, self, 0);
#line 75 "../src/PluginManager.vala"
		_g_object_unref0 (_tmp19_);
#line 530 "PluginManager.c"
	}
	goto __finally1;
	__catch1_g_error:
	{
		GError* e = NULL;
		GError* _tmp22_;
		const gchar* _tmp23_;
#line 75 "../src/PluginManager.vala"
		e = _inner_error0_;
#line 75 "../src/PluginManager.vala"
		_inner_error0_ = NULL;
#line 82 "../src/PluginManager.vala"
		_tmp22_ = e;
#line 82 "../src/PluginManager.vala"
		_tmp23_ = _tmp22_->message;
#line 82 "../src/PluginManager.vala"
		g_warning ("PluginManager.vala:82: %s", _tmp23_);
#line 75 "../src/PluginManager.vala"
		_g_error_free0 (e);
#line 550 "PluginManager.c"
	}
	__finally1:
#line 75 "../src/PluginManager.vala"
	if (G_UNLIKELY (_inner_error0_ != NULL)) {
#line 75 "../src/PluginManager.vala"
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error0_->message, g_quark_to_string (_inner_error0_->domain), _inner_error0_->code);
#line 75 "../src/PluginManager.vala"
		g_clear_error (&_inner_error0_);
#line 75 "../src/PluginManager.vala"
		return NULL;
#line 561 "PluginManager.c"
	}
#line 50 "../src/PluginManager.vala"
	return self;
#line 565 "PluginManager.c"
}

static GalaPluginManager*
gala_plugin_manager_new (void)
{
#line 50 "../src/PluginManager.vala"
	return gala_plugin_manager_construct (GALA_TYPE_PLUGIN_MANAGER);
#line 573 "PluginManager.c"
}

static gboolean
gala_plugin_manager_load_module (GalaPluginManager* self,
                                 const gchar* plugin_name)
{
	gchar* path = NULL;
	GFile* _tmp0_;
	gchar* _tmp1_;
	gchar* _tmp2_;
	gchar* _tmp3_;
	gchar* _tmp4_;
	GModule* module = NULL;
	const gchar* _tmp5_;
	GModule* _tmp6_;
	GModule* _tmp7_;
	void* function = NULL;
	GModule* _tmp9_;
	void* _tmp10_ = NULL;
	void* _tmp11_;
	GalaRegisterPluginFunction _register_ = NULL;
	void* _tmp12_;
	gpointer _register__target;
	GalaPluginInfo info = {0};
	GalaRegisterPluginFunction _tmp13_;
	gpointer _tmp13__target;
	GalaPluginInfo _tmp14_ = {0};
	GalaPluginInfo _tmp15_;
	GalaPluginInfo _tmp16_;
	const gchar* _tmp17_;
	GalaPluginInfo _tmp18_;
	gchar* _tmp19_;
	GModule* _tmp20_;
	gboolean _tmp21_ = FALSE;
	GalaPluginInfo _tmp22_;
	gboolean result;
#line 86 "../src/PluginManager.vala"
	g_return_val_if_fail (self != NULL, FALSE);
#line 86 "../src/PluginManager.vala"
	g_return_val_if_fail (plugin_name != NULL, FALSE);
#line 87 "../src/PluginManager.vala"
	_tmp0_ = self->priv->plugin_dir;
#line 87 "../src/PluginManager.vala"
	_tmp1_ = g_file_get_path (_tmp0_);
#line 87 "../src/PluginManager.vala"
	_tmp2_ = _tmp1_;
#line 87 "../src/PluginManager.vala"
	_tmp3_ = g_module_build_path (_tmp2_, plugin_name);
#line 87 "../src/PluginManager.vala"
	_tmp4_ = _tmp3_;
#line 87 "../src/PluginManager.vala"
	_g_free0 (_tmp2_);
#line 87 "../src/PluginManager.vala"
	path = _tmp4_;
#line 88 "../src/PluginManager.vala"
	_tmp5_ = path;
#line 88 "../src/PluginManager.vala"
	_tmp6_ = g_module_open (_tmp5_, G_MODULE_BIND_LOCAL);
#line 88 "../src/PluginManager.vala"
	module = _tmp6_;
#line 89 "../src/PluginManager.vala"
	_tmp7_ = module;
#line 89 "../src/PluginManager.vala"
	if (_tmp7_ == NULL) {
#line 638 "PluginManager.c"
		const gchar* _tmp8_;
#line 90 "../src/PluginManager.vala"
		_tmp8_ = g_module_error ();
#line 90 "../src/PluginManager.vala"
		g_warning ("PluginManager.vala:90: %s", _tmp8_);
#line 91 "../src/PluginManager.vala"
		result = FALSE;
#line 91 "../src/PluginManager.vala"
		_g_module_close0 (module);
#line 91 "../src/PluginManager.vala"
		_g_free0 (path);
#line 91 "../src/PluginManager.vala"
		return result;
#line 652 "PluginManager.c"
	}
#line 95 "../src/PluginManager.vala"
	_tmp9_ = module;
#line 95 "../src/PluginManager.vala"
	g_module_symbol (_tmp9_, "register_plugin", &_tmp10_);
#line 95 "../src/PluginManager.vala"
	function = _tmp10_;
#line 96 "../src/PluginManager.vala"
	_tmp11_ = function;
#line 96 "../src/PluginManager.vala"
	if (_tmp11_ == NULL) {
#line 97 "../src/PluginManager.vala"
		g_warning ("PluginManager.vala:97: %s failed to register: register_plugin() functi" \
"on not found", plugin_name);
#line 98 "../src/PluginManager.vala"
		result = FALSE;
#line 98 "../src/PluginManager.vala"
		_g_module_close0 (module);
#line 98 "../src/PluginManager.vala"
		_g_free0 (path);
#line 98 "../src/PluginManager.vala"
		return result;
#line 674 "PluginManager.c"
	}
#line 100 "../src/PluginManager.vala"
	_tmp12_ = function;
#line 100 "../src/PluginManager.vala"
	_register_ = (GalaRegisterPluginFunction) _tmp12_;
#line 100 "../src/PluginManager.vala"
	_register__target = NULL;
#line 102 "../src/PluginManager.vala"
	_tmp13_ = _register_;
#line 102 "../src/PluginManager.vala"
	_tmp13__target = _register__target;
#line 102 "../src/PluginManager.vala"
	_tmp13_ (&_tmp14_, _tmp13__target);
#line 102 "../src/PluginManager.vala"
	info = _tmp14_;
#line 103 "../src/PluginManager.vala"
	_tmp15_ = info;
#line 103 "../src/PluginManager.vala"
	if (g_type_is_a (_tmp15_.plugin_type, GALA_TYPE_PLUGIN) == FALSE) {
#line 104 "../src/PluginManager.vala"
		g_warning ("PluginManager.vala:104: %s does not return a class of type Plugin", plugin_name);
#line 105 "../src/PluginManager.vala"
		result = FALSE;
#line 105 "../src/PluginManager.vala"
		gala_plugin_info_destroy (&info);
#line 105 "../src/PluginManager.vala"
		_g_module_close0 (module);
#line 105 "../src/PluginManager.vala"
		_g_free0 (path);
#line 105 "../src/PluginManager.vala"
		return result;
#line 706 "PluginManager.c"
	}
#line 108 "../src/PluginManager.vala"
	_tmp16_ = info;
#line 108 "../src/PluginManager.vala"
	_tmp17_ = _tmp16_.name;
#line 108 "../src/PluginManager.vala"
	_tmp18_ = info;
#line 108 "../src/PluginManager.vala"
	if (!gala_plugin_manager_check_provides (self, _tmp17_, _tmp18_.provides)) {
#line 109 "../src/PluginManager.vala"
		result = FALSE;
#line 109 "../src/PluginManager.vala"
		gala_plugin_info_destroy (&info);
#line 109 "../src/PluginManager.vala"
		_g_module_close0 (module);
#line 109 "../src/PluginManager.vala"
		_g_free0 (path);
#line 109 "../src/PluginManager.vala"
		return result;
#line 726 "PluginManager.c"
	}
#line 112 "../src/PluginManager.vala"
	_tmp19_ = g_strdup (plugin_name);
#line 112 "../src/PluginManager.vala"
	_g_free0 (info.module_name);
#line 112 "../src/PluginManager.vala"
	info.module_name = _tmp19_;
#line 113 "../src/PluginManager.vala"
	_tmp20_ = module;
#line 113 "../src/PluginManager.vala"
	g_module_make_resident (_tmp20_);
#line 115 "../src/PluginManager.vala"
	_tmp22_ = info;
#line 115 "../src/PluginManager.vala"
	if (_tmp22_.load_priority == GALA_LOAD_PRIORITY_DEFERRED) {
#line 742 "PluginManager.c"
		gboolean _tmp23_;
#line 115 "../src/PluginManager.vala"
		_tmp23_ = self->priv->_initialized;
#line 115 "../src/PluginManager.vala"
		_tmp21_ = !_tmp23_;
#line 748 "PluginManager.c"
	} else {
#line 115 "../src/PluginManager.vala"
		_tmp21_ = FALSE;
#line 752 "PluginManager.c"
	}
#line 115 "../src/PluginManager.vala"
	if (_tmp21_) {
#line 756 "PluginManager.c"
		GeeLinkedList* _tmp24_;
		GalaPluginInfo _tmp25_;
#line 116 "../src/PluginManager.vala"
		_tmp24_ = self->priv->load_later_plugins;
#line 116 "../src/PluginManager.vala"
		_tmp25_ = info;
#line 116 "../src/PluginManager.vala"
		gee_abstract_collection_add ((GeeAbstractCollection*) _tmp24_, &_tmp25_);
#line 765 "PluginManager.c"
	} else {
		GalaPluginInfo _tmp26_;
#line 118 "../src/PluginManager.vala"
		_tmp26_ = info;
#line 118 "../src/PluginManager.vala"
		gala_plugin_manager_load_plugin_class (self, &_tmp26_);
#line 772 "PluginManager.c"
	}
#line 121 "../src/PluginManager.vala"
	result = TRUE;
#line 121 "../src/PluginManager.vala"
	gala_plugin_info_destroy (&info);
#line 121 "../src/PluginManager.vala"
	_g_module_close0 (module);
#line 121 "../src/PluginManager.vala"
	_g_free0 (path);
#line 121 "../src/PluginManager.vala"
	return result;
#line 784 "PluginManager.c"
}

static gpointer
_g_object_ref0 (gpointer self)
{
#line 126 "../src/PluginManager.vala"
	return self ? g_object_ref (self) : NULL;
#line 792 "PluginManager.c"
}

static void
gala_plugin_manager_load_plugin_class (GalaPluginManager* self,
                                       GalaPluginInfo* info)
{
	GalaPlugin* plugin = NULL;
	GalaPluginInfo _tmp0_;
	GObject* _tmp1_;
	GObject* _tmp2_;
	GHashTable* _tmp3_;
	GalaPluginInfo _tmp4_;
	const gchar* _tmp5_;
	gchar* _tmp6_;
	GalaPlugin* _tmp7_;
	GalaPlugin* _tmp8_;
	GalaPluginInfo _tmp9_;
	const gchar* _tmp10_;
	GalaPluginInfo _tmp11_;
	const gchar* _tmp12_;
	gboolean _tmp13_;
#line 124 "../src/PluginManager.vala"
	g_return_if_fail (self != NULL);
#line 124 "../src/PluginManager.vala"
	g_return_if_fail (info != NULL);
#line 125 "../src/PluginManager.vala"
	_tmp0_ = *info;
#line 125 "../src/PluginManager.vala"
	_tmp1_ = g_object_new (_tmp0_.plugin_type, NULL);
#line 125 "../src/PluginManager.vala"
	_tmp2_ = G_IS_INITIALLY_UNOWNED (_tmp1_) ? g_object_ref_sink (_tmp1_) : _tmp1_;
#line 125 "../src/PluginManager.vala"
	plugin = G_TYPE_CHECK_INSTANCE_CAST (_tmp2_, GALA_TYPE_PLUGIN, GalaPlugin);
#line 126 "../src/PluginManager.vala"
	_tmp3_ = self->priv->plugins;
#line 126 "../src/PluginManager.vala"
	_tmp4_ = *info;
#line 126 "../src/PluginManager.vala"
	_tmp5_ = _tmp4_.module_name;
#line 126 "../src/PluginManager.vala"
	_tmp6_ = g_strdup (_tmp5_);
#line 126 "../src/PluginManager.vala"
	_tmp7_ = plugin;
#line 126 "../src/PluginManager.vala"
	_tmp8_ = _g_object_ref0 (_tmp7_);
#line 126 "../src/PluginManager.vala"
	g_hash_table_insert (_tmp3_, _tmp6_, _tmp8_);
#line 128 "../src/PluginManager.vala"
	_tmp9_ = *info;
#line 128 "../src/PluginManager.vala"
	_tmp10_ = _tmp9_.name;
#line 128 "../src/PluginManager.vala"
	_tmp11_ = *info;
#line 128 "../src/PluginManager.vala"
	_tmp12_ = _tmp11_.module_name;
#line 128 "../src/PluginManager.vala"
	g_debug ("PluginManager.vala:128: Loaded plugin %s (%s)", _tmp10_, _tmp12_);
#line 130 "../src/PluginManager.vala"
	_tmp13_ = self->priv->_initialized;
#line 130 "../src/PluginManager.vala"
	if (_tmp13_) {
#line 854 "PluginManager.c"
		GalaPluginInfo _tmp14_;
		const gchar* _tmp15_;
		GalaPlugin* _tmp16_;
#line 131 "../src/PluginManager.vala"
		_tmp14_ = *info;
#line 131 "../src/PluginManager.vala"
		_tmp15_ = _tmp14_.module_name;
#line 131 "../src/PluginManager.vala"
		_tmp16_ = plugin;
#line 131 "../src/PluginManager.vala"
		gala_plugin_manager_initialize_plugin (self, _tmp15_, _tmp16_);
#line 132 "../src/PluginManager.vala"
		gala_plugin_manager_recalculate_regions (self);
#line 868 "PluginManager.c"
	}
#line 125 "../src/PluginManager.vala"
	_g_object_unref0 (plugin);
#line 872 "PluginManager.c"
}

static void
_gala_plugin_manager_recalculate_regions_gala_plugin_region_changed (GalaPlugin* _sender,
                                                                     gpointer self)
{
#line 138 "../src/PluginManager.vala"
	gala_plugin_manager_recalculate_regions ((GalaPluginManager*) self);
#line 881 "PluginManager.c"
}

static void
gala_plugin_manager_initialize_plugin (GalaPluginManager* self,
                                       const gchar* plugin_name,
                                       GalaPlugin* plugin)
{
	GalaWindowManager* _tmp0_;
#line 136 "../src/PluginManager.vala"
	g_return_if_fail (self != NULL);
#line 136 "../src/PluginManager.vala"
	g_return_if_fail (plugin_name != NULL);
#line 136 "../src/PluginManager.vala"
	g_return_if_fail (plugin != NULL);
#line 137 "../src/PluginManager.vala"
	_tmp0_ = self->priv->wm;
#line 137 "../src/PluginManager.vala"
	gala_plugin_initialize (plugin, _tmp0_);
#line 138 "../src/PluginManager.vala"
	g_signal_connect_object (plugin, "region-changed", (GCallback) _gala_plugin_manager_recalculate_regions_gala_plugin_region_changed, self, 0);
#line 902 "PluginManager.c"
}

static gboolean
gala_plugin_manager_check_provides (GalaPluginManager* self,
                                    const gchar* name,
                                    GalaPluginFunction provides)
{
	gchar* message = NULL;
	gchar* _tmp0_;
	gboolean result;
#line 141 "../src/PluginManager.vala"
	g_return_val_if_fail (self != NULL, FALSE);
#line 141 "../src/PluginManager.vala"
	g_return_val_if_fail (name != NULL, FALSE);
#line 142 "../src/PluginManager.vala"
	_tmp0_ = g_strdup ("Plugins %s and %s both provide %s functionality, using first one only");
#line 142 "../src/PluginManager.vala"
	message = _tmp0_;
#line 143 "../src/PluginManager.vala"
	switch (provides) {
#line 143 "../src/PluginManager.vala"
		case GALA_PLUGIN_FUNCTION_WORKSPACE_VIEW:
#line 925 "PluginManager.c"
		{
			const gchar* _tmp1_;
#line 145 "../src/PluginManager.vala"
			_tmp1_ = self->priv->_workspace_view_provider;
#line 145 "../src/PluginManager.vala"
			if (_tmp1_ != NULL) {
#line 932 "PluginManager.c"
				const gchar* _tmp2_;
				const gchar* _tmp3_;
#line 146 "../src/PluginManager.vala"
				_tmp2_ = message;
#line 146 "../src/PluginManager.vala"
				_tmp3_ = self->priv->_workspace_view_provider;
#line 146 "../src/PluginManager.vala"
				g_warning (_tmp2_, _tmp3_, name, "workspace view");
#line 147 "../src/PluginManager.vala"
				result = FALSE;
#line 147 "../src/PluginManager.vala"
				_g_free0 (message);
#line 147 "../src/PluginManager.vala"
				return result;
#line 947 "PluginManager.c"
			}
#line 149 "../src/PluginManager.vala"
			gala_plugin_manager_set_workspace_view_provider (self, name);
#line 150 "../src/PluginManager.vala"
			result = TRUE;
#line 150 "../src/PluginManager.vala"
			_g_free0 (message);
#line 150 "../src/PluginManager.vala"
			return result;
#line 957 "PluginManager.c"
		}
#line 143 "../src/PluginManager.vala"
		case GALA_PLUGIN_FUNCTION_WINDOW_OVERVIEW:
#line 961 "PluginManager.c"
		{
			const gchar* _tmp4_;
#line 152 "../src/PluginManager.vala"
			_tmp4_ = self->priv->_window_overview_provider;
#line 152 "../src/PluginManager.vala"
			if (_tmp4_ != NULL) {
#line 968 "PluginManager.c"
				const gchar* _tmp5_;
				const gchar* _tmp6_;
#line 153 "../src/PluginManager.vala"
				_tmp5_ = message;
#line 153 "../src/PluginManager.vala"
				_tmp6_ = self->priv->_window_overview_provider;
#line 153 "../src/PluginManager.vala"
				g_warning (_tmp5_, _tmp6_, name, "window overview");
#line 154 "../src/PluginManager.vala"
				result = FALSE;
#line 154 "../src/PluginManager.vala"
				_g_free0 (message);
#line 154 "../src/PluginManager.vala"
				return result;
#line 983 "PluginManager.c"
			}
#line 156 "../src/PluginManager.vala"
			gala_plugin_manager_set_window_overview_provider (self, name);
#line 157 "../src/PluginManager.vala"
			result = TRUE;
#line 157 "../src/PluginManager.vala"
			_g_free0 (message);
#line 157 "../src/PluginManager.vala"
			return result;
#line 993 "PluginManager.c"
		}
#line 143 "../src/PluginManager.vala"
		case GALA_PLUGIN_FUNCTION_WINDOW_SWITCHER:
#line 997 "PluginManager.c"
		{
			const gchar* _tmp7_;
#line 159 "../src/PluginManager.vala"
			_tmp7_ = self->priv->_window_switcher_provider;
#line 159 "../src/PluginManager.vala"
			if (_tmp7_ != NULL) {
#line 1004 "PluginManager.c"
				const gchar* _tmp8_;
				const gchar* _tmp9_;
#line 160 "../src/PluginManager.vala"
				_tmp8_ = message;
#line 160 "../src/PluginManager.vala"
				_tmp9_ = self->priv->_window_switcher_provider;
#line 160 "../src/PluginManager.vala"
				g_warning (_tmp8_, _tmp9_, name, "window switcher");
#line 161 "../src/PluginManager.vala"
				result = FALSE;
#line 161 "../src/PluginManager.vala"
				_g_free0 (message);
#line 161 "../src/PluginManager.vala"
				return result;
#line 1019 "PluginManager.c"
			}
#line 163 "../src/PluginManager.vala"
			gala_plugin_manager_set_window_switcher_provider (self, name);
#line 164 "../src/PluginManager.vala"
			result = TRUE;
#line 164 "../src/PluginManager.vala"
			_g_free0 (message);
#line 164 "../src/PluginManager.vala"
			return result;
#line 1029 "PluginManager.c"
		}
		default:
		{
#line 166 "../src/PluginManager.vala"
			break;
#line 1035 "PluginManager.c"
		}
	}
#line 169 "../src/PluginManager.vala"
	result = TRUE;
#line 169 "../src/PluginManager.vala"
	_g_free0 (message);
#line 169 "../src/PluginManager.vala"
	return result;
#line 1044 "PluginManager.c"
}

static void
_gala_plugin_manager_initialize_plugin_gh_func (gconstpointer key,
                                                gconstpointer value,
                                                gpointer self)
{
#line 175 "../src/PluginManager.vala"
	gala_plugin_manager_initialize_plugin ((GalaPluginManager*) self, (const gchar*) key, (GalaPlugin*) value);
#line 1054 "PluginManager.c"
}

void
gala_plugin_manager_initialize (GalaPluginManager* self,
                                GalaWindowManager* _wm)
{
	GalaWindowManager* _tmp0_;
	GHashTable* _tmp1_;
#line 172 "../src/PluginManager.vala"
	g_return_if_fail (self != NULL);
#line 172 "../src/PluginManager.vala"
	g_return_if_fail (_wm != NULL);
#line 173 "../src/PluginManager.vala"
	_tmp0_ = _g_object_ref0 (_wm);
#line 173 "../src/PluginManager.vala"
	_g_object_unref0 (self->priv->wm);
#line 173 "../src/PluginManager.vala"
	self->priv->wm = _tmp0_;
#line 175 "../src/PluginManager.vala"
	_tmp1_ = self->priv->plugins;
#line 175 "../src/PluginManager.vala"
	g_hash_table_foreach (_tmp1_, _gala_plugin_manager_initialize_plugin_gh_func, self);
#line 176 "../src/PluginManager.vala"
	gala_plugin_manager_recalculate_regions (self);
#line 178 "../src/PluginManager.vala"
	gala_plugin_manager_set_initialized (self, TRUE);
#line 1081 "PluginManager.c"
}

void
gala_plugin_manager_load_waiting_plugins (GalaPluginManager* self)
{
	GeeLinkedList* _tmp10_;
#line 181 "../src/PluginManager.vala"
	g_return_if_fail (self != NULL);
#line 1090 "PluginManager.c"
	{
		GeeLinkedList* _info_list = NULL;
		GeeLinkedList* _tmp0_;
		gint _info_size = 0;
		GeeLinkedList* _tmp1_;
		gint _tmp2_;
		gint _tmp3_;
		gint _info_index = 0;
#line 182 "../src/PluginManager.vala"
		_tmp0_ = self->priv->load_later_plugins;
#line 182 "../src/PluginManager.vala"
		_info_list = _tmp0_;
#line 182 "../src/PluginManager.vala"
		_tmp1_ = _info_list;
#line 182 "../src/PluginManager.vala"
		_tmp2_ = gee_abstract_collection_get_size ((GeeAbstractCollection*) _tmp1_);
#line 182 "../src/PluginManager.vala"
		_tmp3_ = _tmp2_;
#line 182 "../src/PluginManager.vala"
		_info_size = _tmp3_;
#line 182 "../src/PluginManager.vala"
		_info_index = -1;
#line 182 "../src/PluginManager.vala"
		while (TRUE) {
#line 1115 "PluginManager.c"
			gint _tmp4_;
			gint _tmp5_;
			GalaPluginInfo* info = NULL;
			GeeLinkedList* _tmp6_;
			gpointer _tmp7_;
			GalaPluginInfo* _tmp8_;
			GalaPluginInfo _tmp9_;
#line 182 "../src/PluginManager.vala"
			_info_index = _info_index + 1;
#line 182 "../src/PluginManager.vala"
			_tmp4_ = _info_index;
#line 182 "../src/PluginManager.vala"
			_tmp5_ = _info_size;
#line 182 "../src/PluginManager.vala"
			if (!(_tmp4_ < _tmp5_)) {
#line 182 "../src/PluginManager.vala"
				break;
#line 1133 "PluginManager.c"
			}
#line 182 "../src/PluginManager.vala"
			_tmp6_ = _info_list;
#line 182 "../src/PluginManager.vala"
			_tmp7_ = gee_abstract_list_get ((GeeAbstractList*) _tmp6_, _info_index);
#line 182 "../src/PluginManager.vala"
			info = (GalaPluginInfo*) _tmp7_;
#line 183 "../src/PluginManager.vala"
			_tmp8_ = info;
#line 183 "../src/PluginManager.vala"
			_tmp9_ = *_tmp8_;
#line 183 "../src/PluginManager.vala"
			gala_plugin_manager_load_plugin_class (self, &_tmp9_);
#line 182 "../src/PluginManager.vala"
			__vala_GalaPluginInfo_free0 (info);
#line 1149 "PluginManager.c"
		}
	}
#line 186 "../src/PluginManager.vala"
	_tmp10_ = self->priv->load_later_plugins;
#line 186 "../src/PluginManager.vala"
	gee_abstract_collection_clear ((GeeAbstractCollection*) _tmp10_);
#line 1156 "PluginManager.c"
}

GalaPlugin*
gala_plugin_manager_get_plugin (GalaPluginManager* self,
                                const gchar* id)
{
	GHashTable* _tmp0_;
	gconstpointer _tmp1_;
	GalaPlugin* _tmp2_;
	GalaPlugin* result;
#line 189 "../src/PluginManager.vala"
	g_return_val_if_fail (self != NULL, NULL);
#line 189 "../src/PluginManager.vala"
	g_return_val_if_fail (id != NULL, NULL);
#line 190 "../src/PluginManager.vala"
	_tmp0_ = self->priv->plugins;
#line 190 "../src/PluginManager.vala"
	_tmp1_ = g_hash_table_lookup (_tmp0_, id);
#line 190 "../src/PluginManager.vala"
	_tmp2_ = _g_object_ref0 ((GalaPlugin*) _tmp1_);
#line 190 "../src/PluginManager.vala"
	result = _tmp2_;
#line 190 "../src/PluginManager.vala"
	return result;
#line 1181 "PluginManager.c"
}

/**
         * Iterate over all plugins and grab their regions, update the regions
         * array accordingly and emit the regions_changed signal.
         */
static Block4Data*
block4_data_ref (Block4Data* _data4_)
{
#line 197 "../src/PluginManager.vala"
	g_atomic_int_inc (&_data4_->_ref_count_);
#line 197 "../src/PluginManager.vala"
	return _data4_;
#line 1195 "PluginManager.c"
}

static void
block4_data_unref (void * _userdata_)
{
	Block4Data* _data4_;
	_data4_ = (Block4Data*) _userdata_;
#line 197 "../src/PluginManager.vala"
	if (g_atomic_int_dec_and_test (&_data4_->_ref_count_)) {
#line 1205 "PluginManager.c"
		GalaPluginManager* self;
#line 197 "../src/PluginManager.vala"
		self = _data4_->self;
#line 197 "../src/PluginManager.vala"
		_data4_->regions = (g_free (_data4_->regions), NULL);
#line 197 "../src/PluginManager.vala"
		_g_object_unref0 (self);
#line 197 "../src/PluginManager.vala"
		g_slice_free (Block4Data, _data4_);
#line 1215 "PluginManager.c"
	}
}

static void
_vala_array_add9 (XRectangle* * array,
                  gint* length,
                  gint* size,
                  XRectangle value)
{
#line 209 "../src/PluginManager.vala"
	if ((*length) == (*size)) {
#line 209 "../src/PluginManager.vala"
		*size = (*size) ? (2 * (*size)) : 4;
#line 209 "../src/PluginManager.vala"
		*array = g_renew (XRectangle, *array, *size);
#line 1231 "PluginManager.c"
	}
#line 209 "../src/PluginManager.vala"
	(*array)[(*length)++] = value;
#line 1235 "PluginManager.c"
}

static void
__lambda10_ (Block4Data* _data4_,
             const gchar* name,
             GalaPlugin* plugin)
{
	GalaPluginManager* self;
	gint _tmp0_ = 0;
	MtkRectangle* _tmp1_;
#line 200 "../src/PluginManager.vala"
	self = _data4_->self;
#line 200 "../src/PluginManager.vala"
	g_return_if_fail (name != NULL);
#line 200 "../src/PluginManager.vala"
	g_return_if_fail (plugin != NULL);
#line 201 "../src/PluginManager.vala"
	_tmp1_ = gala_plugin_get_region (plugin, &_tmp0_);
#line 1254 "PluginManager.c"
	{
		MtkRectangle* region_collection = NULL;
		gint region_collection_length1 = 0;
		gint _region_collection_size_ = 0;
		gint region_it = 0;
#line 201 "../src/PluginManager.vala"
		region_collection = _tmp1_;
#line 201 "../src/PluginManager.vala"
		region_collection_length1 = _tmp0_;
#line 201 "../src/PluginManager.vala"
		for (region_it = 0; region_it < region_collection_length1; region_it = region_it + 1) {
#line 1266 "PluginManager.c"
			MtkRectangle region = {0};
#line 201 "../src/PluginManager.vala"
			region = region_collection[region_it];
#line 1270 "PluginManager.c"
			{
				XRectangle rect = {0};
				MtkRectangle _tmp2_;
				MtkRectangle _tmp3_;
				MtkRectangle _tmp4_;
				MtkRectangle _tmp5_;
				XRectangle _tmp6_ = {0};
#line 202 "../src/PluginManager.vala"
				_tmp2_ = region;
#line 202 "../src/PluginManager.vala"
				_tmp3_ = region;
#line 202 "../src/PluginManager.vala"
				_tmp4_ = region;
#line 202 "../src/PluginManager.vala"
				_tmp5_ = region;
#line 202 "../src/PluginManager.vala"
				_tmp6_.x = (gshort) _tmp2_.x;
#line 202 "../src/PluginManager.vala"
				_tmp6_.y = (gshort) _tmp3_.y;
#line 202 "../src/PluginManager.vala"
				_tmp6_.width = (gushort) _tmp4_.width;
#line 202 "../src/PluginManager.vala"
				_tmp6_.height = (gushort) _tmp5_.height;
#line 202 "../src/PluginManager.vala"
				rect = _tmp6_;
#line 209 "../src/PluginManager.vala"
				_vala_array_add9 (&_data4_->regions, &_data4_->regions_length1, &_data4_->_regions_size_, rect);
#line 1298 "PluginManager.c"
			}
		}
	}
}

static void
___lambda10__gh_func (gconstpointer key,
                      gconstpointer value,
                      gpointer self)
{
#line 200 "../src/PluginManager.vala"
	__lambda10_ (self, (const gchar*) key, (GalaPlugin*) value);
#line 1311 "PluginManager.c"
}

static XRectangle*
_vala_array_dup1 (XRectangle* self,
                  gssize length)
{
#line 213 "../src/PluginManager.vala"
	if (length > 0) {
#line 213 "../src/PluginManager.vala"
		return g_memdup2 (self, length * sizeof (XRectangle));
#line 1322 "PluginManager.c"
	}
#line 213 "../src/PluginManager.vala"
	return NULL;
#line 1326 "PluginManager.c"
}

static void
gala_plugin_manager_recalculate_regions (GalaPluginManager* self)
{
	Block4Data* _data4_;
	XRectangle* _tmp0_;
	GHashTable* _tmp1_;
	XRectangle* _tmp2_;
	gint _tmp2__length1;
#line 197 "../src/PluginManager.vala"
	g_return_if_fail (self != NULL);
#line 197 "../src/PluginManager.vala"
	_data4_ = g_slice_new0 (Block4Data);
#line 197 "../src/PluginManager.vala"
	_data4_->_ref_count_ = 1;
#line 197 "../src/PluginManager.vala"
	_data4_->self = g_object_ref (self);
#line 198 "../src/PluginManager.vala"
	_tmp0_ = g_new0 (XRectangle, 0);
#line 198 "../src/PluginManager.vala"
	_data4_->regions = _tmp0_;
#line 198 "../src/PluginManager.vala"
	_data4_->regions_length1 = 0;
#line 198 "../src/PluginManager.vala"
	_data4_->_regions_size_ = _data4_->regions_length1;
#line 200 "../src/PluginManager.vala"
	_tmp1_ = self->priv->plugins;
#line 200 "../src/PluginManager.vala"
	g_hash_table_foreach (_tmp1_, ___lambda10__gh_func, _data4_);
#line 213 "../src/PluginManager.vala"
	_tmp2_ = (_data4_->regions != NULL) ? _vala_array_dup1 (_data4_->regions, _data4_->regions_length1) : _data4_->regions;
#line 213 "../src/PluginManager.vala"
	_tmp2__length1 = _data4_->regions_length1;
#line 213 "../src/PluginManager.vala"
	self->priv->_regions = (g_free (self->priv->_regions), NULL);
#line 213 "../src/PluginManager.vala"
	self->priv->_regions = _tmp2_;
#line 213 "../src/PluginManager.vala"
	self->priv->_regions_length1 = _tmp2__length1;
#line 213 "../src/PluginManager.vala"
	self->priv->__regions_size_ = self->priv->_regions_length1;
#line 214 "../src/PluginManager.vala"
	g_signal_emit (self, gala_plugin_manager_signals[GALA_PLUGIN_MANAGER_REGIONS_CHANGED_SIGNAL], 0);
#line 197 "../src/PluginManager.vala"
	block4_data_unref (_data4_);
#line 197 "../src/PluginManager.vala"
	_data4_ = NULL;
#line 1375 "PluginManager.c"
}

gboolean
gala_plugin_manager_get_initialized (GalaPluginManager* self)
{
	gboolean result;
#line 32 "../src/PluginManager.vala"
	g_return_val_if_fail (self != NULL, FALSE);
#line 32 "../src/PluginManager.vala"
	result = self->priv->_initialized;
#line 32 "../src/PluginManager.vala"
	return result;
#line 1388 "PluginManager.c"
}

static void
gala_plugin_manager_set_initialized (GalaPluginManager* self,
                                     gboolean value)
{
	gboolean old_value;
#line 32 "../src/PluginManager.vala"
	g_return_if_fail (self != NULL);
#line 32 "../src/PluginManager.vala"
	old_value = gala_plugin_manager_get_initialized (self);
#line 32 "../src/PluginManager.vala"
	if (old_value != value) {
#line 32 "../src/PluginManager.vala"
		self->priv->_initialized = value;
#line 32 "../src/PluginManager.vala"
		g_object_notify_by_pspec ((GObject *) self, gala_plugin_manager_properties[GALA_PLUGIN_MANAGER_INITIALIZED_PROPERTY]);
#line 1406 "PluginManager.c"
	}
}

const gchar*
gala_plugin_manager_get_window_switcher_provider (GalaPluginManager* self)
{
	const gchar* result;
	const gchar* _tmp0_;
#line 39 "../src/PluginManager.vala"
	g_return_val_if_fail (self != NULL, NULL);
#line 39 "../src/PluginManager.vala"
	_tmp0_ = self->priv->_window_switcher_provider;
#line 39 "../src/PluginManager.vala"
	result = _tmp0_;
#line 39 "../src/PluginManager.vala"
	return result;
#line 1423 "PluginManager.c"
}

static void
gala_plugin_manager_set_window_switcher_provider (GalaPluginManager* self,
                                                  const gchar* value)
{
	gchar* old_value;
#line 39 "../src/PluginManager.vala"
	g_return_if_fail (self != NULL);
#line 39 "../src/PluginManager.vala"
	old_value = gala_plugin_manager_get_window_switcher_provider (self);
#line 39 "../src/PluginManager.vala"
	if (g_strcmp0 (value, old_value) != 0) {
#line 1437 "PluginManager.c"
		gchar* _tmp0_;
#line 39 "../src/PluginManager.vala"
		_tmp0_ = g_strdup (value);
#line 39 "../src/PluginManager.vala"
		_g_free0 (self->priv->_window_switcher_provider);
#line 39 "../src/PluginManager.vala"
		self->priv->_window_switcher_provider = _tmp0_;
#line 39 "../src/PluginManager.vala"
		g_object_notify_by_pspec ((GObject *) self, gala_plugin_manager_properties[GALA_PLUGIN_MANAGER_WINDOW_SWITCHER_PROVIDER_PROPERTY]);
#line 1447 "PluginManager.c"
	}
}

const gchar*
gala_plugin_manager_get_window_overview_provider (GalaPluginManager* self)
{
	const gchar* result;
	const gchar* _tmp0_;
#line 40 "../src/PluginManager.vala"
	g_return_val_if_fail (self != NULL, NULL);
#line 40 "../src/PluginManager.vala"
	_tmp0_ = self->priv->_window_overview_provider;
#line 40 "../src/PluginManager.vala"
	result = _tmp0_;
#line 40 "../src/PluginManager.vala"
	return result;
#line 1464 "PluginManager.c"
}

static void
gala_plugin_manager_set_window_overview_provider (GalaPluginManager* self,
                                                  const gchar* value)
{
	gchar* old_value;
#line 40 "../src/PluginManager.vala"
	g_return_if_fail (self != NULL);
#line 40 "../src/PluginManager.vala"
	old_value = gala_plugin_manager_get_window_overview_provider (self);
#line 40 "../src/PluginManager.vala"
	if (g_strcmp0 (value, old_value) != 0) {
#line 1478 "PluginManager.c"
		gchar* _tmp0_;
#line 40 "../src/PluginManager.vala"
		_tmp0_ = g_strdup (value);
#line 40 "../src/PluginManager.vala"
		_g_free0 (self->priv->_window_overview_provider);
#line 40 "../src/PluginManager.vala"
		self->priv->_window_overview_provider = _tmp0_;
#line 40 "../src/PluginManager.vala"
		g_object_notify_by_pspec ((GObject *) self, gala_plugin_manager_properties[GALA_PLUGIN_MANAGER_WINDOW_OVERVIEW_PROVIDER_PROPERTY]);
#line 1488 "PluginManager.c"
	}
}

const gchar*
gala_plugin_manager_get_workspace_view_provider (GalaPluginManager* self)
{
	const gchar* result;
	const gchar* _tmp0_;
#line 41 "../src/PluginManager.vala"
	g_return_val_if_fail (self != NULL, NULL);
#line 41 "../src/PluginManager.vala"
	_tmp0_ = self->priv->_workspace_view_provider;
#line 41 "../src/PluginManager.vala"
	result = _tmp0_;
#line 41 "../src/PluginManager.vala"
	return result;
#line 1505 "PluginManager.c"
}

static void
gala_plugin_manager_set_workspace_view_provider (GalaPluginManager* self,
                                                 const gchar* value)
{
	gchar* old_value;
#line 41 "../src/PluginManager.vala"
	g_return_if_fail (self != NULL);
#line 41 "../src/PluginManager.vala"
	old_value = gala_plugin_manager_get_workspace_view_provider (self);
#line 41 "../src/PluginManager.vala"
	if (g_strcmp0 (value, old_value) != 0) {
#line 1519 "PluginManager.c"
		gchar* _tmp0_;
#line 41 "../src/PluginManager.vala"
		_tmp0_ = g_strdup (value);
#line 41 "../src/PluginManager.vala"
		_g_free0 (self->priv->_workspace_view_provider);
#line 41 "../src/PluginManager.vala"
		self->priv->_workspace_view_provider = _tmp0_;
#line 41 "../src/PluginManager.vala"
		g_object_notify_by_pspec ((GObject *) self, gala_plugin_manager_properties[GALA_PLUGIN_MANAGER_WORKSPACE_VIEW_PROVIDER_PROPERTY]);
#line 1529 "PluginManager.c"
	}
}

static void
gala_plugin_manager_class_init (GalaPluginManagerClass * klass,
                                gpointer klass_data)
{
#line 21 "../src/PluginManager.vala"
	gala_plugin_manager_parent_class = g_type_class_peek_parent (klass);
#line 21 "../src/PluginManager.vala"
	g_type_class_adjust_private_offset (klass, &GalaPluginManager_private_offset);
#line 21 "../src/PluginManager.vala"
	G_OBJECT_CLASS (klass)->get_property = _vala_gala_plugin_manager_get_property;
#line 21 "../src/PluginManager.vala"
	G_OBJECT_CLASS (klass)->set_property = _vala_gala_plugin_manager_set_property;
#line 21 "../src/PluginManager.vala"
	G_OBJECT_CLASS (klass)->finalize = gala_plugin_manager_finalize;
#line 21 "../src/PluginManager.vala"
	g_object_class_install_property (G_OBJECT_CLASS (klass), GALA_PLUGIN_MANAGER_INITIALIZED_PROPERTY, gala_plugin_manager_properties[GALA_PLUGIN_MANAGER_INITIALIZED_PROPERTY] = g_param_spec_boolean ("initialized", "initialized", "initialized", FALSE, G_PARAM_STATIC_STRINGS | G_PARAM_READABLE));
#line 21 "../src/PluginManager.vala"
	g_object_class_install_property (G_OBJECT_CLASS (klass), GALA_PLUGIN_MANAGER_WINDOW_SWITCHER_PROVIDER_PROPERTY, gala_plugin_manager_properties[GALA_PLUGIN_MANAGER_WINDOW_SWITCHER_PROVIDER_PROPERTY] = g_param_spec_string ("window-switcher-provider", "window-switcher-provider", "window-switcher-provider", NULL, G_PARAM_STATIC_STRINGS | G_PARAM_READABLE));
#line 21 "../src/PluginManager.vala"
	g_object_class_install_property (G_OBJECT_CLASS (klass), GALA_PLUGIN_MANAGER_WINDOW_OVERVIEW_PROVIDER_PROPERTY, gala_plugin_manager_properties[GALA_PLUGIN_MANAGER_WINDOW_OVERVIEW_PROVIDER_PROPERTY] = g_param_spec_string ("window-overview-provider", "window-overview-provider", "window-overview-provider", NULL, G_PARAM_STATIC_STRINGS | G_PARAM_READABLE));
#line 21 "../src/PluginManager.vala"
	g_object_class_install_property (G_OBJECT_CLASS (klass), GALA_PLUGIN_MANAGER_WORKSPACE_VIEW_PROVIDER_PROPERTY, gala_plugin_manager_properties[GALA_PLUGIN_MANAGER_WORKSPACE_VIEW_PROVIDER_PROPERTY] = g_param_spec_string ("workspace-view-provider", "workspace-view-provider", "workspace-view-provider", NULL, G_PARAM_STATIC_STRINGS | G_PARAM_READABLE));
#line 21 "../src/PluginManager.vala"
	gala_plugin_manager_signals[GALA_PLUGIN_MANAGER_REGIONS_CHANGED_SIGNAL] = g_signal_new ("regions-changed", GALA_TYPE_PLUGIN_MANAGER, G_SIGNAL_RUN_LAST, 0, NULL, NULL, g_cclosure_marshal_VOID__VOID, G_TYPE_NONE, 0);
#line 1557 "PluginManager.c"
}

static void
gala_plugin_manager_instance_init (GalaPluginManager * self,
                                   gpointer klass)
{
	XRectangle* _tmp0_;
#line 21 "../src/PluginManager.vala"
	self->priv = gala_plugin_manager_get_instance_private (self);
#line 32 "../src/PluginManager.vala"
	self->priv->_initialized = FALSE;
#line 34 "../src/PluginManager.vala"
	_tmp0_ = g_new0 (XRectangle, 0);
#line 34 "../src/PluginManager.vala"
	self->priv->_regions = _tmp0_;
#line 34 "../src/PluginManager.vala"
	self->priv->_regions_length1 = 0;
#line 34 "../src/PluginManager.vala"
	self->priv->__regions_size_ = self->priv->_regions_length1;
#line 39 "../src/PluginManager.vala"
	self->priv->_window_switcher_provider = NULL;
#line 40 "../src/PluginManager.vala"
	self->priv->_window_overview_provider = NULL;
#line 41 "../src/PluginManager.vala"
	self->priv->_workspace_view_provider = NULL;
#line 46 "../src/PluginManager.vala"
	self->priv->wm = NULL;
#line 1585 "PluginManager.c"
}

static void
gala_plugin_manager_finalize (GObject * obj)
{
	GalaPluginManager * self;
#line 21 "../src/PluginManager.vala"
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, GALA_TYPE_PLUGIN_MANAGER, GalaPluginManager);
#line 34 "../src/PluginManager.vala"
	self->priv->_regions = (g_free (self->priv->_regions), NULL);
#line 39 "../src/PluginManager.vala"
	_g_free0 (self->priv->_window_switcher_provider);
#line 40 "../src/PluginManager.vala"
	_g_free0 (self->priv->_window_overview_provider);
#line 41 "../src/PluginManager.vala"
	_g_free0 (self->priv->_workspace_view_provider);
#line 43 "../src/PluginManager.vala"
	_g_hash_table_unref0 (self->priv->plugins);
#line 44 "../src/PluginManager.vala"
	_g_object_unref0 (self->priv->plugin_dir);
#line 46 "../src/PluginManager.vala"
	_g_object_unref0 (self->priv->wm);
#line 48 "../src/PluginManager.vala"
	_g_object_unref0 (self->priv->load_later_plugins);
#line 124 "../src/PluginManager.vala"
	G_OBJECT_CLASS (gala_plugin_manager_parent_class)->finalize (obj);
#line 1612 "PluginManager.c"
}

 G_GNUC_NO_INLINE static GType
gala_plugin_manager_get_type_once (void)
{
	static const GTypeInfo g_define_type_info = { sizeof (GalaPluginManagerClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) gala_plugin_manager_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (GalaPluginManager), 0, (GInstanceInitFunc) gala_plugin_manager_instance_init, NULL };
	GType gala_plugin_manager_type_id;
	gala_plugin_manager_type_id = g_type_register_static (G_TYPE_OBJECT, "GalaPluginManager", &g_define_type_info, 0);
	GalaPluginManager_private_offset = g_type_add_instance_private (gala_plugin_manager_type_id, sizeof (GalaPluginManagerPrivate));
	return gala_plugin_manager_type_id;
}

GType
gala_plugin_manager_get_type (void)
{
	static gsize gala_plugin_manager_type_id__once = 0;
	if (g_once_init_enter (&gala_plugin_manager_type_id__once)) {
		GType gala_plugin_manager_type_id;
		gala_plugin_manager_type_id = gala_plugin_manager_get_type_once ();
		g_once_init_leave (&gala_plugin_manager_type_id__once, gala_plugin_manager_type_id);
	}
	return gala_plugin_manager_type_id__once;
}

static void
_vala_gala_plugin_manager_get_property (GObject * object,
                                        guint property_id,
                                        GValue * value,
                                        GParamSpec * pspec)
{
	GalaPluginManager * self;
	self = G_TYPE_CHECK_INSTANCE_CAST (object, GALA_TYPE_PLUGIN_MANAGER, GalaPluginManager);
#line 21 "../src/PluginManager.vala"
	switch (property_id) {
#line 21 "../src/PluginManager.vala"
		case GALA_PLUGIN_MANAGER_INITIALIZED_PROPERTY:
#line 21 "../src/PluginManager.vala"
		g_value_set_boolean (value, gala_plugin_manager_get_initialized (self));
#line 21 "../src/PluginManager.vala"
		break;
#line 21 "../src/PluginManager.vala"
		case GALA_PLUGIN_MANAGER_WINDOW_SWITCHER_PROVIDER_PROPERTY:
#line 21 "../src/PluginManager.vala"
		g_value_set_string (value, gala_plugin_manager_get_window_switcher_provider (self));
#line 21 "../src/PluginManager.vala"
		break;
#line 21 "../src/PluginManager.vala"
		case GALA_PLUGIN_MANAGER_WINDOW_OVERVIEW_PROVIDER_PROPERTY:
#line 21 "../src/PluginManager.vala"
		g_value_set_string (value, gala_plugin_manager_get_window_overview_provider (self));
#line 21 "../src/PluginManager.vala"
		break;
#line 21 "../src/PluginManager.vala"
		case GALA_PLUGIN_MANAGER_WORKSPACE_VIEW_PROVIDER_PROPERTY:
#line 21 "../src/PluginManager.vala"
		g_value_set_string (value, gala_plugin_manager_get_workspace_view_provider (self));
#line 21 "../src/PluginManager.vala"
		break;
#line 1671 "PluginManager.c"
		default:
#line 21 "../src/PluginManager.vala"
		G_OBJECT_WARN_INVALID_PROPERTY_ID (object, property_id, pspec);
#line 21 "../src/PluginManager.vala"
		break;
#line 1677 "PluginManager.c"
	}
}

static void
_vala_gala_plugin_manager_set_property (GObject * object,
                                        guint property_id,
                                        const GValue * value,
                                        GParamSpec * pspec)
{
	GalaPluginManager * self;
	self = G_TYPE_CHECK_INSTANCE_CAST (object, GALA_TYPE_PLUGIN_MANAGER, GalaPluginManager);
#line 21 "../src/PluginManager.vala"
	switch (property_id) {
#line 21 "../src/PluginManager.vala"
		case GALA_PLUGIN_MANAGER_INITIALIZED_PROPERTY:
#line 21 "../src/PluginManager.vala"
		gala_plugin_manager_set_initialized (self, g_value_get_boolean (value));
#line 21 "../src/PluginManager.vala"
		break;
#line 21 "../src/PluginManager.vala"
		case GALA_PLUGIN_MANAGER_WINDOW_SWITCHER_PROVIDER_PROPERTY:
#line 21 "../src/PluginManager.vala"
		gala_plugin_manager_set_window_switcher_provider (self, g_value_get_string (value));
#line 21 "../src/PluginManager.vala"
		break;
#line 21 "../src/PluginManager.vala"
		case GALA_PLUGIN_MANAGER_WINDOW_OVERVIEW_PROVIDER_PROPERTY:
#line 21 "../src/PluginManager.vala"
		gala_plugin_manager_set_window_overview_provider (self, g_value_get_string (value));
#line 21 "../src/PluginManager.vala"
		break;
#line 21 "../src/PluginManager.vala"
		case GALA_PLUGIN_MANAGER_WORKSPACE_VIEW_PROVIDER_PROPERTY:
#line 21 "../src/PluginManager.vala"
		gala_plugin_manager_set_workspace_view_provider (self, g_value_get_string (value));
#line 21 "../src/PluginManager.vala"
		break;
#line 1715 "PluginManager.c"
		default:
#line 21 "../src/PluginManager.vala"
		G_OBJECT_WARN_INVALID_PROPERTY_ID (object, property_id, pspec);
#line 21 "../src/PluginManager.vala"
		break;
#line 1721 "PluginManager.c"
	}
}

