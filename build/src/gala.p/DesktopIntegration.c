/* DesktopIntegration.c generated by valac 0.56.17, the Vala compiler
 * generated from DesktopIntegration.vala, do not modify */

/*
 * Copyright 2022 elementary, Inc. <https://elementary.io>
 * Copyright 2022 Corentin NoÃ«l <tintou@noel.tf>
 * SPDX-License-Identifier: GPL-3.0-or-later
 */

#include <glib-object.h>
#include <gio/gio.h>
#include <meta/meta-plugin.h>
#include <glib.h>
#include <stdlib.h>
#include <string.h>
#include "gala.h"
#include <meta/window.h>
#include <meta/workspace.h>
#include <meta/display.h>
#include <meta/meta-workspace-manager.h>
#include <mtk/mtk.h>

#if !defined(VALA_STRICT_C)
#if !defined(__clang__) && defined(__GNUC__) && (__GNUC__ >= 14)
#pragma GCC diagnostic warning "-Wincompatible-pointer-types"
#elif defined(__clang__) && (__clang_major__ >= 16)
#pragma clang diagnostic ignored "-Wincompatible-function-pointer-types"
#pragma clang diagnostic ignored "-Wincompatible-pointer-types"
#endif
#endif
#if !defined(VALA_EXTERN)
#if defined(_MSC_VER)
#define VALA_EXTERN __declspec(dllexport) extern
#elif __GNUC__ >= 4
#define VALA_EXTERN __attribute__((visibility("default"))) extern
#else
#define VALA_EXTERN extern
#endif
#endif

#define GALA_TYPE_DESKTOP_INTEGRATION (gala_desktop_integration_get_type ())
#define GALA_DESKTOP_INTEGRATION(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), GALA_TYPE_DESKTOP_INTEGRATION, GalaDesktopIntegration))
#define GALA_DESKTOP_INTEGRATION_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), GALA_TYPE_DESKTOP_INTEGRATION, GalaDesktopIntegrationClass))
#define GALA_IS_DESKTOP_INTEGRATION(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), GALA_TYPE_DESKTOP_INTEGRATION))
#define GALA_IS_DESKTOP_INTEGRATION_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), GALA_TYPE_DESKTOP_INTEGRATION))
#define GALA_DESKTOP_INTEGRATION_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), GALA_TYPE_DESKTOP_INTEGRATION, GalaDesktopIntegrationClass))

typedef struct _GalaDesktopIntegration GalaDesktopIntegration;
typedef struct _GalaDesktopIntegrationClass GalaDesktopIntegrationClass;
typedef struct _GalaDesktopIntegrationPrivate GalaDesktopIntegrationPrivate;

#define GALA_TYPE_WINDOW_MANAGER_GALA (gala_window_manager_gala_get_type ())
#define GALA_WINDOW_MANAGER_GALA(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), GALA_TYPE_WINDOW_MANAGER_GALA, GalaWindowManagerGala))
#define GALA_WINDOW_MANAGER_GALA_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), GALA_TYPE_WINDOW_MANAGER_GALA, GalaWindowManagerGalaClass))
#define GALA_IS_WINDOW_MANAGER_GALA(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), GALA_TYPE_WINDOW_MANAGER_GALA))
#define GALA_IS_WINDOW_MANAGER_GALA_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), GALA_TYPE_WINDOW_MANAGER_GALA))
#define GALA_WINDOW_MANAGER_GALA_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), GALA_TYPE_WINDOW_MANAGER_GALA, GalaWindowManagerGalaClass))

typedef struct _GalaWindowManagerGala GalaWindowManagerGala;
typedef struct _GalaWindowManagerGalaClass GalaWindowManagerGalaClass;
enum  {
	GALA_DESKTOP_INTEGRATION_0_PROPERTY,
	GALA_DESKTOP_INTEGRATION_VERSION_PROPERTY,
	GALA_DESKTOP_INTEGRATION_NUM_PROPERTIES
};
static GParamSpec* gala_desktop_integration_properties[GALA_DESKTOP_INTEGRATION_NUM_PROPERTIES];

#define GALA_TYPE_WINDOW_TRACKER (gala_window_tracker_get_type ())
#define GALA_WINDOW_TRACKER(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), GALA_TYPE_WINDOW_TRACKER, GalaWindowTracker))
#define GALA_WINDOW_TRACKER_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), GALA_TYPE_WINDOW_TRACKER, GalaWindowTrackerClass))
#define GALA_IS_WINDOW_TRACKER(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), GALA_TYPE_WINDOW_TRACKER))
#define GALA_IS_WINDOW_TRACKER_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), GALA_TYPE_WINDOW_TRACKER))
#define GALA_WINDOW_TRACKER_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), GALA_TYPE_WINDOW_TRACKER, GalaWindowTrackerClass))

typedef struct _GalaWindowTracker GalaWindowTracker;
typedef struct _GalaWindowTrackerClass GalaWindowTrackerClass;

#define GALA_DESKTOP_INTEGRATION_TYPE_RUNNING_APPLICATION (gala_desktop_integration_running_application_get_type ())
typedef struct _GalaDesktopIntegrationRunningApplication GalaDesktopIntegrationRunningApplication;
#define _g_free0(var) (var = (g_free (var), NULL))
#define _g_hash_table_unref0(var) ((var == NULL) ? NULL : (var = (g_hash_table_unref (var), NULL)))

#define GALA_DESKTOP_INTEGRATION_TYPE_WINDOW (gala_desktop_integration_window_get_type ())
typedef struct _GalaDesktopIntegrationWindow GalaDesktopIntegrationWindow;
#define _g_object_unref0(var) ((var == NULL) ? NULL : (var = (g_object_unref (var), NULL)))
enum  {
	GALA_DESKTOP_INTEGRATION_RUNNING_APPLICATIONS_CHANGED_SIGNAL,
	GALA_DESKTOP_INTEGRATION_WINDOWS_CHANGED_SIGNAL,
	GALA_DESKTOP_INTEGRATION_NUM_SIGNALS
};
static guint gala_desktop_integration_signals[GALA_DESKTOP_INTEGRATION_NUM_SIGNALS] = {0};

struct _GalaDesktopIntegration {
	GObject parent_instance;
	GalaDesktopIntegrationPrivate * priv;
};

struct _GalaDesktopIntegrationClass {
	GObjectClass parent_class;
};

struct _GalaDesktopIntegrationPrivate {
	GalaWindowManagerGala* wm;
	guint _version;
};

struct _GalaDesktopIntegrationRunningApplication {
	gchar* app_id;
	GHashTable* details;
};

struct _GalaDesktopIntegrationWindow {
	guint64 uid;
	GHashTable* properties;
};

static gint GalaDesktopIntegration_private_offset;
static gpointer gala_desktop_integration_parent_class = NULL;

VALA_EXTERN GType gala_desktop_integration_get_type (void) G_GNUC_CONST ;
G_DEFINE_AUTOPTR_CLEANUP_FUNC (GalaDesktopIntegration, g_object_unref)
VALA_EXTERN guint gala_desktop_integration_register_object (void* object,
                                                GDBusConnection* connection,
                                                const gchar* path,
                                                GError** error);
VALA_EXTERN GType gala_window_manager_gala_get_type (void) G_GNUC_CONST ;
G_DEFINE_AUTOPTR_CLEANUP_FUNC (GalaWindowManagerGala, g_object_unref)
VALA_EXTERN GalaDesktopIntegration* gala_desktop_integration_new (GalaWindowManagerGala* wm);
VALA_EXTERN GalaDesktopIntegration* gala_desktop_integration_construct (GType object_type,
                                                            GalaWindowManagerGala* wm);
VALA_EXTERN GType gala_window_tracker_get_type (void) G_GNUC_CONST ;
G_DEFINE_AUTOPTR_CLEANUP_FUNC (GalaWindowTracker, g_object_unref)
VALA_EXTERN GalaWindowTracker* gala_window_manager_gala_get_window_tracker (GalaWindowManagerGala* self);
static void __lambda119_ (GalaDesktopIntegration* self);
static void ___lambda119__gala_window_tracker_windows_changed (GalaWindowTracker* _sender,
                                                        gpointer self);
VALA_EXTERN GType gala_desktop_integration_running_application_get_type (void) G_GNUC_CONST ;
VALA_EXTERN GalaDesktopIntegrationRunningApplication* gala_desktop_integration_running_application_dup (const GalaDesktopIntegrationRunningApplication* self);
VALA_EXTERN void gala_desktop_integration_running_application_free (GalaDesktopIntegrationRunningApplication* self);
VALA_EXTERN void gala_desktop_integration_running_application_copy (const GalaDesktopIntegrationRunningApplication* self,
                                                        GalaDesktopIntegrationRunningApplication* dest);
VALA_EXTERN void gala_desktop_integration_running_application_destroy (GalaDesktopIntegrationRunningApplication* self);
G_DEFINE_AUTO_CLEANUP_CLEAR_FUNC (GalaDesktopIntegrationRunningApplication, gala_desktop_integration_running_application_destroy)
VALA_EXTERN GalaDesktopIntegrationRunningApplication* gala_desktop_integration_get_running_applications (GalaDesktopIntegration* self,
                                                                                             gint* result_length1,
                                                                                             GError** error);
static void _g_variant_unref0_ (gpointer var);
static void _vala_array_add2 (GalaDesktopIntegrationRunningApplication* * array,
                       gint* length,
                       gint* size,
                       const GalaDesktopIntegrationRunningApplication* value);
static void _vala_GalaDesktopIntegrationRunningApplication_array_free (GalaDesktopIntegrationRunningApplication * array,
                                                                gssize array_length);
static gboolean gala_desktop_integration_is_eligible_window (GalaDesktopIntegration* self,
                                                      MetaWindow* window);
VALA_EXTERN GType gala_desktop_integration_window_get_type (void) G_GNUC_CONST ;
VALA_EXTERN GalaDesktopIntegrationWindow* gala_desktop_integration_window_dup (const GalaDesktopIntegrationWindow* self);
VALA_EXTERN void gala_desktop_integration_window_free (GalaDesktopIntegrationWindow* self);
VALA_EXTERN void gala_desktop_integration_window_copy (const GalaDesktopIntegrationWindow* self,
                                           GalaDesktopIntegrationWindow* dest);
VALA_EXTERN void gala_desktop_integration_window_destroy (GalaDesktopIntegrationWindow* self);
G_DEFINE_AUTO_CLEANUP_CLEAR_FUNC (GalaDesktopIntegrationWindow, gala_desktop_integration_window_destroy)
VALA_EXTERN GalaDesktopIntegrationWindow* gala_desktop_integration_get_windows (GalaDesktopIntegration* self,
                                                                    gint* result_length1,
                                                                    GError** error);
static void _vala_array_add3 (GalaDesktopIntegrationWindow* * array,
                       gint* length,
                       gint* size,
                       const GalaDesktopIntegrationWindow* value);
static void _vala_GalaDesktopIntegrationWindow_array_free (GalaDesktopIntegrationWindow * array,
                                                    gssize array_length);
VALA_EXTERN void gala_desktop_integration_focus_window (GalaDesktopIntegration* self,
                                            guint64 uid,
                                            GError** error);
VALA_EXTERN void gala_desktop_integration_show_windows_for (GalaDesktopIntegration* self,
                                                const gchar* app_id,
                                                GError** error);
VALA_EXTERN GalaActivatableComponent* gala_window_manager_gala_get_window_overview (GalaWindowManagerGala* self);
static void _vala_array_add4 (guint64* * array,
                       gint* length,
                       gint* size,
                       guint64 value);
static void _g_free0_ (gpointer var);
static GVariant* _variant_new1 (guint64* value,
                         gint value_length1);
VALA_EXTERN guint gala_desktop_integration_get_version (GalaDesktopIntegration* self);
static void gala_desktop_integration_finalize (GObject * obj);
static GType gala_desktop_integration_get_type_once (void);
static void _vala_gala_desktop_integration_get_property (GObject * object,
                                                  guint property_id,
                                                  GValue * value,
                                                  GParamSpec * pspec);
static void _dbus_gala_desktop_integration_get_running_applications (GalaDesktopIntegration* self,
                                                              GVariant* _parameters_,
                                                              GDBusMethodInvocation* invocation);
static void _dbus_gala_desktop_integration_get_windows (GalaDesktopIntegration* self,
                                                 GVariant* _parameters_,
                                                 GDBusMethodInvocation* invocation);
static void _dbus_gala_desktop_integration_focus_window (GalaDesktopIntegration* self,
                                                  GVariant* _parameters_,
                                                  GDBusMethodInvocation* invocation);
static void _dbus_gala_desktop_integration_show_windows_for (GalaDesktopIntegration* self,
                                                      GVariant* _parameters_,
                                                      GDBusMethodInvocation* invocation);
static void gala_desktop_integration_dbus_interface_method_call (GDBusConnection* connection,
                                                          const gchar* sender,
                                                          const gchar* object_path,
                                                          const gchar* interface_name,
                                                          const gchar* method_name,
                                                          GVariant* parameters,
                                                          GDBusMethodInvocation* invocation,
                                                          gpointer user_data);
static GVariant* gala_desktop_integration_dbus_interface_get_property (GDBusConnection* connection,
                                                                const gchar* sender,
                                                                const gchar* object_path,
                                                                const gchar* interface_name,
                                                                const gchar* property_name,
                                                                GError** error,
                                                                gpointer user_data);
static GVariant* _dbus_gala_desktop_integration_get_version (GalaDesktopIntegration* self);
static gboolean gala_desktop_integration_dbus_interface_set_property (GDBusConnection* connection,
                                                               const gchar* sender,
                                                               const gchar* object_path,
                                                               const gchar* interface_name,
                                                               const gchar* property_name,
                                                               GVariant* value,
                                                               GError** error,
                                                               gpointer user_data);
static void _dbus_gala_desktop_integration_running_applications_changed (GObject* _sender,
                                                                  gpointer* _data);
static void _dbus_gala_desktop_integration_windows_changed (GObject* _sender,
                                                     gpointer* _data);
static void _gala_desktop_integration_unregister_object (gpointer user_data);

static const GDBusArgInfo _gala_desktop_integration_dbus_arg_info_get_running_applications_result = {-1, "result", "a(sa{sv})", NULL};
static const GDBusArgInfo * const _gala_desktop_integration_dbus_arg_info_get_running_applications_in[] = {NULL};
static const GDBusArgInfo * const _gala_desktop_integration_dbus_arg_info_get_running_applications_out[] = {&_gala_desktop_integration_dbus_arg_info_get_running_applications_result, NULL};
static const GDBusMethodInfo _gala_desktop_integration_dbus_method_info_get_running_applications = {-1, "GetRunningApplications", (GDBusArgInfo **) (&_gala_desktop_integration_dbus_arg_info_get_running_applications_in), (GDBusArgInfo **) (&_gala_desktop_integration_dbus_arg_info_get_running_applications_out), NULL};
static const GDBusArgInfo _gala_desktop_integration_dbus_arg_info_get_windows_result = {-1, "result", "a(ta{sv})", NULL};
static const GDBusArgInfo * const _gala_desktop_integration_dbus_arg_info_get_windows_in[] = {NULL};
static const GDBusArgInfo * const _gala_desktop_integration_dbus_arg_info_get_windows_out[] = {&_gala_desktop_integration_dbus_arg_info_get_windows_result, NULL};
static const GDBusMethodInfo _gala_desktop_integration_dbus_method_info_get_windows = {-1, "GetWindows", (GDBusArgInfo **) (&_gala_desktop_integration_dbus_arg_info_get_windows_in), (GDBusArgInfo **) (&_gala_desktop_integration_dbus_arg_info_get_windows_out), NULL};
static const GDBusArgInfo _gala_desktop_integration_dbus_arg_info_focus_window_uid = {-1, "uid", "t", NULL};
static const GDBusArgInfo * const _gala_desktop_integration_dbus_arg_info_focus_window_in[] = {&_gala_desktop_integration_dbus_arg_info_focus_window_uid, NULL};
static const GDBusArgInfo * const _gala_desktop_integration_dbus_arg_info_focus_window_out[] = {NULL};
static const GDBusMethodInfo _gala_desktop_integration_dbus_method_info_focus_window = {-1, "FocusWindow", (GDBusArgInfo **) (&_gala_desktop_integration_dbus_arg_info_focus_window_in), (GDBusArgInfo **) (&_gala_desktop_integration_dbus_arg_info_focus_window_out), NULL};
static const GDBusArgInfo _gala_desktop_integration_dbus_arg_info_show_windows_for_app_id = {-1, "app_id", "s", NULL};
static const GDBusArgInfo * const _gala_desktop_integration_dbus_arg_info_show_windows_for_in[] = {&_gala_desktop_integration_dbus_arg_info_show_windows_for_app_id, NULL};
static const GDBusArgInfo * const _gala_desktop_integration_dbus_arg_info_show_windows_for_out[] = {NULL};
static const GDBusMethodInfo _gala_desktop_integration_dbus_method_info_show_windows_for = {-1, "ShowWindowsFor", (GDBusArgInfo **) (&_gala_desktop_integration_dbus_arg_info_show_windows_for_in), (GDBusArgInfo **) (&_gala_desktop_integration_dbus_arg_info_show_windows_for_out), NULL};
static const GDBusMethodInfo * const _gala_desktop_integration_dbus_method_info[] = {&_gala_desktop_integration_dbus_method_info_get_running_applications, &_gala_desktop_integration_dbus_method_info_get_windows, &_gala_desktop_integration_dbus_method_info_focus_window, &_gala_desktop_integration_dbus_method_info_show_windows_for, NULL};
static const GDBusArgInfo * const _gala_desktop_integration_dbus_arg_info_running_applications_changed[] = {NULL};
static const GDBusSignalInfo _gala_desktop_integration_dbus_signal_info_running_applications_changed = {-1, "RunningApplicationsChanged", (GDBusArgInfo **) (&_gala_desktop_integration_dbus_arg_info_running_applications_changed), NULL};
static const GDBusArgInfo * const _gala_desktop_integration_dbus_arg_info_windows_changed[] = {NULL};
static const GDBusSignalInfo _gala_desktop_integration_dbus_signal_info_windows_changed = {-1, "WindowsChanged", (GDBusArgInfo **) (&_gala_desktop_integration_dbus_arg_info_windows_changed), NULL};
static const GDBusSignalInfo * const _gala_desktop_integration_dbus_signal_info[] = {&_gala_desktop_integration_dbus_signal_info_running_applications_changed, &_gala_desktop_integration_dbus_signal_info_windows_changed, NULL};
static const GDBusPropertyInfo _gala_desktop_integration_dbus_property_info_version = {-1, "Version", "u", G_DBUS_PROPERTY_INFO_FLAGS_READABLE, NULL};
static const GDBusPropertyInfo * const _gala_desktop_integration_dbus_property_info[] = {&_gala_desktop_integration_dbus_property_info_version, NULL};
static const GDBusInterfaceInfo _gala_desktop_integration_dbus_interface_info = {-1, "org.pantheon.gala.DesktopIntegration", (GDBusMethodInfo **) (&_gala_desktop_integration_dbus_method_info), (GDBusSignalInfo **) (&_gala_desktop_integration_dbus_signal_info), (GDBusPropertyInfo **) (&_gala_desktop_integration_dbus_property_info), NULL};
static const GDBusInterfaceVTable _gala_desktop_integration_dbus_interface_vtable = {gala_desktop_integration_dbus_interface_method_call, gala_desktop_integration_dbus_interface_get_property, gala_desktop_integration_dbus_interface_set_property};

static inline gpointer
gala_desktop_integration_get_instance_private (GalaDesktopIntegration* self)
{
	return G_STRUCT_MEMBER_P (self, GalaDesktopIntegration_private_offset);
}

static void
__lambda119_ (GalaDesktopIntegration* self)
{
#line 26 "../src/DesktopIntegration.vala"
	g_signal_emit (self, gala_desktop_integration_signals[GALA_DESKTOP_INTEGRATION_WINDOWS_CHANGED_SIGNAL], 0);
#line 274 "DesktopIntegration.c"
}

static void
___lambda119__gala_window_tracker_windows_changed (GalaWindowTracker* _sender,
                                                   gpointer self)
{
#line 26 "../src/DesktopIntegration.vala"
	__lambda119_ ((GalaDesktopIntegration*) self);
#line 283 "DesktopIntegration.c"
}

GalaDesktopIntegration*
gala_desktop_integration_construct (GType object_type,
                                    GalaWindowManagerGala* wm)
{
	GalaDesktopIntegration * self = NULL;
	GalaWindowTracker* _tmp0_;
	GalaWindowTracker* _tmp1_;
#line 24 "../src/DesktopIntegration.vala"
	g_return_val_if_fail (wm != NULL, NULL);
#line 24 "../src/DesktopIntegration.vala"
	self = (GalaDesktopIntegration*) g_object_new (object_type, NULL);
#line 25 "../src/DesktopIntegration.vala"
	self->priv->wm = wm;
#line 26 "../src/DesktopIntegration.vala"
	_tmp0_ = gala_window_manager_gala_get_window_tracker (wm);
#line 26 "../src/DesktopIntegration.vala"
	_tmp1_ = _tmp0_;
#line 26 "../src/DesktopIntegration.vala"
	g_signal_connect_object (_tmp1_, "windows-changed", (GCallback) ___lambda119__gala_window_tracker_windows_changed, self, 0);
#line 24 "../src/DesktopIntegration.vala"
	return self;
#line 307 "DesktopIntegration.c"
}

GalaDesktopIntegration*
gala_desktop_integration_new (GalaWindowManagerGala* wm)
{
#line 24 "../src/DesktopIntegration.vala"
	return gala_desktop_integration_construct (GALA_TYPE_DESKTOP_INTEGRATION, wm);
#line 315 "DesktopIntegration.c"
}

static void
_g_variant_unref0_ (gpointer var)
{
#line 33 "../src/DesktopIntegration.vala"
	(var == NULL) ? NULL : (var = (g_variant_unref (var), NULL));
#line 323 "DesktopIntegration.c"
}

static void
_vala_array_add2 (GalaDesktopIntegrationRunningApplication* * array,
                  gint* length,
                  gint* size,
                  const GalaDesktopIntegrationRunningApplication* value)
{
#line 33 "../src/DesktopIntegration.vala"
	if ((*length) == (*size)) {
#line 33 "../src/DesktopIntegration.vala"
		*size = (*size) ? (2 * (*size)) : 4;
#line 33 "../src/DesktopIntegration.vala"
		*array = g_renew (GalaDesktopIntegrationRunningApplication, *array, *size);
#line 338 "DesktopIntegration.c"
	}
#line 33 "../src/DesktopIntegration.vala"
	(*array)[(*length)++] = *value;
#line 342 "DesktopIntegration.c"
}

static void
_vala_GalaDesktopIntegrationRunningApplication_array_free (GalaDesktopIntegrationRunningApplication * array,
                                                           gssize array_length)
{
#line 39 "../src/DesktopIntegration.vala"
	if (array != NULL) {
#line 351 "DesktopIntegration.c"
		gssize i;
#line 39 "../src/DesktopIntegration.vala"
		for (i = 0; i < array_length; i = i + 1) {
#line 39 "../src/DesktopIntegration.vala"
			gala_desktop_integration_running_application_destroy (&array[i]);
#line 357 "DesktopIntegration.c"
		}
	}
#line 39 "../src/DesktopIntegration.vala"
	g_free (array);
#line 362 "DesktopIntegration.c"
}

GalaDesktopIntegrationRunningApplication*
gala_desktop_integration_get_running_applications (GalaDesktopIntegration* self,
                                                   gint* result_length1,
                                                   GError** error)
{
	GalaDesktopIntegrationRunningApplication* returned_apps = NULL;
	GalaDesktopIntegrationRunningApplication* _tmp0_;
	gint returned_apps_length1;
	gint _returned_apps_size_;
	GList* apps = NULL;
	GalaAppSystem* _tmp1_;
	GList* _tmp2_;
	GList* _tmp3_;
	GalaDesktopIntegrationRunningApplication* _tmp12_;
	gint _tmp12__length1;
	GalaDesktopIntegrationRunningApplication* _tmp13_;
	gint _tmp13__length1;
	GalaDesktopIntegrationRunningApplication* result;
#line 29 "../src/DesktopIntegration.vala"
	g_return_val_if_fail (self != NULL, NULL);
#line 30 "../src/DesktopIntegration.vala"
	_tmp0_ = g_new0 (GalaDesktopIntegrationRunningApplication, 0);
#line 30 "../src/DesktopIntegration.vala"
	returned_apps = _tmp0_;
#line 30 "../src/DesktopIntegration.vala"
	returned_apps_length1 = 0;
#line 30 "../src/DesktopIntegration.vala"
	_returned_apps_size_ = returned_apps_length1;
#line 31 "../src/DesktopIntegration.vala"
	_tmp1_ = gala_app_system_get_default ();
#line 31 "../src/DesktopIntegration.vala"
	_tmp2_ = gala_app_system_get_running_apps (_tmp1_);
#line 31 "../src/DesktopIntegration.vala"
	apps = _tmp2_;
#line 32 "../src/DesktopIntegration.vala"
	_tmp3_ = apps;
#line 401 "DesktopIntegration.c"
	{
		GList* app_collection = NULL;
		GList* app_it = NULL;
#line 32 "../src/DesktopIntegration.vala"
		app_collection = _tmp3_;
#line 32 "../src/DesktopIntegration.vala"
		for (app_it = app_collection; app_it != NULL; app_it = app_it->next) {
#line 409 "DesktopIntegration.c"
			GalaApp* app = NULL;
#line 32 "../src/DesktopIntegration.vala"
			app = (GalaApp*) app_it->data;
#line 413 "DesktopIntegration.c"
			{
				GalaApp* _tmp4_;
				const gchar* _tmp5_;
				const gchar* _tmp6_;
				gchar* _tmp7_;
				GHashFunc _tmp8_;
				GEqualFunc _tmp9_;
				GHashTable* _tmp10_;
				GalaDesktopIntegrationRunningApplication _tmp11_ = {0};
#line 33 "../src/DesktopIntegration.vala"
				_tmp4_ = app;
#line 33 "../src/DesktopIntegration.vala"
				_tmp5_ = gala_app_get_id (_tmp4_);
#line 33 "../src/DesktopIntegration.vala"
				_tmp6_ = _tmp5_;
#line 33 "../src/DesktopIntegration.vala"
				_tmp7_ = g_strdup (_tmp6_);
#line 33 "../src/DesktopIntegration.vala"
				_tmp8_ = g_str_hash;
#line 33 "../src/DesktopIntegration.vala"
				_tmp9_ = g_str_equal;
#line 33 "../src/DesktopIntegration.vala"
				_tmp10_ = g_hash_table_new_full (_tmp8_, _tmp9_, NULL, _g_variant_unref0_);
#line 33 "../src/DesktopIntegration.vala"
				memset (&_tmp11_, 0, sizeof (GalaDesktopIntegrationRunningApplication));
#line 33 "../src/DesktopIntegration.vala"
				_g_free0 (_tmp11_.app_id);
#line 33 "../src/DesktopIntegration.vala"
				_tmp11_.app_id = _tmp7_;
#line 33 "../src/DesktopIntegration.vala"
				_g_hash_table_unref0 (_tmp11_.details);
#line 33 "../src/DesktopIntegration.vala"
				_tmp11_.details = _tmp10_;
#line 33 "../src/DesktopIntegration.vala"
				_vala_array_add2 (&returned_apps, &returned_apps_length1, &_returned_apps_size_, &_tmp11_);
#line 449 "DesktopIntegration.c"
			}
		}
	}
#line 39 "../src/DesktopIntegration.vala"
	_tmp12_ = returned_apps;
#line 39 "../src/DesktopIntegration.vala"
	_tmp12__length1 = returned_apps_length1;
#line 39 "../src/DesktopIntegration.vala"
	returned_apps = NULL;
#line 39 "../src/DesktopIntegration.vala"
	returned_apps_length1 = 0;
#line 39 "../src/DesktopIntegration.vala"
	_tmp13_ = _tmp12_;
#line 39 "../src/DesktopIntegration.vala"
	_tmp13__length1 = _tmp12__length1;
#line 39 "../src/DesktopIntegration.vala"
	if (result_length1) {
#line 39 "../src/DesktopIntegration.vala"
		*result_length1 = _tmp13__length1;
#line 469 "DesktopIntegration.c"
	}
#line 39 "../src/DesktopIntegration.vala"
	result = _tmp13_;
#line 39 "../src/DesktopIntegration.vala"
	(apps == NULL) ? NULL : (apps = (g_list_free (apps), NULL));
#line 39 "../src/DesktopIntegration.vala"
	returned_apps = (_vala_GalaDesktopIntegrationRunningApplication_array_free (returned_apps, returned_apps_length1), NULL);
#line 39 "../src/DesktopIntegration.vala"
	return result;
#line 479 "DesktopIntegration.c"
}

static gboolean
gala_desktop_integration_is_eligible_window (GalaDesktopIntegration* self,
                                             MetaWindow* window)
{
	gboolean result;
#line 42 "../src/DesktopIntegration.vala"
	g_return_val_if_fail (self != NULL, FALSE);
#line 42 "../src/DesktopIntegration.vala"
	g_return_val_if_fail (window != NULL, FALSE);
#line 43 "../src/DesktopIntegration.vala"
	if (meta_window_is_override_redirect (window)) {
#line 44 "../src/DesktopIntegration.vala"
		result = FALSE;
#line 44 "../src/DesktopIntegration.vala"
		return result;
#line 497 "DesktopIntegration.c"
	}
#line 47 "../src/DesktopIntegration.vala"
	switch (meta_window_get_window_type (window)) {
#line 47 "../src/DesktopIntegration.vala"
		case META_WINDOW_NORMAL:
#line 47 "../src/DesktopIntegration.vala"
		case META_WINDOW_DIALOG:
#line 47 "../src/DesktopIntegration.vala"
		case META_WINDOW_MODAL_DIALOG:
#line 47 "../src/DesktopIntegration.vala"
		case META_WINDOW_UTILITY:
#line 509 "DesktopIntegration.c"
		{
#line 52 "../src/DesktopIntegration.vala"
			result = TRUE;
#line 52 "../src/DesktopIntegration.vala"
			return result;
#line 515 "DesktopIntegration.c"
		}
		default:
		{
#line 54 "../src/DesktopIntegration.vala"
			result = FALSE;
#line 54 "../src/DesktopIntegration.vala"
			return result;
#line 523 "DesktopIntegration.c"
		}
	}
}

static gpointer
_g_object_ref0 (gpointer self)
{
#line 61 "../src/DesktopIntegration.vala"
	return self ? g_object_ref (self) : NULL;
#line 533 "DesktopIntegration.c"
}

static gpointer
_g_hash_table_ref0 (gpointer self)
{
#line 95 "../src/DesktopIntegration.vala"
	return self ? g_hash_table_ref (self) : NULL;
#line 541 "DesktopIntegration.c"
}

static void
_vala_array_add3 (GalaDesktopIntegrationWindow* * array,
                  gint* length,
                  gint* size,
                  const GalaDesktopIntegrationWindow* value)
{
#line 95 "../src/DesktopIntegration.vala"
	if ((*length) == (*size)) {
#line 95 "../src/DesktopIntegration.vala"
		*size = (*size) ? (2 * (*size)) : 4;
#line 95 "../src/DesktopIntegration.vala"
		*array = g_renew (GalaDesktopIntegrationWindow, *array, *size);
#line 556 "DesktopIntegration.c"
	}
#line 95 "../src/DesktopIntegration.vala"
	(*array)[(*length)++] = *value;
#line 560 "DesktopIntegration.c"
}

static void
_vala_GalaDesktopIntegrationWindow_array_free (GalaDesktopIntegrationWindow * array,
                                               gssize array_length)
{
#line 102 "../src/DesktopIntegration.vala"
	if (array != NULL) {
#line 569 "DesktopIntegration.c"
		gssize i;
#line 102 "../src/DesktopIntegration.vala"
		for (i = 0; i < array_length; i = i + 1) {
#line 102 "../src/DesktopIntegration.vala"
			gala_desktop_integration_window_destroy (&array[i]);
#line 575 "DesktopIntegration.c"
		}
	}
#line 102 "../src/DesktopIntegration.vala"
	g_free (array);
#line 580 "DesktopIntegration.c"
}

GalaDesktopIntegrationWindow*
gala_desktop_integration_get_windows (GalaDesktopIntegration* self,
                                      gint* result_length1,
                                      GError** error)
{
	GalaDesktopIntegrationWindow* returned_windows = NULL;
	GalaDesktopIntegrationWindow* _tmp0_;
	gint returned_windows_length1;
	gint _returned_windows_size_;
	GList* apps = NULL;
	GalaAppSystem* _tmp1_;
	GList* _tmp2_;
	MetaWorkspace* active_workspace = NULL;
	GalaWindowManagerGala* _tmp3_;
	MetaDisplay* _tmp4_;
	MetaWorkspaceManager* _tmp5_;
	MetaWorkspace* _tmp6_;
	MetaWorkspace* _tmp7_;
	GList* _tmp8_;
	GalaDesktopIntegrationWindow* _tmp63_;
	gint _tmp63__length1;
	GalaDesktopIntegrationWindow* _tmp64_;
	gint _tmp64__length1;
	GalaDesktopIntegrationWindow* result;
#line 58 "../src/DesktopIntegration.vala"
	g_return_val_if_fail (self != NULL, NULL);
#line 59 "../src/DesktopIntegration.vala"
	_tmp0_ = g_new0 (GalaDesktopIntegrationWindow, 0);
#line 59 "../src/DesktopIntegration.vala"
	returned_windows = _tmp0_;
#line 59 "../src/DesktopIntegration.vala"
	returned_windows_length1 = 0;
#line 59 "../src/DesktopIntegration.vala"
	_returned_windows_size_ = returned_windows_length1;
#line 60 "../src/DesktopIntegration.vala"
	_tmp1_ = gala_app_system_get_default ();
#line 60 "../src/DesktopIntegration.vala"
	_tmp2_ = gala_app_system_get_running_apps (_tmp1_);
#line 60 "../src/DesktopIntegration.vala"
	apps = _tmp2_;
#line 61 "../src/DesktopIntegration.vala"
	_tmp3_ = self->priv->wm;
#line 61 "../src/DesktopIntegration.vala"
	_tmp4_ = meta_plugin_get_display ((MetaPlugin*) _tmp3_);
#line 61 "../src/DesktopIntegration.vala"
	_tmp5_ = meta_display_get_workspace_manager (_tmp4_);
#line 61 "../src/DesktopIntegration.vala"
	_tmp6_ = meta_workspace_manager_get_active_workspace (_tmp5_);
#line 61 "../src/DesktopIntegration.vala"
	_tmp7_ = _g_object_ref0 (_tmp6_);
#line 61 "../src/DesktopIntegration.vala"
	active_workspace = _tmp7_;
#line 62 "../src/DesktopIntegration.vala"
	_tmp8_ = apps;
#line 637 "DesktopIntegration.c"
	{
		GList* app_collection = NULL;
		GList* app_it = NULL;
#line 62 "../src/DesktopIntegration.vala"
		app_collection = _tmp8_;
#line 62 "../src/DesktopIntegration.vala"
		for (app_it = app_collection; app_it != NULL; app_it = app_it->next) {
#line 645 "DesktopIntegration.c"
			GalaApp* app = NULL;
#line 62 "../src/DesktopIntegration.vala"
			app = (GalaApp*) app_it->data;
#line 649 "DesktopIntegration.c"
			{
				GalaApp* _tmp9_;
				GSList* _tmp10_;
#line 63 "../src/DesktopIntegration.vala"
				_tmp9_ = app;
#line 63 "../src/DesktopIntegration.vala"
				_tmp10_ = gala_app_get_windows (_tmp9_);
#line 657 "DesktopIntegration.c"
				{
					GSList* window_collection = NULL;
					GSList* window_it = NULL;
#line 63 "../src/DesktopIntegration.vala"
					window_collection = _tmp10_;
#line 63 "../src/DesktopIntegration.vala"
					for (window_it = window_collection; window_it != NULL; window_it = window_it->next) {
#line 665 "DesktopIntegration.c"
						MetaWindow* window = NULL;
#line 63 "../src/DesktopIntegration.vala"
						window = (MetaWindow*) window_it->data;
#line 669 "DesktopIntegration.c"
						{
							MetaWindow* _tmp11_;
							GHashTable* properties = NULL;
							GHashFunc _tmp12_;
							GEqualFunc _tmp13_;
							GHashTable* _tmp14_;
							MtkRectangle frame_rect = {0};
							MetaWindow* _tmp15_;
							MtkRectangle _tmp16_ = {0};
							const gchar* title = NULL;
							MetaWindow* _tmp17_;
							const gchar* _tmp18_;
							const gchar* wm_class = NULL;
							MetaWindow* _tmp19_;
							const gchar* _tmp20_;
							const gchar* sandboxed_app_id = NULL;
							MetaWindow* _tmp21_;
							const gchar* _tmp22_;
							GHashTable* _tmp23_;
							GalaApp* _tmp24_;
							const gchar* _tmp25_;
							const gchar* _tmp26_;
							GVariant* _tmp27_;
							GHashTable* _tmp28_;
							MetaWindow* _tmp29_;
							GVariant* _tmp30_;
							GHashTable* _tmp31_;
							MetaWindow* _tmp32_;
							GVariant* _tmp33_;
							GHashTable* _tmp34_;
							MetaWindow* _tmp35_;
							GVariant* _tmp36_;
							GHashTable* _tmp37_;
							MetaWindow* _tmp38_;
							MetaWorkspace* _tmp39_;
							GVariant* _tmp40_;
							GHashTable* _tmp41_;
							MtkRectangle _tmp42_;
							GVariant* _tmp43_;
							GHashTable* _tmp44_;
							MtkRectangle _tmp45_;
							GVariant* _tmp46_;
							const gchar* _tmp47_;
							const gchar* _tmp51_;
							const gchar* _tmp55_;
							MetaWindow* _tmp59_;
							GHashTable* _tmp60_;
							GHashTable* _tmp61_;
							GalaDesktopIntegrationWindow _tmp62_ = {0};
#line 64 "../src/DesktopIntegration.vala"
							_tmp11_ = window;
#line 64 "../src/DesktopIntegration.vala"
							if (!gala_desktop_integration_is_eligible_window (self, _tmp11_)) {
#line 65 "../src/DesktopIntegration.vala"
								continue;
#line 725 "DesktopIntegration.c"
							}
#line 68 "../src/DesktopIntegration.vala"
							_tmp12_ = g_str_hash;
#line 68 "../src/DesktopIntegration.vala"
							_tmp13_ = g_str_equal;
#line 68 "../src/DesktopIntegration.vala"
							_tmp14_ = g_hash_table_new_full (_tmp12_, _tmp13_, NULL, _g_variant_unref0_);
#line 68 "../src/DesktopIntegration.vala"
							properties = _tmp14_;
#line 69 "../src/DesktopIntegration.vala"
							_tmp15_ = window;
#line 69 "../src/DesktopIntegration.vala"
							meta_window_get_frame_rect (_tmp15_, &_tmp16_);
#line 69 "../src/DesktopIntegration.vala"
							frame_rect = _tmp16_;
#line 70 "../src/DesktopIntegration.vala"
							_tmp17_ = window;
#line 70 "../src/DesktopIntegration.vala"
							_tmp18_ = meta_window_get_title (_tmp17_);
#line 70 "../src/DesktopIntegration.vala"
							title = _tmp18_;
#line 71 "../src/DesktopIntegration.vala"
							_tmp19_ = window;
#line 71 "../src/DesktopIntegration.vala"
							_tmp20_ = meta_window_get_wm_class (_tmp19_);
#line 71 "../src/DesktopIntegration.vala"
							wm_class = _tmp20_;
#line 72 "../src/DesktopIntegration.vala"
							_tmp21_ = window;
#line 72 "../src/DesktopIntegration.vala"
							_tmp22_ = meta_window_get_sandboxed_app_id (_tmp21_);
#line 72 "../src/DesktopIntegration.vala"
							sandboxed_app_id = _tmp22_;
#line 74 "../src/DesktopIntegration.vala"
							_tmp23_ = properties;
#line 74 "../src/DesktopIntegration.vala"
							_tmp24_ = app;
#line 74 "../src/DesktopIntegration.vala"
							_tmp25_ = gala_app_get_id (_tmp24_);
#line 74 "../src/DesktopIntegration.vala"
							_tmp26_ = _tmp25_;
#line 74 "../src/DesktopIntegration.vala"
							_tmp27_ = g_variant_new_string (_tmp26_);
#line 74 "../src/DesktopIntegration.vala"
							g_variant_ref_sink (_tmp27_);
#line 74 "../src/DesktopIntegration.vala"
							g_hash_table_insert (_tmp23_, "app-id", _tmp27_);
#line 75 "../src/DesktopIntegration.vala"
							_tmp28_ = properties;
#line 75 "../src/DesktopIntegration.vala"
							_tmp29_ = window;
#line 75 "../src/DesktopIntegration.vala"
							_tmp30_ = g_variant_new_uint32 ((guint32) meta_window_get_client_type (_tmp29_));
#line 75 "../src/DesktopIntegration.vala"
							g_variant_ref_sink (_tmp30_);
#line 75 "../src/DesktopIntegration.vala"
							g_hash_table_insert (_tmp28_, "client-type", _tmp30_);
#line 76 "../src/DesktopIntegration.vala"
							_tmp31_ = properties;
#line 76 "../src/DesktopIntegration.vala"
							_tmp32_ = window;
#line 76 "../src/DesktopIntegration.vala"
							_tmp33_ = g_variant_new_boolean (meta_window_is_hidden (_tmp32_));
#line 76 "../src/DesktopIntegration.vala"
							g_variant_ref_sink (_tmp33_);
#line 76 "../src/DesktopIntegration.vala"
							g_hash_table_insert (_tmp31_, "is-hidden", _tmp33_);
#line 77 "../src/DesktopIntegration.vala"
							_tmp34_ = properties;
#line 77 "../src/DesktopIntegration.vala"
							_tmp35_ = window;
#line 77 "../src/DesktopIntegration.vala"
							_tmp36_ = g_variant_new_boolean (meta_window_has_focus (_tmp35_));
#line 77 "../src/DesktopIntegration.vala"
							g_variant_ref_sink (_tmp36_);
#line 77 "../src/DesktopIntegration.vala"
							g_hash_table_insert (_tmp34_, "has-focus", _tmp36_);
#line 78 "../src/DesktopIntegration.vala"
							_tmp37_ = properties;
#line 78 "../src/DesktopIntegration.vala"
							_tmp38_ = window;
#line 78 "../src/DesktopIntegration.vala"
							_tmp39_ = active_workspace;
#line 78 "../src/DesktopIntegration.vala"
							_tmp40_ = g_variant_new_boolean (meta_window_located_on_workspace (_tmp38_, _tmp39_));
#line 78 "../src/DesktopIntegration.vala"
							g_variant_ref_sink (_tmp40_);
#line 78 "../src/DesktopIntegration.vala"
							g_hash_table_insert (_tmp37_, "on-active-workspace", _tmp40_);
#line 79 "../src/DesktopIntegration.vala"
							_tmp41_ = properties;
#line 79 "../src/DesktopIntegration.vala"
							_tmp42_ = frame_rect;
#line 79 "../src/DesktopIntegration.vala"
							_tmp43_ = g_variant_new_uint32 ((guint32) _tmp42_.width);
#line 79 "../src/DesktopIntegration.vala"
							g_variant_ref_sink (_tmp43_);
#line 79 "../src/DesktopIntegration.vala"
							g_hash_table_insert (_tmp41_, "width", _tmp43_);
#line 80 "../src/DesktopIntegration.vala"
							_tmp44_ = properties;
#line 80 "../src/DesktopIntegration.vala"
							_tmp45_ = frame_rect;
#line 80 "../src/DesktopIntegration.vala"
							_tmp46_ = g_variant_new_uint32 ((guint32) _tmp45_.height);
#line 80 "../src/DesktopIntegration.vala"
							g_variant_ref_sink (_tmp46_);
#line 80 "../src/DesktopIntegration.vala"
							g_hash_table_insert (_tmp44_, "height", _tmp46_);
#line 83 "../src/DesktopIntegration.vala"
							_tmp47_ = title;
#line 83 "../src/DesktopIntegration.vala"
							if (_tmp47_ != NULL) {
#line 839 "DesktopIntegration.c"
								GHashTable* _tmp48_;
								const gchar* _tmp49_;
								GVariant* _tmp50_;
#line 84 "../src/DesktopIntegration.vala"
								_tmp48_ = properties;
#line 84 "../src/DesktopIntegration.vala"
								_tmp49_ = title;
#line 84 "../src/DesktopIntegration.vala"
								_tmp50_ = g_variant_new_string (_tmp49_);
#line 84 "../src/DesktopIntegration.vala"
								g_variant_ref_sink (_tmp50_);
#line 84 "../src/DesktopIntegration.vala"
								g_hash_table_insert (_tmp48_, "title", _tmp50_);
#line 853 "DesktopIntegration.c"
							}
#line 87 "../src/DesktopIntegration.vala"
							_tmp51_ = wm_class;
#line 87 "../src/DesktopIntegration.vala"
							if (_tmp51_ != NULL) {
#line 859 "DesktopIntegration.c"
								GHashTable* _tmp52_;
								const gchar* _tmp53_;
								GVariant* _tmp54_;
#line 88 "../src/DesktopIntegration.vala"
								_tmp52_ = properties;
#line 88 "../src/DesktopIntegration.vala"
								_tmp53_ = wm_class;
#line 88 "../src/DesktopIntegration.vala"
								_tmp54_ = g_variant_new_string (_tmp53_);
#line 88 "../src/DesktopIntegration.vala"
								g_variant_ref_sink (_tmp54_);
#line 88 "../src/DesktopIntegration.vala"
								g_hash_table_insert (_tmp52_, "wm-class", _tmp54_);
#line 873 "DesktopIntegration.c"
							}
#line 91 "../src/DesktopIntegration.vala"
							_tmp55_ = sandboxed_app_id;
#line 91 "../src/DesktopIntegration.vala"
							if (_tmp55_ != NULL) {
#line 879 "DesktopIntegration.c"
								GHashTable* _tmp56_;
								const gchar* _tmp57_;
								GVariant* _tmp58_;
#line 92 "../src/DesktopIntegration.vala"
								_tmp56_ = properties;
#line 92 "../src/DesktopIntegration.vala"
								_tmp57_ = sandboxed_app_id;
#line 92 "../src/DesktopIntegration.vala"
								_tmp58_ = g_variant_new_string (_tmp57_);
#line 92 "../src/DesktopIntegration.vala"
								g_variant_ref_sink (_tmp58_);
#line 92 "../src/DesktopIntegration.vala"
								g_hash_table_insert (_tmp56_, "sandboxed-app-id", _tmp58_);
#line 893 "DesktopIntegration.c"
							}
#line 95 "../src/DesktopIntegration.vala"
							_tmp59_ = window;
#line 95 "../src/DesktopIntegration.vala"
							_tmp60_ = properties;
#line 95 "../src/DesktopIntegration.vala"
							_tmp61_ = _g_hash_table_ref0 (_tmp60_);
#line 95 "../src/DesktopIntegration.vala"
							memset (&_tmp62_, 0, sizeof (GalaDesktopIntegrationWindow));
#line 95 "../src/DesktopIntegration.vala"
							_tmp62_.uid = meta_window_get_id (_tmp59_);
#line 95 "../src/DesktopIntegration.vala"
							_g_hash_table_unref0 (_tmp62_.properties);
#line 95 "../src/DesktopIntegration.vala"
							_tmp62_.properties = _tmp61_;
#line 95 "../src/DesktopIntegration.vala"
							_vala_array_add3 (&returned_windows, &returned_windows_length1, &_returned_windows_size_, &_tmp62_);
#line 63 "../src/DesktopIntegration.vala"
							_g_hash_table_unref0 (properties);
#line 913 "DesktopIntegration.c"
						}
					}
				}
			}
		}
	}
#line 102 "../src/DesktopIntegration.vala"
	_tmp63_ = returned_windows;
#line 102 "../src/DesktopIntegration.vala"
	_tmp63__length1 = returned_windows_length1;
#line 102 "../src/DesktopIntegration.vala"
	returned_windows = NULL;
#line 102 "../src/DesktopIntegration.vala"
	returned_windows_length1 = 0;
#line 102 "../src/DesktopIntegration.vala"
	_tmp64_ = _tmp63_;
#line 102 "../src/DesktopIntegration.vala"
	_tmp64__length1 = _tmp63__length1;
#line 102 "../src/DesktopIntegration.vala"
	if (result_length1) {
#line 102 "../src/DesktopIntegration.vala"
		*result_length1 = _tmp64__length1;
#line 936 "DesktopIntegration.c"
	}
#line 102 "../src/DesktopIntegration.vala"
	result = _tmp64_;
#line 102 "../src/DesktopIntegration.vala"
	_g_object_unref0 (active_workspace);
#line 102 "../src/DesktopIntegration.vala"
	(apps == NULL) ? NULL : (apps = (g_list_free (apps), NULL));
#line 102 "../src/DesktopIntegration.vala"
	returned_windows = (_vala_GalaDesktopIntegrationWindow_array_free (returned_windows, returned_windows_length1), NULL);
#line 102 "../src/DesktopIntegration.vala"
	return result;
#line 948 "DesktopIntegration.c"
}

void
gala_desktop_integration_focus_window (GalaDesktopIntegration* self,
                                       guint64 uid,
                                       GError** error)
{
	GList* apps = NULL;
	GalaAppSystem* _tmp0_;
	GList* _tmp1_;
	GList* _tmp2_;
#line 105 "../src/DesktopIntegration.vala"
	g_return_if_fail (self != NULL);
#line 106 "../src/DesktopIntegration.vala"
	_tmp0_ = gala_app_system_get_default ();
#line 106 "../src/DesktopIntegration.vala"
	_tmp1_ = gala_app_system_get_running_apps (_tmp0_);
#line 106 "../src/DesktopIntegration.vala"
	apps = _tmp1_;
#line 107 "../src/DesktopIntegration.vala"
	_tmp2_ = apps;
#line 970 "DesktopIntegration.c"
	{
		GList* app_collection = NULL;
		GList* app_it = NULL;
#line 107 "../src/DesktopIntegration.vala"
		app_collection = _tmp2_;
#line 107 "../src/DesktopIntegration.vala"
		for (app_it = app_collection; app_it != NULL; app_it = app_it->next) {
#line 978 "DesktopIntegration.c"
			GalaApp* app = NULL;
#line 107 "../src/DesktopIntegration.vala"
			app = (GalaApp*) app_it->data;
#line 982 "DesktopIntegration.c"
			{
				GalaApp* _tmp3_;
				GSList* _tmp4_;
#line 108 "../src/DesktopIntegration.vala"
				_tmp3_ = app;
#line 108 "../src/DesktopIntegration.vala"
				_tmp4_ = gala_app_get_windows (_tmp3_);
#line 990 "DesktopIntegration.c"
				{
					GSList* window_collection = NULL;
					GSList* window_it = NULL;
#line 108 "../src/DesktopIntegration.vala"
					window_collection = _tmp4_;
#line 108 "../src/DesktopIntegration.vala"
					for (window_it = window_collection; window_it != NULL; window_it = window_it->next) {
#line 998 "DesktopIntegration.c"
						MetaWindow* window = NULL;
#line 108 "../src/DesktopIntegration.vala"
						window = (MetaWindow*) window_it->data;
#line 1002 "DesktopIntegration.c"
						{
							MetaWindow* _tmp5_;
#line 109 "../src/DesktopIntegration.vala"
							_tmp5_ = window;
#line 109 "../src/DesktopIntegration.vala"
							if (meta_window_get_id (_tmp5_) == uid) {
#line 1009 "DesktopIntegration.c"
								MetaWindow* _tmp6_;
								MetaWorkspace* _tmp7_;
								MetaWindow* _tmp8_;
								GalaWindowManagerGala* _tmp9_;
								MetaDisplay* _tmp10_;
#line 110 "../src/DesktopIntegration.vala"
								_tmp6_ = window;
#line 110 "../src/DesktopIntegration.vala"
								_tmp7_ = meta_window_get_workspace (_tmp6_);
#line 110 "../src/DesktopIntegration.vala"
								_tmp8_ = window;
#line 110 "../src/DesktopIntegration.vala"
								_tmp9_ = self->priv->wm;
#line 110 "../src/DesktopIntegration.vala"
								_tmp10_ = meta_plugin_get_display ((MetaPlugin*) _tmp9_);
#line 110 "../src/DesktopIntegration.vala"
								meta_workspace_activate_with_focus (_tmp7_, _tmp8_, meta_display_get_current_time (_tmp10_));
#line 1027 "DesktopIntegration.c"
							}
						}
					}
				}
			}
		}
	}
#line 105 "../src/DesktopIntegration.vala"
	(apps == NULL) ? NULL : (apps = (g_list_free (apps), NULL));
#line 1037 "DesktopIntegration.c"
}

static void
_vala_array_add4 (guint64* * array,
                  gint* length,
                  gint* size,
                  guint64 value)
{
#line 128 "../src/DesktopIntegration.vala"
	if ((*length) == (*size)) {
#line 128 "../src/DesktopIntegration.vala"
		*size = (*size) ? (2 * (*size)) : 4;
#line 128 "../src/DesktopIntegration.vala"
		*array = g_renew (guint64, *array, *size);
#line 1052 "DesktopIntegration.c"
	}
#line 128 "../src/DesktopIntegration.vala"
	(*array)[(*length)++] = value;
#line 1056 "DesktopIntegration.c"
}

static void
_g_free0_ (gpointer var)
{
#line 131 "../src/DesktopIntegration.vala"
	var = (g_free (var), NULL);
#line 1064 "DesktopIntegration.c"
}

static GVariant*
_variant_new1 (guint64* value,
               gint value_length1)
{
	guint64* _tmp20_;
	GVariantBuilder _tmp21_;
	gint _tmp22_;
#line 132 "../src/DesktopIntegration.vala"
	_tmp20_ = value;
#line 132 "../src/DesktopIntegration.vala"
	g_variant_builder_init (&_tmp21_, G_VARIANT_TYPE ("at"));
#line 132 "../src/DesktopIntegration.vala"
	for (_tmp22_ = 0; _tmp22_ < value_length1; _tmp22_++) {
#line 132 "../src/DesktopIntegration.vala"
		g_variant_builder_add_value (&_tmp21_, g_variant_new_uint64 (*_tmp20_));
#line 132 "../src/DesktopIntegration.vala"
		_tmp20_++;
#line 1084 "DesktopIntegration.c"
	}
#line 132 "../src/DesktopIntegration.vala"
	return g_variant_ref_sink (g_variant_builder_end (&_tmp21_));
#line 1088 "DesktopIntegration.c"
}

void
gala_desktop_integration_show_windows_for (GalaDesktopIntegration* self,
                                           const gchar* app_id,
                                           GError** error)
{
	GalaWindowManagerGala* _tmp0_;
	GalaActivatableComponent* _tmp1_;
	GalaActivatableComponent* _tmp2_;
	GalaApp* app = NULL;
	GalaAppSystem* _tmp4_;
	GalaApp* _tmp5_;
	GalaApp* _tmp6_;
	GalaApp* _tmp7_;
	guint64* window_ids = NULL;
	guint64* _tmp9_;
	gint window_ids_length1;
	gint _window_ids_size_;
	GalaApp* _tmp10_;
	GSList* _tmp11_;
	GHashTable* hints = NULL;
	GHashFunc _tmp14_;
	GEqualFunc _tmp15_;
	GHashTable* _tmp16_;
	GHashTable* _tmp17_;
	gchar* _tmp18_;
	guint64* _tmp19_;
	gint _tmp19__length1;
	GVariant* _tmp23_;
	GalaWindowManagerGala* _tmp24_;
	GalaActivatableComponent* _tmp25_;
	GalaActivatableComponent* _tmp26_;
	GalaWindowManagerGala* _tmp30_;
	GalaActivatableComponent* _tmp31_;
	GalaActivatableComponent* _tmp32_;
	GHashTable* _tmp33_;
	GError* _inner_error0_ = NULL;
#line 116 "../src/DesktopIntegration.vala"
	g_return_if_fail (self != NULL);
#line 116 "../src/DesktopIntegration.vala"
	g_return_if_fail (app_id != NULL);
#line 117 "../src/DesktopIntegration.vala"
	_tmp0_ = self->priv->wm;
#line 117 "../src/DesktopIntegration.vala"
	_tmp1_ = gala_window_manager_gala_get_window_overview (_tmp0_);
#line 117 "../src/DesktopIntegration.vala"
	_tmp2_ = _tmp1_;
#line 117 "../src/DesktopIntegration.vala"
	if (_tmp2_ == NULL) {
#line 1139 "DesktopIntegration.c"
		GError* _tmp3_;
#line 118 "../src/DesktopIntegration.vala"
		_tmp3_ = g_error_new_literal (G_IO_ERROR, G_IO_ERROR_FAILED, "Window overview not provided by window manager");
#line 118 "../src/DesktopIntegration.vala"
		_inner_error0_ = _tmp3_;
#line 118 "../src/DesktopIntegration.vala"
		if ((_inner_error0_->domain == G_IO_ERROR) || (_inner_error0_->domain == G_DBUS_ERROR)) {
#line 118 "../src/DesktopIntegration.vala"
			g_propagate_error (error, _inner_error0_);
#line 118 "../src/DesktopIntegration.vala"
			return;
#line 1151 "DesktopIntegration.c"
		} else {
#line 118 "../src/DesktopIntegration.vala"
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error0_->message, g_quark_to_string (_inner_error0_->domain), _inner_error0_->code);
#line 118 "../src/DesktopIntegration.vala"
			g_clear_error (&_inner_error0_);
#line 118 "../src/DesktopIntegration.vala"
			return;
#line 1159 "DesktopIntegration.c"
		}
	}
#line 122 "../src/DesktopIntegration.vala"
	_tmp4_ = gala_app_system_get_default ();
#line 122 "../src/DesktopIntegration.vala"
	_tmp5_ = gala_app_system_lookup_app (_tmp4_, app_id);
#line 122 "../src/DesktopIntegration.vala"
	_tmp6_ = _g_object_ref0 (_tmp5_);
#line 122 "../src/DesktopIntegration.vala"
	_g_object_unref0 (app);
#line 122 "../src/DesktopIntegration.vala"
	app = _tmp6_;
#line 122 "../src/DesktopIntegration.vala"
	_tmp7_ = app;
#line 122 "../src/DesktopIntegration.vala"
	if (_tmp7_ == NULL) {
#line 1176 "DesktopIntegration.c"
		GError* _tmp8_;
#line 123 "../src/DesktopIntegration.vala"
		_tmp8_ = g_error_new_literal (G_IO_ERROR, G_IO_ERROR_NOT_FOUND, "App not found");
#line 123 "../src/DesktopIntegration.vala"
		_inner_error0_ = _tmp8_;
#line 123 "../src/DesktopIntegration.vala"
		if ((_inner_error0_->domain == G_IO_ERROR) || (_inner_error0_->domain == G_DBUS_ERROR)) {
#line 123 "../src/DesktopIntegration.vala"
			g_propagate_error (error, _inner_error0_);
#line 123 "../src/DesktopIntegration.vala"
			_g_object_unref0 (app);
#line 123 "../src/DesktopIntegration.vala"
			return;
#line 1190 "DesktopIntegration.c"
		} else {
#line 123 "../src/DesktopIntegration.vala"
			_g_object_unref0 (app);
#line 123 "../src/DesktopIntegration.vala"
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error0_->message, g_quark_to_string (_inner_error0_->domain), _inner_error0_->code);
#line 123 "../src/DesktopIntegration.vala"
			g_clear_error (&_inner_error0_);
#line 123 "../src/DesktopIntegration.vala"
			return;
#line 1200 "DesktopIntegration.c"
		}
	}
#line 126 "../src/DesktopIntegration.vala"
	_tmp9_ = g_new0 (guint64, 0);
#line 126 "../src/DesktopIntegration.vala"
	window_ids = _tmp9_;
#line 126 "../src/DesktopIntegration.vala"
	window_ids_length1 = 0;
#line 126 "../src/DesktopIntegration.vala"
	_window_ids_size_ = window_ids_length1;
#line 127 "../src/DesktopIntegration.vala"
	_tmp10_ = app;
#line 127 "../src/DesktopIntegration.vala"
	_tmp11_ = gala_app_get_windows (_tmp10_);
#line 1215 "DesktopIntegration.c"
	{
		GSList* window_collection = NULL;
		GSList* window_it = NULL;
#line 127 "../src/DesktopIntegration.vala"
		window_collection = _tmp11_;
#line 127 "../src/DesktopIntegration.vala"
		for (window_it = window_collection; window_it != NULL; window_it = window_it->next) {
#line 1223 "DesktopIntegration.c"
			MetaWindow* _tmp12_;
			MetaWindow* window = NULL;
#line 127 "../src/DesktopIntegration.vala"
			_tmp12_ = _g_object_ref0 ((MetaWindow*) window_it->data);
#line 127 "../src/DesktopIntegration.vala"
			window = _tmp12_;
#line 1230 "DesktopIntegration.c"
			{
				MetaWindow* _tmp13_;
#line 128 "../src/DesktopIntegration.vala"
				_tmp13_ = window;
#line 128 "../src/DesktopIntegration.vala"
				_vala_array_add4 (&window_ids, &window_ids_length1, &_window_ids_size_, meta_window_get_id (_tmp13_));
#line 127 "../src/DesktopIntegration.vala"
				_g_object_unref0 (window);
#line 1239 "DesktopIntegration.c"
			}
		}
	}
#line 131 "../src/DesktopIntegration.vala"
	_tmp14_ = g_str_hash;
#line 131 "../src/DesktopIntegration.vala"
	_tmp15_ = g_str_equal;
#line 131 "../src/DesktopIntegration.vala"
	_tmp16_ = g_hash_table_new_full (_tmp14_, _tmp15_, _g_free0_, _g_variant_unref0_);
#line 131 "../src/DesktopIntegration.vala"
	hints = _tmp16_;
#line 132 "../src/DesktopIntegration.vala"
	_tmp17_ = hints;
#line 132 "../src/DesktopIntegration.vala"
	_tmp18_ = g_strdup ("windows");
#line 132 "../src/DesktopIntegration.vala"
	_tmp19_ = window_ids;
#line 132 "../src/DesktopIntegration.vala"
	_tmp19__length1 = window_ids_length1;
#line 132 "../src/DesktopIntegration.vala"
	_tmp23_ = _variant_new1 (_tmp19_, _tmp19__length1);
#line 132 "../src/DesktopIntegration.vala"
	g_hash_table_insert (_tmp17_, _tmp18_, _tmp23_);
#line 134 "../src/DesktopIntegration.vala"
	_tmp24_ = self->priv->wm;
#line 134 "../src/DesktopIntegration.vala"
	_tmp25_ = gala_window_manager_gala_get_window_overview (_tmp24_);
#line 134 "../src/DesktopIntegration.vala"
	_tmp26_ = _tmp25_;
#line 134 "../src/DesktopIntegration.vala"
	if (gala_activatable_component_is_opened (_tmp26_)) {
#line 1271 "DesktopIntegration.c"
		GalaWindowManagerGala* _tmp27_;
		GalaActivatableComponent* _tmp28_;
		GalaActivatableComponent* _tmp29_;
#line 135 "../src/DesktopIntegration.vala"
		_tmp27_ = self->priv->wm;
#line 135 "../src/DesktopIntegration.vala"
		_tmp28_ = gala_window_manager_gala_get_window_overview (_tmp27_);
#line 135 "../src/DesktopIntegration.vala"
		_tmp29_ = _tmp28_;
#line 135 "../src/DesktopIntegration.vala"
		gala_activatable_component_close (_tmp29_, NULL);
#line 1283 "DesktopIntegration.c"
	}
#line 138 "../src/DesktopIntegration.vala"
	_tmp30_ = self->priv->wm;
#line 138 "../src/DesktopIntegration.vala"
	_tmp31_ = gala_window_manager_gala_get_window_overview (_tmp30_);
#line 138 "../src/DesktopIntegration.vala"
	_tmp32_ = _tmp31_;
#line 138 "../src/DesktopIntegration.vala"
	_tmp33_ = hints;
#line 138 "../src/DesktopIntegration.vala"
	gala_activatable_component_open (_tmp32_, _tmp33_);
#line 116 "../src/DesktopIntegration.vala"
	_g_hash_table_unref0 (hints);
#line 116 "../src/DesktopIntegration.vala"
	window_ids = (g_free (window_ids), NULL);
#line 116 "../src/DesktopIntegration.vala"
	_g_object_unref0 (app);
#line 1301 "DesktopIntegration.c"
}

guint
gala_desktop_integration_get_version (GalaDesktopIntegration* self)
{
	guint result;
#line 20 "../src/DesktopIntegration.vala"
	g_return_val_if_fail (self != NULL, 0U);
#line 20 "../src/DesktopIntegration.vala"
	result = self->priv->_version;
#line 20 "../src/DesktopIntegration.vala"
	return result;
#line 1314 "DesktopIntegration.c"
}

void
gala_desktop_integration_running_application_copy (const GalaDesktopIntegrationRunningApplication* self,
                                                   GalaDesktopIntegrationRunningApplication* dest)
{
	const gchar* _tmp0_;
	gchar* _tmp1_;
	GHashTable* _tmp2_;
	GHashTable* _tmp3_;
#line 9 "../src/DesktopIntegration.vala"
	_tmp0_ = (*self).app_id;
#line 9 "../src/DesktopIntegration.vala"
	_tmp1_ = g_strdup (_tmp0_);
#line 9 "../src/DesktopIntegration.vala"
	_g_free0 ((*dest).app_id);
#line 9 "../src/DesktopIntegration.vala"
	(*dest).app_id = _tmp1_;
#line 9 "../src/DesktopIntegration.vala"
	_tmp2_ = (*self).details;
#line 9 "../src/DesktopIntegration.vala"
	_tmp3_ = _g_hash_table_ref0 (_tmp2_);
#line 9 "../src/DesktopIntegration.vala"
	_g_hash_table_unref0 ((*dest).details);
#line 9 "../src/DesktopIntegration.vala"
	(*dest).details = _tmp3_;
#line 1341 "DesktopIntegration.c"
}

void
gala_desktop_integration_running_application_destroy (GalaDesktopIntegrationRunningApplication* self)
{
#line 10 "../src/DesktopIntegration.vala"
	_g_free0 ((*self).app_id);
#line 11 "../src/DesktopIntegration.vala"
	_g_hash_table_unref0 ((*self).details);
#line 1351 "DesktopIntegration.c"
}

GalaDesktopIntegrationRunningApplication*
gala_desktop_integration_running_application_dup (const GalaDesktopIntegrationRunningApplication* self)
{
	GalaDesktopIntegrationRunningApplication* dup;
#line 9 "../src/DesktopIntegration.vala"
	dup = g_new0 (GalaDesktopIntegrationRunningApplication, 1);
#line 9 "../src/DesktopIntegration.vala"
	gala_desktop_integration_running_application_copy (self, dup);
#line 9 "../src/DesktopIntegration.vala"
	return dup;
#line 1364 "DesktopIntegration.c"
}

void
gala_desktop_integration_running_application_free (GalaDesktopIntegrationRunningApplication* self)
{
#line 9 "../src/DesktopIntegration.vala"
	gala_desktop_integration_running_application_destroy (self);
#line 9 "../src/DesktopIntegration.vala"
	g_free (self);
#line 1374 "DesktopIntegration.c"
}

 G_GNUC_NO_INLINE static GType
gala_desktop_integration_running_application_get_type_once (void)
{
	GType gala_desktop_integration_running_application_type_id;
	gala_desktop_integration_running_application_type_id = g_boxed_type_register_static ("GalaDesktopIntegrationRunningApplication", (GBoxedCopyFunc) gala_desktop_integration_running_application_dup, (GBoxedFreeFunc) gala_desktop_integration_running_application_free);
	return gala_desktop_integration_running_application_type_id;
}

GType
gala_desktop_integration_running_application_get_type (void)
{
	static gsize gala_desktop_integration_running_application_type_id__once = 0;
	if (g_once_init_enter (&gala_desktop_integration_running_application_type_id__once)) {
		GType gala_desktop_integration_running_application_type_id;
		gala_desktop_integration_running_application_type_id = gala_desktop_integration_running_application_get_type_once ();
		g_once_init_leave (&gala_desktop_integration_running_application_type_id__once, gala_desktop_integration_running_application_type_id);
	}
	return gala_desktop_integration_running_application_type_id__once;
}

void
gala_desktop_integration_window_copy (const GalaDesktopIntegrationWindow* self,
                                      GalaDesktopIntegrationWindow* dest)
{
	GHashTable* _tmp0_;
	GHashTable* _tmp1_;
#line 14 "../src/DesktopIntegration.vala"
	(*dest).uid = (*self).uid;
#line 14 "../src/DesktopIntegration.vala"
	_tmp0_ = (*self).properties;
#line 14 "../src/DesktopIntegration.vala"
	_tmp1_ = _g_hash_table_ref0 (_tmp0_);
#line 14 "../src/DesktopIntegration.vala"
	_g_hash_table_unref0 ((*dest).properties);
#line 14 "../src/DesktopIntegration.vala"
	(*dest).properties = _tmp1_;
#line 1413 "DesktopIntegration.c"
}

void
gala_desktop_integration_window_destroy (GalaDesktopIntegrationWindow* self)
{
#line 16 "../src/DesktopIntegration.vala"
	_g_hash_table_unref0 ((*self).properties);
#line 1421 "DesktopIntegration.c"
}

GalaDesktopIntegrationWindow*
gala_desktop_integration_window_dup (const GalaDesktopIntegrationWindow* self)
{
	GalaDesktopIntegrationWindow* dup;
#line 14 "../src/DesktopIntegration.vala"
	dup = g_new0 (GalaDesktopIntegrationWindow, 1);
#line 14 "../src/DesktopIntegration.vala"
	gala_desktop_integration_window_copy (self, dup);
#line 14 "../src/DesktopIntegration.vala"
	return dup;
#line 1434 "DesktopIntegration.c"
}

void
gala_desktop_integration_window_free (GalaDesktopIntegrationWindow* self)
{
#line 14 "../src/DesktopIntegration.vala"
	gala_desktop_integration_window_destroy (self);
#line 14 "../src/DesktopIntegration.vala"
	g_free (self);
#line 1444 "DesktopIntegration.c"
}

 G_GNUC_NO_INLINE static GType
gala_desktop_integration_window_get_type_once (void)
{
	GType gala_desktop_integration_window_type_id;
	gala_desktop_integration_window_type_id = g_boxed_type_register_static ("GalaDesktopIntegrationWindow", (GBoxedCopyFunc) gala_desktop_integration_window_dup, (GBoxedFreeFunc) gala_desktop_integration_window_free);
	return gala_desktop_integration_window_type_id;
}

GType
gala_desktop_integration_window_get_type (void)
{
	static gsize gala_desktop_integration_window_type_id__once = 0;
	if (g_once_init_enter (&gala_desktop_integration_window_type_id__once)) {
		GType gala_desktop_integration_window_type_id;
		gala_desktop_integration_window_type_id = gala_desktop_integration_window_get_type_once ();
		g_once_init_leave (&gala_desktop_integration_window_type_id__once, gala_desktop_integration_window_type_id);
	}
	return gala_desktop_integration_window_type_id__once;
}

static void
gala_desktop_integration_class_init (GalaDesktopIntegrationClass * klass,
                                     gpointer klass_data)
{
#line 8 "../src/DesktopIntegration.vala"
	gala_desktop_integration_parent_class = g_type_class_peek_parent (klass);
#line 8 "../src/DesktopIntegration.vala"
	g_type_class_adjust_private_offset (klass, &GalaDesktopIntegration_private_offset);
#line 8 "../src/DesktopIntegration.vala"
	G_OBJECT_CLASS (klass)->get_property = _vala_gala_desktop_integration_get_property;
#line 8 "../src/DesktopIntegration.vala"
	G_OBJECT_CLASS (klass)->finalize = gala_desktop_integration_finalize;
#line 8 "../src/DesktopIntegration.vala"
	g_object_class_install_property (G_OBJECT_CLASS (klass), GALA_DESKTOP_INTEGRATION_VERSION_PROPERTY, gala_desktop_integration_properties[GALA_DESKTOP_INTEGRATION_VERSION_PROPERTY] = g_param_spec_uint ("version", "version", "version", 0, G_MAXUINT, (guint) 1, G_PARAM_STATIC_STRINGS | G_PARAM_READABLE));
#line 8 "../src/DesktopIntegration.vala"
	gala_desktop_integration_signals[GALA_DESKTOP_INTEGRATION_RUNNING_APPLICATIONS_CHANGED_SIGNAL] = g_signal_new ("running-applications-changed", GALA_TYPE_DESKTOP_INTEGRATION, G_SIGNAL_RUN_LAST, 0, NULL, NULL, g_cclosure_marshal_VOID__VOID, G_TYPE_NONE, 0);
#line 8 "../src/DesktopIntegration.vala"
	gala_desktop_integration_signals[GALA_DESKTOP_INTEGRATION_WINDOWS_CHANGED_SIGNAL] = g_signal_new ("windows-changed", GALA_TYPE_DESKTOP_INTEGRATION, G_SIGNAL_RUN_LAST, 0, NULL, NULL, g_cclosure_marshal_VOID__VOID, G_TYPE_NONE, 0);
#line 1485 "DesktopIntegration.c"
}

static void
gala_desktop_integration_instance_init (GalaDesktopIntegration * self,
                                        gpointer klass)
{
#line 8 "../src/DesktopIntegration.vala"
	self->priv = gala_desktop_integration_get_instance_private (self);
#line 20 "../src/DesktopIntegration.vala"
	self->priv->_version = (guint) 1;
#line 1496 "DesktopIntegration.c"
}

static void
gala_desktop_integration_finalize (GObject * obj)
{
	GalaDesktopIntegration * self;
#line 8 "../src/DesktopIntegration.vala"
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, GALA_TYPE_DESKTOP_INTEGRATION, GalaDesktopIntegration);
#line 8 "../src/DesktopIntegration.vala"
	G_OBJECT_CLASS (gala_desktop_integration_parent_class)->finalize (obj);
#line 1507 "DesktopIntegration.c"
}

 G_GNUC_NO_INLINE static GType
gala_desktop_integration_get_type_once (void)
{
	static const GTypeInfo g_define_type_info = { sizeof (GalaDesktopIntegrationClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) gala_desktop_integration_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (GalaDesktopIntegration), 0, (GInstanceInitFunc) gala_desktop_integration_instance_init, NULL };
	GType gala_desktop_integration_type_id;
	gala_desktop_integration_type_id = g_type_register_static (G_TYPE_OBJECT, "GalaDesktopIntegration", &g_define_type_info, 0);
	g_type_set_qdata (gala_desktop_integration_type_id, g_quark_from_static_string ("vala-dbus-register-object"), (void*) gala_desktop_integration_register_object);
	GalaDesktopIntegration_private_offset = g_type_add_instance_private (gala_desktop_integration_type_id, sizeof (GalaDesktopIntegrationPrivate));
	return gala_desktop_integration_type_id;
}

GType
gala_desktop_integration_get_type (void)
{
	static gsize gala_desktop_integration_type_id__once = 0;
	if (g_once_init_enter (&gala_desktop_integration_type_id__once)) {
		GType gala_desktop_integration_type_id;
		gala_desktop_integration_type_id = gala_desktop_integration_get_type_once ();
		g_once_init_leave (&gala_desktop_integration_type_id__once, gala_desktop_integration_type_id);
	}
	return gala_desktop_integration_type_id__once;
}

static void
_vala_gala_desktop_integration_get_property (GObject * object,
                                             guint property_id,
                                             GValue * value,
                                             GParamSpec * pspec)
{
	GalaDesktopIntegration * self;
	self = G_TYPE_CHECK_INSTANCE_CAST (object, GALA_TYPE_DESKTOP_INTEGRATION, GalaDesktopIntegration);
#line 8 "../src/DesktopIntegration.vala"
	switch (property_id) {
#line 8 "../src/DesktopIntegration.vala"
		case GALA_DESKTOP_INTEGRATION_VERSION_PROPERTY:
#line 8 "../src/DesktopIntegration.vala"
		g_value_set_uint (value, gala_desktop_integration_get_version (self));
#line 8 "../src/DesktopIntegration.vala"
		break;
#line 1549 "DesktopIntegration.c"
		default:
#line 8 "../src/DesktopIntegration.vala"
		G_OBJECT_WARN_INVALID_PROPERTY_ID (object, property_id, pspec);
#line 8 "../src/DesktopIntegration.vala"
		break;
#line 1555 "DesktopIntegration.c"
	}
}

static void
_dbus_gala_desktop_integration_get_running_applications (GalaDesktopIntegration* self,
                                                         GVariant* _parameters_,
                                                         GDBusMethodInvocation* invocation)
{
	GError* error = NULL;
	GVariantIter _arguments_iter;
	GDBusMessage* _reply_message = NULL;
	GVariant* _reply;
	GVariantBuilder _reply_builder;
	GalaDesktopIntegrationRunningApplication* result;
	gint result_length1 = 0;
	GalaDesktopIntegrationRunningApplication* _tmp36_;
	GVariantBuilder _tmp37_;
	gint _tmp38_;
	g_variant_iter_init (&_arguments_iter, _parameters_);
	result = gala_desktop_integration_get_running_applications (self, &result_length1, &error);
	if (error) {
		g_dbus_method_invocation_take_error (invocation, error);
		return;
	}
	_reply_message = g_dbus_message_new_method_reply (g_dbus_method_invocation_get_message (invocation));
	g_variant_builder_init (&_reply_builder, G_VARIANT_TYPE_TUPLE);
	_tmp36_ = result;
	g_variant_builder_init (&_tmp37_, G_VARIANT_TYPE ("a(sa{sv})"));
	for (_tmp38_ = 0; _tmp38_ < result_length1; _tmp38_++) {
		GVariantBuilder _tmp39_;
		GVariantBuilder _tmp40_;
		GHashTableIter _tmp41_;
		gpointer _tmp42_;
		gpointer _tmp43_;
		g_variant_builder_init (&_tmp39_, G_VARIANT_TYPE_TUPLE);
		g_variant_builder_add_value (&_tmp39_, g_variant_new_string ((*_tmp36_).app_id));
		g_hash_table_iter_init (&_tmp41_, (*_tmp36_).details);
		g_variant_builder_init (&_tmp40_, G_VARIANT_TYPE ("a{sv}"));
		while (g_hash_table_iter_next (&_tmp41_, &_tmp42_, &_tmp43_)) {
			const gchar* _key;
			GVariant* _value;
			_key = (const gchar*) _tmp42_;
			_value = (GVariant*) _tmp43_;
			g_variant_builder_add (&_tmp40_, "{?*}", g_variant_new_string (_key), g_variant_new_variant (_value));
		}
		g_variant_builder_add_value (&_tmp39_, g_variant_builder_end (&_tmp40_));
		g_variant_builder_add_value (&_tmp37_, g_variant_builder_end (&_tmp39_));
		_tmp36_++;
	}
	g_variant_builder_add_value (&_reply_builder, g_variant_builder_end (&_tmp37_));
	result = (_vala_GalaDesktopIntegrationRunningApplication_array_free (result, result_length1), NULL);
	_reply = g_variant_builder_end (&_reply_builder);
	g_dbus_message_set_body (_reply_message, _reply);
	g_dbus_connection_send_message (g_dbus_method_invocation_get_connection (invocation), _reply_message, G_DBUS_SEND_MESSAGE_FLAGS_NONE, NULL, NULL);
	g_object_unref (invocation);
	g_object_unref (_reply_message);
}

static void
_dbus_gala_desktop_integration_get_windows (GalaDesktopIntegration* self,
                                            GVariant* _parameters_,
                                            GDBusMethodInvocation* invocation)
{
	GError* error = NULL;
	GVariantIter _arguments_iter;
	GDBusMessage* _reply_message = NULL;
	GVariant* _reply;
	GVariantBuilder _reply_builder;
	GalaDesktopIntegrationWindow* result;
	gint result_length1 = 0;
	GalaDesktopIntegrationWindow* _tmp44_;
	GVariantBuilder _tmp45_;
	gint _tmp46_;
	g_variant_iter_init (&_arguments_iter, _parameters_);
	result = gala_desktop_integration_get_windows (self, &result_length1, &error);
	if (error) {
		g_dbus_method_invocation_take_error (invocation, error);
		return;
	}
	_reply_message = g_dbus_message_new_method_reply (g_dbus_method_invocation_get_message (invocation));
	g_variant_builder_init (&_reply_builder, G_VARIANT_TYPE_TUPLE);
	_tmp44_ = result;
	g_variant_builder_init (&_tmp45_, G_VARIANT_TYPE ("a(ta{sv})"));
	for (_tmp46_ = 0; _tmp46_ < result_length1; _tmp46_++) {
		GVariantBuilder _tmp47_;
		GVariantBuilder _tmp48_;
		GHashTableIter _tmp49_;
		gpointer _tmp50_;
		gpointer _tmp51_;
		g_variant_builder_init (&_tmp47_, G_VARIANT_TYPE_TUPLE);
		g_variant_builder_add_value (&_tmp47_, g_variant_new_uint64 ((*_tmp44_).uid));
		g_hash_table_iter_init (&_tmp49_, (*_tmp44_).properties);
		g_variant_builder_init (&_tmp48_, G_VARIANT_TYPE ("a{sv}"));
		while (g_hash_table_iter_next (&_tmp49_, &_tmp50_, &_tmp51_)) {
			const gchar* _key;
			GVariant* _value;
			_key = (const gchar*) _tmp50_;
			_value = (GVariant*) _tmp51_;
			g_variant_builder_add (&_tmp48_, "{?*}", g_variant_new_string (_key), g_variant_new_variant (_value));
		}
		g_variant_builder_add_value (&_tmp47_, g_variant_builder_end (&_tmp48_));
		g_variant_builder_add_value (&_tmp45_, g_variant_builder_end (&_tmp47_));
		_tmp44_++;
	}
	g_variant_builder_add_value (&_reply_builder, g_variant_builder_end (&_tmp45_));
	result = (_vala_GalaDesktopIntegrationWindow_array_free (result, result_length1), NULL);
	_reply = g_variant_builder_end (&_reply_builder);
	g_dbus_message_set_body (_reply_message, _reply);
	g_dbus_connection_send_message (g_dbus_method_invocation_get_connection (invocation), _reply_message, G_DBUS_SEND_MESSAGE_FLAGS_NONE, NULL, NULL);
	g_object_unref (invocation);
	g_object_unref (_reply_message);
}

static void
_dbus_gala_desktop_integration_focus_window (GalaDesktopIntegration* self,
                                             GVariant* _parameters_,
                                             GDBusMethodInvocation* invocation)
{
	GError* error = NULL;
	GVariantIter _arguments_iter;
	guint64 uid = 0ULL;
	GVariant* _tmp52_;
	GDBusMessage* _reply_message = NULL;
	GVariant* _reply;
	GVariantBuilder _reply_builder;
	g_variant_iter_init (&_arguments_iter, _parameters_);
	_tmp52_ = g_variant_iter_next_value (&_arguments_iter);
	uid = g_variant_get_uint64 (_tmp52_);
	g_variant_unref (_tmp52_);
	gala_desktop_integration_focus_window (self, uid, &error);
	if (error) {
		g_dbus_method_invocation_take_error (invocation, error);
		return;
	}
	_reply_message = g_dbus_message_new_method_reply (g_dbus_method_invocation_get_message (invocation));
	g_variant_builder_init (&_reply_builder, G_VARIANT_TYPE_TUPLE);
	_reply = g_variant_builder_end (&_reply_builder);
	g_dbus_message_set_body (_reply_message, _reply);
	g_dbus_connection_send_message (g_dbus_method_invocation_get_connection (invocation), _reply_message, G_DBUS_SEND_MESSAGE_FLAGS_NONE, NULL, NULL);
	g_object_unref (invocation);
	g_object_unref (_reply_message);
}

static void
_dbus_gala_desktop_integration_show_windows_for (GalaDesktopIntegration* self,
                                                 GVariant* _parameters_,
                                                 GDBusMethodInvocation* invocation)
{
	GError* error = NULL;
	GVariantIter _arguments_iter;
	gchar* app_id = NULL;
	GVariant* _tmp53_;
	GDBusMessage* _reply_message = NULL;
	GVariant* _reply;
	GVariantBuilder _reply_builder;
	g_variant_iter_init (&_arguments_iter, _parameters_);
	_tmp53_ = g_variant_iter_next_value (&_arguments_iter);
	app_id = g_variant_dup_string (_tmp53_, NULL);
	g_variant_unref (_tmp53_);
	gala_desktop_integration_show_windows_for (self, app_id, &error);
	if (error) {
		g_dbus_method_invocation_take_error (invocation, error);
		goto _error;
	}
	_reply_message = g_dbus_message_new_method_reply (g_dbus_method_invocation_get_message (invocation));
	g_variant_builder_init (&_reply_builder, G_VARIANT_TYPE_TUPLE);
	_reply = g_variant_builder_end (&_reply_builder);
	g_dbus_message_set_body (_reply_message, _reply);
	g_dbus_connection_send_message (g_dbus_method_invocation_get_connection (invocation), _reply_message, G_DBUS_SEND_MESSAGE_FLAGS_NONE, NULL, NULL);
	g_object_unref (invocation);
	g_object_unref (_reply_message);
	_error:
	_g_free0 (app_id);
	;
}

static void
gala_desktop_integration_dbus_interface_method_call (GDBusConnection* connection,
                                                     const gchar* sender,
                                                     const gchar* object_path,
                                                     const gchar* interface_name,
                                                     const gchar* method_name,
                                                     GVariant* parameters,
                                                     GDBusMethodInvocation* invocation,
                                                     gpointer user_data)
{
	gpointer* data;
	gpointer object;
	data = user_data;
	object = data[0];
	if (strcmp (method_name, "GetRunningApplications") == 0) {
		_dbus_gala_desktop_integration_get_running_applications (object, parameters, invocation);
	} else if (strcmp (method_name, "GetWindows") == 0) {
		_dbus_gala_desktop_integration_get_windows (object, parameters, invocation);
	} else if (strcmp (method_name, "FocusWindow") == 0) {
		_dbus_gala_desktop_integration_focus_window (object, parameters, invocation);
	} else if (strcmp (method_name, "ShowWindowsFor") == 0) {
		_dbus_gala_desktop_integration_show_windows_for (object, parameters, invocation);
	} else {
		g_object_unref (invocation);
	}
}

static GVariant*
_dbus_gala_desktop_integration_get_version (GalaDesktopIntegration* self)
{
	guint result;
	GVariant* _reply;
	result = gala_desktop_integration_get_version (self);
	_reply = g_variant_new_uint32 (result);
	return _reply;
}

static GVariant*
gala_desktop_integration_dbus_interface_get_property (GDBusConnection* connection,
                                                      const gchar* sender,
                                                      const gchar* object_path,
                                                      const gchar* interface_name,
                                                      const gchar* property_name,
                                                      GError** error,
                                                      gpointer user_data)
{
	gpointer* data;
	gpointer object;
	data = user_data;
	object = data[0];
	if (strcmp (property_name, "Version") == 0) {
		return _dbus_gala_desktop_integration_get_version (object);
	}
	return NULL;
}

static gboolean
gala_desktop_integration_dbus_interface_set_property (GDBusConnection* connection,
                                                      const gchar* sender,
                                                      const gchar* object_path,
                                                      const gchar* interface_name,
                                                      const gchar* property_name,
                                                      GVariant* value,
                                                      GError** error,
                                                      gpointer user_data)
{
	gpointer* data;
	gpointer object;
	data = user_data;
	object = data[0];
	return FALSE;
}

static void
_dbus_gala_desktop_integration_running_applications_changed (GObject* _sender,
                                                             gpointer* _data)
{
	GDBusConnection * _connection;
	const gchar * _path;
	GVariant *_arguments;
	GVariantBuilder _arguments_builder;
	_connection = _data[1];
	_path = _data[2];
	g_variant_builder_init (&_arguments_builder, G_VARIANT_TYPE_TUPLE);
	_arguments = g_variant_builder_end (&_arguments_builder);
	g_dbus_connection_emit_signal (_connection, NULL, _path, "org.pantheon.gala.DesktopIntegration", "RunningApplicationsChanged", _arguments, NULL);
}

static void
_dbus_gala_desktop_integration_windows_changed (GObject* _sender,
                                                gpointer* _data)
{
	GDBusConnection * _connection;
	const gchar * _path;
	GVariant *_arguments;
	GVariantBuilder _arguments_builder;
	_connection = _data[1];
	_path = _data[2];
	g_variant_builder_init (&_arguments_builder, G_VARIANT_TYPE_TUPLE);
	_arguments = g_variant_builder_end (&_arguments_builder);
	g_dbus_connection_emit_signal (_connection, NULL, _path, "org.pantheon.gala.DesktopIntegration", "WindowsChanged", _arguments, NULL);
}

guint
gala_desktop_integration_register_object (gpointer object,
                                          GDBusConnection* connection,
                                          const gchar* path,
                                          GError** error)
{
	guint result;
	gpointer *data;
	data = g_new (gpointer, 3);
	data[0] = g_object_ref (object);
	data[1] = g_object_ref (connection);
	data[2] = g_strdup (path);
	result = g_dbus_connection_register_object (connection, path, (GDBusInterfaceInfo *) (&_gala_desktop_integration_dbus_interface_info), &_gala_desktop_integration_dbus_interface_vtable, data, _gala_desktop_integration_unregister_object, error);
	if (!result) {
		return 0;
	}
	g_signal_connect (object, "running-applications-changed", (GCallback) _dbus_gala_desktop_integration_running_applications_changed, data);
	g_signal_connect (object, "windows-changed", (GCallback) _dbus_gala_desktop_integration_windows_changed, data);
	return result;
}

static void
_gala_desktop_integration_unregister_object (gpointer user_data)
{
	gpointer* data;
	data = user_data;
	g_signal_handlers_disconnect_by_func (data[0], _dbus_gala_desktop_integration_running_applications_changed, data);
	g_signal_handlers_disconnect_by_func (data[0], _dbus_gala_desktop_integration_windows_changed, data);
	g_object_unref (data[0]);
	g_object_unref (data[1]);
	g_free (data[2]);
	g_free (data);
}

