/* InternalUtils.c generated by valac 0.56.17, the Vala compiler
 * generated from InternalUtils.vala, do not modify */

/*
 * Copyright 2012 Tom Beckmann
 * Copyright 2012 Rico Tzschichholz
 * Copyright 2023 elementary, Inc. <https://elementary.io>
 * SPDX-License-Identifier: GPL-3.0-or-later
 */

#include <glib-object.h>
#include <glib.h>
#include <meta/prefs.h>
#include <meta/display.h>
#include <meta/util.h>
#include <X11/Xlib.h>
#include <mtk/mtk.h>
#include <gio/gio.h>
#include "config.h"
#include "gala.h"
#include <meta/meta-x11-display.h>
#include <X11/extensions/Xfixes.h>
#include <X11/Xatom.h>
#include <X11/Xutil.h>
#include <X11/Xregion.h>
#include <meta/window.h>
#include <meta/meta-window-actor.h>
#include <meta/compositor-mutter.h>
#include <meta/workspace.h>
#include <gdk/gdk.h>
#include <clutter/clutter.h>
#include <math.h>
#include <float.h>
#include <string.h>
#include <meta/meta-workspace-manager.h>
#include <gobject/gvaluecollector.h>

#if !defined(VALA_STRICT_C)
#if !defined(__clang__) && defined(__GNUC__) && (__GNUC__ >= 14)
#pragma GCC diagnostic warning "-Wincompatible-pointer-types"
#elif defined(__clang__) && (__clang_major__ >= 16)
#pragma clang diagnostic ignored "-Wincompatible-function-pointer-types"
#pragma clang diagnostic ignored "-Wincompatible-pointer-types"
#endif
#endif
#if !defined(VALA_EXTERN)
#if defined(_MSC_VER)
#define VALA_EXTERN __declspec(dllexport) extern
#elif __GNUC__ >= 4
#define VALA_EXTERN __attribute__((visibility("default"))) extern
#else
#define VALA_EXTERN extern
#endif
#endif

typedef enum  {
	GALA_INPUT_AREA_NONE,
	GALA_INPUT_AREA_FULLSCREEN,
	GALA_INPUT_AREA_DEFAULT
} GalaInputArea;

#define GALA_TYPE_INPUT_AREA (gala_input_area_get_type ())

#define GALA_TYPE_INTERNAL_UTILS (gala_internal_utils_get_type ())
#define GALA_INTERNAL_UTILS(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), GALA_TYPE_INTERNAL_UTILS, GalaInternalUtils))
#define GALA_INTERNAL_UTILS_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), GALA_TYPE_INTERNAL_UTILS, GalaInternalUtilsClass))
#define GALA_IS_INTERNAL_UTILS(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), GALA_TYPE_INTERNAL_UTILS))
#define GALA_IS_INTERNAL_UTILS_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), GALA_TYPE_INTERNAL_UTILS))
#define GALA_INTERNAL_UTILS_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), GALA_TYPE_INTERNAL_UTILS, GalaInternalUtilsClass))

typedef struct _GalaInternalUtils GalaInternalUtils;
typedef struct _GalaInternalUtilsClass GalaInternalUtilsClass;
typedef struct _GalaInternalUtilsPrivate GalaInternalUtilsPrivate;

#define GALA_TYPE_PLUGIN_MANAGER (gala_plugin_manager_get_type ())
#define GALA_PLUGIN_MANAGER(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), GALA_TYPE_PLUGIN_MANAGER, GalaPluginManager))
#define GALA_PLUGIN_MANAGER_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), GALA_TYPE_PLUGIN_MANAGER, GalaPluginManagerClass))
#define GALA_IS_PLUGIN_MANAGER(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), GALA_TYPE_PLUGIN_MANAGER))
#define GALA_IS_PLUGIN_MANAGER_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), GALA_TYPE_PLUGIN_MANAGER))
#define GALA_PLUGIN_MANAGER_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), GALA_TYPE_PLUGIN_MANAGER, GalaPluginManagerClass))

typedef struct _GalaPluginManager GalaPluginManager;
typedef struct _GalaPluginManagerClass GalaPluginManagerClass;
#define _g_object_unref0(var) ((var == NULL) ? NULL : (var = (g_object_unref (var), NULL)))

#define GALA_TYPE_WORKSPACE_MANAGER (gala_workspace_manager_get_type ())
#define GALA_WORKSPACE_MANAGER(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), GALA_TYPE_WORKSPACE_MANAGER, GalaWorkspaceManager))
#define GALA_WORKSPACE_MANAGER_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), GALA_TYPE_WORKSPACE_MANAGER, GalaWorkspaceManagerClass))
#define GALA_IS_WORKSPACE_MANAGER(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), GALA_TYPE_WORKSPACE_MANAGER))
#define GALA_IS_WORKSPACE_MANAGER_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), GALA_TYPE_WORKSPACE_MANAGER))
#define GALA_WORKSPACE_MANAGER_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), GALA_TYPE_WORKSPACE_MANAGER, GalaWorkspaceManagerClass))

typedef struct _GalaWorkspaceManager GalaWorkspaceManager;
typedef struct _GalaWorkspaceManagerClass GalaWorkspaceManagerClass;

#define GALA_INTERNAL_UTILS_TYPE_TILABLE_WINDOW (gala_internal_utils_tilable_window_get_type ())
typedef struct _GalaInternalUtilsTilableWindow GalaInternalUtilsTilableWindow;

#define GALA_TYPE_WINDOW_CLONE (gala_window_clone_get_type ())
#define GALA_WINDOW_CLONE(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), GALA_TYPE_WINDOW_CLONE, GalaWindowClone))
#define GALA_WINDOW_CLONE_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), GALA_TYPE_WINDOW_CLONE, GalaWindowCloneClass))
#define GALA_IS_WINDOW_CLONE(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), GALA_TYPE_WINDOW_CLONE))
#define GALA_IS_WINDOW_CLONE_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), GALA_TYPE_WINDOW_CLONE))
#define GALA_WINDOW_CLONE_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), GALA_TYPE_WINDOW_CLONE, GalaWindowCloneClass))

typedef struct _GalaWindowClone GalaWindowClone;
typedef struct _GalaWindowCloneClass GalaWindowCloneClass;
#define _gala_internal_utils_tilable_window_free0(var) ((var == NULL) ? NULL : (var = (gala_internal_utils_tilable_window_free (var), NULL)))
typedef struct _GalaParamSpecInternalUtils GalaParamSpecInternalUtils;

struct _GalaInternalUtils {
	GTypeInstance parent_instance;
	volatile int ref_count;
	GalaInternalUtilsPrivate * priv;
};

struct _GalaInternalUtilsClass {
	GTypeClass parent_class;
	void (*finalize) (GalaInternalUtils *self);
};

struct _GalaInternalUtilsTilableWindow {
	MtkRectangle rect;
	GalaWindowClone* id;
};

struct _GalaParamSpecInternalUtils {
	GParamSpec parent_instance;
};

static gpointer gala_internal_utils_parent_class = NULL;

VALA_EXTERN GType gala_input_area_get_type (void) G_GNUC_CONST ;
VALA_EXTERN gpointer gala_internal_utils_ref (gpointer instance);
VALA_EXTERN void gala_internal_utils_unref (gpointer instance);
VALA_EXTERN GParamSpec* gala_param_spec_internal_utils (const gchar* name,
                                            const gchar* nick,
                                            const gchar* blurb,
                                            GType object_type,
                                            GParamFlags flags);
VALA_EXTERN void gala_value_set_internal_utils (GValue* value,
                                    gpointer v_object);
VALA_EXTERN void gala_value_take_internal_utils (GValue* value,
                                     gpointer v_object);
VALA_EXTERN gpointer gala_value_get_internal_utils (const GValue* value);
VALA_EXTERN GType gala_internal_utils_get_type (void) G_GNUC_CONST ;
G_DEFINE_AUTOPTR_CLEANUP_FUNC (GalaInternalUtils, gala_internal_utils_unref)
VALA_EXTERN gboolean gala_internal_utils_workspaces_only_on_primary (void);
VALA_EXTERN void gala_internal_utils_set_input_area (MetaDisplay* display,
                                         GalaInputArea area);
VALA_EXTERN GType gala_plugin_manager_get_type (void) G_GNUC_CONST ;
G_DEFINE_AUTOPTR_CLEANUP_FUNC (GalaPluginManager, g_object_unref)
VALA_EXTERN GalaPluginManager* gala_plugin_manager_get_default (void);
VALA_EXTERN XRectangle* gala_plugin_manager_get_regions (GalaPluginManager* self,
                                             gint* result_length1);
static void _vala_array_add5 (XRectangle* * array,
                       gint* length,
                       gint* size,
                       XRectangle value);
VALA_EXTERN void gala_internal_utils_insert_workspace_with_window (gint index,
                                                       MetaWindow* new_window);
VALA_EXTERN GType gala_workspace_manager_get_type (void) G_GNUC_CONST ;
G_DEFINE_AUTOPTR_CLEANUP_FUNC (GalaWorkspaceManager, g_object_unref)
VALA_EXTERN GalaWorkspaceManager* gala_workspace_manager_get_default (void);
VALA_EXTERN void gala_workspace_manager_freeze_remove (GalaWorkspaceManager* self);
VALA_EXTERN void gala_workspace_manager_thaw_remove (GalaWorkspaceManager* self);
static gint gala_internal_utils_squared_distance (GdkPoint* a,
                                           GdkPoint* b);
static void gala_internal_utils_rect_adjusted (MtkRectangle* rect,
                                        gint dx1,
                                        gint dy1,
                                        gint dx2,
                                        gint dy2,
                                        MtkRectangle* result);
static void gala_internal_utils_rect_center (MtkRectangle* rect,
                                      GdkPoint* result);
VALA_EXTERN GType gala_internal_utils_tilable_window_get_type (void) G_GNUC_CONST ;
VALA_EXTERN GType gala_window_clone_get_type (void) G_GNUC_CONST ;
G_DEFINE_AUTOPTR_CLEANUP_FUNC (GalaWindowClone, g_object_unref)
VALA_EXTERN GalaInternalUtilsTilableWindow* gala_internal_utils_tilable_window_dup (const GalaInternalUtilsTilableWindow* self);
VALA_EXTERN void gala_internal_utils_tilable_window_free (GalaInternalUtilsTilableWindow* self);
VALA_EXTERN GList* gala_internal_utils_calculate_grid_placement (MtkRectangle* area,
                                                     GList* windows);
static gboolean _mtk_rectangle_equal (const MtkRectangle * s1,
                               const MtkRectangle * s2);
static gboolean _gala_internal_utils_tilable_window_equal (const GalaInternalUtilsTilableWindow * s1,
                                                    const GalaInternalUtilsTilableWindow * s2);
VALA_EXTERN GSList* gala_internal_utils_sort_windows (MetaDisplay* display,
                                          GList* windows);
static void _g_object_unref0_ (gpointer var);
static inline void _g_slist_free__g_object_unref0_ (GSList* self);
VALA_EXTERN gboolean gala_internal_utils_get_window_is_normal (MetaWindow* window);
VALA_EXTERN gint gala_internal_utils_scale_to_int (gint value,
                                       gfloat scale_factor);
VALA_EXTERN void gala_internal_utils_get_workspaces_geometry (MetaDisplay* display,
                                                  MtkRectangle* result);
VALA_EXTERN GalaInternalUtils* gala_internal_utils_new (void);
VALA_EXTERN GalaInternalUtils* gala_internal_utils_construct (GType object_type);
static void gala_internal_utils_finalize (GalaInternalUtils * obj);
static GType gala_internal_utils_get_type_once (void);
static void _vala_array_destroy (gpointer array,
                          gssize array_length,
                          GDestroyNotify destroy_func);
static void _vala_array_free (gpointer array,
                       gssize array_length,
                       GDestroyNotify destroy_func);

 G_GNUC_NO_INLINE static GType
gala_input_area_get_type_once (void)
{
	static const GEnumValue values[] = {{GALA_INPUT_AREA_NONE, "GALA_INPUT_AREA_NONE", "none"}, {GALA_INPUT_AREA_FULLSCREEN, "GALA_INPUT_AREA_FULLSCREEN", "fullscreen"}, {GALA_INPUT_AREA_DEFAULT, "GALA_INPUT_AREA_DEFAULT", "default"}, {0, NULL, NULL}};
	GType gala_input_area_type_id;
	gala_input_area_type_id = g_enum_register_static ("GalaInputArea", values);
	return gala_input_area_type_id;
}

GType
gala_input_area_get_type (void)
{
	static gsize gala_input_area_type_id__once = 0;
	if (g_once_init_enter (&gala_input_area_type_id__once)) {
		GType gala_input_area_type_id;
		gala_input_area_type_id = gala_input_area_get_type_once ();
		g_once_init_leave (&gala_input_area_type_id__once, gala_input_area_type_id);
	}
	return gala_input_area_type_id__once;
}

gboolean
gala_internal_utils_workspaces_only_on_primary (void)
{
	gboolean _tmp0_ = FALSE;
	gboolean result;
#line 17 "../src/InternalUtils.vala"
	if (meta_prefs_get_dynamic_workspaces ()) {
#line 18 "../src/InternalUtils.vala"
		_tmp0_ = meta_prefs_get_workspaces_only_on_primary ();
#line 239 "InternalUtils.c"
	} else {
#line 17 "../src/InternalUtils.vala"
		_tmp0_ = FALSE;
#line 243 "InternalUtils.c"
	}
#line 17 "../src/InternalUtils.vala"
	result = _tmp0_;
#line 17 "../src/InternalUtils.vala"
	return result;
#line 249 "InternalUtils.c"
}

/**
         * set the area where clutter can receive events
         **/
static void
_vala_array_add5 (XRectangle* * array,
                  gint* length,
                  gint* size,
                  XRectangle value)
{
#line 57 "../src/InternalUtils.vala"
	if ((*length) == (*size)) {
#line 57 "../src/InternalUtils.vala"
		*size = (*size) ? (2 * (*size)) : 4;
#line 57 "../src/InternalUtils.vala"
		*array = g_renew (XRectangle, *array, *size);
#line 267 "InternalUtils.c"
	}
#line 57 "../src/InternalUtils.vala"
	(*array)[(*length)++] = value;
#line 271 "InternalUtils.c"
}

void
gala_internal_utils_set_input_area (MetaDisplay* display,
                                    GalaInputArea area)
{
	XRectangle* rects = NULL;
	XRectangle* _tmp0_;
	gint rects_length1;
	gint _rects_size_;
	gint width = 0;
	gint height = 0;
	gint _tmp1_ = 0;
	gint _tmp2_ = 0;
	MtkRectangle geometry = {0};
	MtkRectangle _tmp3_ = {0};
	MetaX11Display* x11display = NULL;
	MetaX11Display* _tmp36_;
	XserverRegion xregion = {0};
	MetaX11Display* _tmp37_;
	Display* _tmp38_;
	XRectangle* _tmp39_;
	gint _tmp39__length1;
	MetaX11Display* _tmp40_;
#line 24 "../src/InternalUtils.vala"
	g_return_if_fail (display != NULL);
#line 25 "../src/InternalUtils.vala"
	if (meta_is_wayland_compositor ()) {
#line 26 "../src/InternalUtils.vala"
		return;
#line 302 "InternalUtils.c"
	}
#line 29 "../src/InternalUtils.vala"
	_tmp0_ = g_new0 (XRectangle, 0);
#line 29 "../src/InternalUtils.vala"
	rects = _tmp0_;
#line 29 "../src/InternalUtils.vala"
	rects_length1 = 0;
#line 29 "../src/InternalUtils.vala"
	_rects_size_ = rects_length1;
#line 31 "../src/InternalUtils.vala"
	meta_display_get_size (display, &_tmp1_, &_tmp2_);
#line 31 "../src/InternalUtils.vala"
	width = _tmp1_;
#line 31 "../src/InternalUtils.vala"
	height = _tmp2_;
#line 32 "../src/InternalUtils.vala"
	meta_display_get_monitor_geometry (display, meta_display_get_primary_monitor (display), &_tmp3_);
#line 32 "../src/InternalUtils.vala"
	geometry = _tmp3_;
#line 34 "../src/InternalUtils.vala"
	switch (area) {
#line 34 "../src/InternalUtils.vala"
		case GALA_INPUT_AREA_FULLSCREEN:
#line 326 "InternalUtils.c"
		{
			XRectangle rect = {0};
			XRectangle _tmp4_ = {0};
			XRectangle* _tmp5_;
#line 36 "../src/InternalUtils.vala"
			_tmp4_.x = (gshort) 0;
#line 36 "../src/InternalUtils.vala"
			_tmp4_.y = (gshort) 0;
#line 36 "../src/InternalUtils.vala"
			_tmp4_.width = (gushort) width;
#line 36 "../src/InternalUtils.vala"
			_tmp4_.height = (gushort) height;
#line 36 "../src/InternalUtils.vala"
			rect = _tmp4_;
#line 37 "../src/InternalUtils.vala"
			_tmp5_ = g_new0 (XRectangle, 1);
#line 37 "../src/InternalUtils.vala"
			_tmp5_[0] = rect;
#line 37 "../src/InternalUtils.vala"
			rects = (g_free (rects), NULL);
#line 37 "../src/InternalUtils.vala"
			rects = _tmp5_;
#line 37 "../src/InternalUtils.vala"
			rects_length1 = 1;
#line 37 "../src/InternalUtils.vala"
			_rects_size_ = rects_length1;
#line 38 "../src/InternalUtils.vala"
			break;
#line 355 "InternalUtils.c"
		}
#line 34 "../src/InternalUtils.vala"
		case GALA_INPUT_AREA_DEFAULT:
#line 359 "InternalUtils.c"
		{
			GSettings* settings = NULL;
			GSettings* _tmp6_;
			gint _tmp7_ = 0;
			GSettings* _tmp8_;
			gushort tl_size = 0U;
			gint _tmp9_ = 0;
			GSettings* _tmp10_;
			gushort tr_size = 0U;
			gint _tmp11_ = 0;
			GSettings* _tmp12_;
			gushort bl_size = 0U;
			gint _tmp13_ = 0;
			GSettings* _tmp14_;
			gushort br_size = 0U;
			XRectangle topleft = {0};
			MtkRectangle _tmp15_;
			MtkRectangle _tmp16_;
			XRectangle _tmp17_ = {0};
			XRectangle topright = {0};
			MtkRectangle _tmp18_;
			MtkRectangle _tmp19_;
			MtkRectangle _tmp20_;
			XRectangle _tmp21_ = {0};
			XRectangle bottomleft = {0};
			MtkRectangle _tmp22_;
			MtkRectangle _tmp23_;
			MtkRectangle _tmp24_;
			XRectangle _tmp25_ = {0};
			XRectangle bottomright = {0};
			MtkRectangle _tmp26_;
			MtkRectangle _tmp27_;
			MtkRectangle _tmp28_;
			MtkRectangle _tmp29_;
			XRectangle _tmp30_ = {0};
			XRectangle* _tmp31_;
			GalaPluginManager* _tmp32_;
			gint _tmp33_ = 0;
			XRectangle* _tmp34_;
#line 40 "../src/InternalUtils.vala"
			_tmp6_ = g_settings_new (SCHEMA ".behavior");
#line 40 "../src/InternalUtils.vala"
			settings = _tmp6_;
#line 43 "../src/InternalUtils.vala"
			_tmp8_ = settings;
#line 43 "../src/InternalUtils.vala"
			if (g_settings_get_enum (_tmp8_, "hotcorner-topleft") != ((gint) GALA_ACTION_TYPE_NONE)) {
#line 43 "../src/InternalUtils.vala"
				_tmp7_ = 1;
#line 409 "InternalUtils.c"
			} else {
#line 43 "../src/InternalUtils.vala"
				_tmp7_ = 0;
#line 413 "InternalUtils.c"
			}
#line 43 "../src/InternalUtils.vala"
			tl_size = (gushort) _tmp7_;
#line 44 "../src/InternalUtils.vala"
			_tmp10_ = settings;
#line 44 "../src/InternalUtils.vala"
			if (g_settings_get_enum (_tmp10_, "hotcorner-topright") != ((gint) GALA_ACTION_TYPE_NONE)) {
#line 44 "../src/InternalUtils.vala"
				_tmp9_ = 1;
#line 423 "InternalUtils.c"
			} else {
#line 44 "../src/InternalUtils.vala"
				_tmp9_ = 0;
#line 427 "InternalUtils.c"
			}
#line 44 "../src/InternalUtils.vala"
			tr_size = (gushort) _tmp9_;
#line 45 "../src/InternalUtils.vala"
			_tmp12_ = settings;
#line 45 "../src/InternalUtils.vala"
			if (g_settings_get_enum (_tmp12_, "hotcorner-bottomleft") != ((gint) GALA_ACTION_TYPE_NONE)) {
#line 45 "../src/InternalUtils.vala"
				_tmp11_ = 1;
#line 437 "InternalUtils.c"
			} else {
#line 45 "../src/InternalUtils.vala"
				_tmp11_ = 0;
#line 441 "InternalUtils.c"
			}
#line 45 "../src/InternalUtils.vala"
			bl_size = (gushort) _tmp11_;
#line 46 "../src/InternalUtils.vala"
			_tmp14_ = settings;
#line 46 "../src/InternalUtils.vala"
			if (g_settings_get_enum (_tmp14_, "hotcorner-bottomright") != ((gint) GALA_ACTION_TYPE_NONE)) {
#line 46 "../src/InternalUtils.vala"
				_tmp13_ = 1;
#line 451 "InternalUtils.c"
			} else {
#line 46 "../src/InternalUtils.vala"
				_tmp13_ = 0;
#line 455 "InternalUtils.c"
			}
#line 46 "../src/InternalUtils.vala"
			br_size = (gushort) _tmp13_;
#line 48 "../src/InternalUtils.vala"
			_tmp15_ = geometry;
#line 48 "../src/InternalUtils.vala"
			_tmp16_ = geometry;
#line 48 "../src/InternalUtils.vala"
			_tmp17_.x = (gshort) _tmp15_.x;
#line 48 "../src/InternalUtils.vala"
			_tmp17_.y = (gshort) _tmp16_.y;
#line 48 "../src/InternalUtils.vala"
			_tmp17_.width = tl_size;
#line 48 "../src/InternalUtils.vala"
			_tmp17_.height = tl_size;
#line 48 "../src/InternalUtils.vala"
			topleft = _tmp17_;
#line 49 "../src/InternalUtils.vala"
			_tmp18_ = geometry;
#line 49 "../src/InternalUtils.vala"
			_tmp19_ = geometry;
#line 49 "../src/InternalUtils.vala"
			_tmp20_ = geometry;
#line 49 "../src/InternalUtils.vala"
			_tmp21_.x = (gshort) ((_tmp18_.x + _tmp19_.width) - 1);
#line 49 "../src/InternalUtils.vala"
			_tmp21_.y = (gshort) _tmp20_.y;
#line 49 "../src/InternalUtils.vala"
			_tmp21_.width = tr_size;
#line 49 "../src/InternalUtils.vala"
			_tmp21_.height = tr_size;
#line 49 "../src/InternalUtils.vala"
			topright = _tmp21_;
#line 50 "../src/InternalUtils.vala"
			_tmp22_ = geometry;
#line 50 "../src/InternalUtils.vala"
			_tmp23_ = geometry;
#line 50 "../src/InternalUtils.vala"
			_tmp24_ = geometry;
#line 50 "../src/InternalUtils.vala"
			_tmp25_.x = (gshort) _tmp22_.x;
#line 50 "../src/InternalUtils.vala"
			_tmp25_.y = (gshort) ((_tmp23_.y + _tmp24_.height) - 1);
#line 50 "../src/InternalUtils.vala"
			_tmp25_.width = bl_size;
#line 50 "../src/InternalUtils.vala"
			_tmp25_.height = bl_size;
#line 50 "../src/InternalUtils.vala"
			bottomleft = _tmp25_;
#line 51 "../src/InternalUtils.vala"
			_tmp26_ = geometry;
#line 51 "../src/InternalUtils.vala"
			_tmp27_ = geometry;
#line 51 "../src/InternalUtils.vala"
			_tmp28_ = geometry;
#line 51 "../src/InternalUtils.vala"
			_tmp29_ = geometry;
#line 51 "../src/InternalUtils.vala"
			_tmp30_.x = (gshort) ((_tmp26_.x + _tmp27_.width) - 1);
#line 51 "../src/InternalUtils.vala"
			_tmp30_.y = (gshort) ((_tmp28_.y + _tmp29_.height) - 1);
#line 51 "../src/InternalUtils.vala"
			_tmp30_.width = br_size;
#line 51 "../src/InternalUtils.vala"
			_tmp30_.height = br_size;
#line 51 "../src/InternalUtils.vala"
			bottomright = _tmp30_;
#line 53 "../src/InternalUtils.vala"
			_tmp31_ = g_new0 (XRectangle, 4);
#line 53 "../src/InternalUtils.vala"
			_tmp31_[0] = topleft;
#line 53 "../src/InternalUtils.vala"
			_tmp31_[1] = topright;
#line 53 "../src/InternalUtils.vala"
			_tmp31_[2] = bottomleft;
#line 53 "../src/InternalUtils.vala"
			_tmp31_[3] = bottomright;
#line 53 "../src/InternalUtils.vala"
			rects = (g_free (rects), NULL);
#line 53 "../src/InternalUtils.vala"
			rects = _tmp31_;
#line 53 "../src/InternalUtils.vala"
			rects_length1 = 4;
#line 53 "../src/InternalUtils.vala"
			_rects_size_ = rects_length1;
#line 56 "../src/InternalUtils.vala"
			_tmp32_ = gala_plugin_manager_get_default ();
#line 56 "../src/InternalUtils.vala"
			_tmp34_ = gala_plugin_manager_get_regions (_tmp32_, &_tmp33_);
#line 545 "InternalUtils.c"
			{
				XRectangle* rect_collection = NULL;
				gint rect_collection_length1 = 0;
				gint _rect_collection_size_ = 0;
				gint rect_it = 0;
#line 56 "../src/InternalUtils.vala"
				rect_collection = _tmp34_;
#line 56 "../src/InternalUtils.vala"
				rect_collection_length1 = _tmp33_;
#line 56 "../src/InternalUtils.vala"
				for (rect_it = 0; rect_it < rect_collection_length1; rect_it = rect_it + 1) {
#line 557 "InternalUtils.c"
					XRectangle rect = {0};
#line 56 "../src/InternalUtils.vala"
					rect = rect_collection[rect_it];
#line 561 "InternalUtils.c"
					{
#line 57 "../src/InternalUtils.vala"
						_vala_array_add5 (&rects, &rects_length1, &_rects_size_, rect);
#line 565 "InternalUtils.c"
					}
				}
			}
#line 60 "../src/InternalUtils.vala"
			_g_object_unref0 (settings);
#line 60 "../src/InternalUtils.vala"
			break;
#line 573 "InternalUtils.c"
		}
		default:
#line 34 "../src/InternalUtils.vala"
		case GALA_INPUT_AREA_NONE:
#line 578 "InternalUtils.c"
		{
			XRectangle* _tmp35_;
#line 68 "../src/InternalUtils.vala"
			_tmp35_ = g_new0 (XRectangle, 0);
#line 68 "../src/InternalUtils.vala"
			rects = (g_free (rects), NULL);
#line 68 "../src/InternalUtils.vala"
			rects = _tmp35_;
#line 68 "../src/InternalUtils.vala"
			rects_length1 = 0;
#line 68 "../src/InternalUtils.vala"
			_rects_size_ = rects_length1;
#line 69 "../src/InternalUtils.vala"
			break;
#line 593 "InternalUtils.c"
		}
	}
#line 73 "../src/InternalUtils.vala"
	_tmp36_ = meta_display_get_x11_display (display);
#line 73 "../src/InternalUtils.vala"
	x11display = _tmp36_;
#line 74 "../src/InternalUtils.vala"
	_tmp37_ = x11display;
#line 74 "../src/InternalUtils.vala"
	_tmp38_ = meta_x11_display_get_xdisplay (_tmp37_);
#line 74 "../src/InternalUtils.vala"
	_tmp39_ = rects;
#line 74 "../src/InternalUtils.vala"
	_tmp39__length1 = rects_length1;
#line 74 "../src/InternalUtils.vala"
	xregion = XFixesCreateRegion (_tmp38_, _tmp39_, (gint) _tmp39__length1);
#line 75 "../src/InternalUtils.vala"
	_tmp40_ = x11display;
#line 75 "../src/InternalUtils.vala"
	meta_x11_display_set_stage_input_region (_tmp40_, xregion);
#line 24 "../src/InternalUtils.vala"
	rects = (g_free (rects), NULL);
#line 616 "InternalUtils.c"
}

/**
         * Inserts a workspace at the given index. To ensure the workspace is not immediately
         * removed again when in dynamic workspaces, the window is first placed on it.
         *
         * @param index  The index at which to insert the workspace
         * @param new_window A window that should be moved to the new workspace
         */
void
gala_internal_utils_insert_workspace_with_window (gint index,
                                                  MetaWindow* new_window)
{
	GalaWorkspaceManager* workspace_manager = NULL;
	GalaWorkspaceManager* _tmp0_;
	GalaWorkspaceManager* _tmp1_;
	GList* actors = NULL;
	MetaDisplay* _tmp2_;
	GList* _tmp3_;
	GList* _tmp4_;
	GalaWorkspaceManager* _tmp16_;
#line 85 "../src/InternalUtils.vala"
	g_return_if_fail (new_window != NULL);
#line 86 "../src/InternalUtils.vala"
	_tmp0_ = gala_workspace_manager_get_default ();
#line 86 "../src/InternalUtils.vala"
	workspace_manager = _tmp0_;
#line 87 "../src/InternalUtils.vala"
	_tmp1_ = workspace_manager;
#line 87 "../src/InternalUtils.vala"
	gala_workspace_manager_freeze_remove (_tmp1_);
#line 89 "../src/InternalUtils.vala"
	meta_window_change_workspace_by_index (new_window, index, FALSE);
#line 91 "../src/InternalUtils.vala"
	_tmp2_ = meta_window_get_display (new_window);
#line 91 "../src/InternalUtils.vala"
	_tmp3_ = meta_get_window_actors (_tmp2_);
#line 91 "../src/InternalUtils.vala"
	actors = _tmp3_;
#line 92 "../src/InternalUtils.vala"
	_tmp4_ = actors;
#line 658 "InternalUtils.c"
	{
		GList* actor_collection = NULL;
		GList* actor_it = NULL;
#line 92 "../src/InternalUtils.vala"
		actor_collection = _tmp4_;
#line 92 "../src/InternalUtils.vala"
		for (actor_it = actor_collection; actor_it != NULL; actor_it = actor_it->next) {
#line 666 "InternalUtils.c"
			MetaWindowActor* actor = NULL;
#line 92 "../src/InternalUtils.vala"
			actor = (MetaWindowActor*) actor_it->data;
#line 670 "InternalUtils.c"
			{
				MetaWindowActor* _tmp5_;
				MetaWindow* window = NULL;
				MetaWindowActor* _tmp6_;
				MetaWindow* _tmp7_;
				MetaWindow* _tmp8_;
				gint current_index = 0;
				MetaWindow* _tmp9_;
				MetaWorkspace* _tmp10_;
				gboolean _tmp11_ = FALSE;
#line 93 "../src/InternalUtils.vala"
				_tmp5_ = actor;
#line 93 "../src/InternalUtils.vala"
				if (meta_window_actor_is_destroyed (_tmp5_)) {
#line 94 "../src/InternalUtils.vala"
					continue;
#line 687 "InternalUtils.c"
				}
#line 96 "../src/InternalUtils.vala"
				_tmp6_ = actor;
#line 96 "../src/InternalUtils.vala"
				_tmp7_ = meta_window_actor_get_meta_window (_tmp6_);
#line 96 "../src/InternalUtils.vala"
				window = _tmp7_;
#line 97 "../src/InternalUtils.vala"
				_tmp8_ = window;
#line 97 "../src/InternalUtils.vala"
				if (_tmp8_ == new_window) {
#line 98 "../src/InternalUtils.vala"
					continue;
#line 701 "InternalUtils.c"
				}
#line 100 "../src/InternalUtils.vala"
				_tmp9_ = window;
#line 100 "../src/InternalUtils.vala"
				_tmp10_ = meta_window_get_workspace (_tmp9_);
#line 100 "../src/InternalUtils.vala"
				current_index = meta_workspace_index (_tmp10_);
#line 101 "../src/InternalUtils.vala"
				if (current_index >= index) {
#line 711 "InternalUtils.c"
					MetaWindow* _tmp12_;
					gboolean _tmp13_;
					gboolean _tmp14_;
#line 102 "../src/InternalUtils.vala"
					_tmp12_ = window;
#line 102 "../src/InternalUtils.vala"
					g_object_get (_tmp12_, "on-all-workspaces", &_tmp13_, NULL);
#line 102 "../src/InternalUtils.vala"
					_tmp14_ = _tmp13_;
#line 102 "../src/InternalUtils.vala"
					_tmp11_ = !_tmp14_;
#line 723 "InternalUtils.c"
				} else {
#line 101 "../src/InternalUtils.vala"
					_tmp11_ = FALSE;
#line 727 "InternalUtils.c"
				}
#line 101 "../src/InternalUtils.vala"
				if (_tmp11_) {
#line 731 "InternalUtils.c"
					MetaWindow* _tmp15_;
#line 103 "../src/InternalUtils.vala"
					_tmp15_ = window;
#line 103 "../src/InternalUtils.vala"
					meta_window_change_workspace_by_index (_tmp15_, current_index + 1, TRUE);
#line 737 "InternalUtils.c"
				}
			}
		}
	}
#line 107 "../src/InternalUtils.vala"
	_tmp16_ = workspace_manager;
#line 107 "../src/InternalUtils.vala"
	gala_workspace_manager_thaw_remove (_tmp16_);
#line 746 "InternalUtils.c"
}

static gint
gala_internal_utils_squared_distance (GdkPoint* a,
                                      GdkPoint* b)
{
	gint k1 = 0;
	GdkPoint _tmp0_;
	GdkPoint _tmp1_;
	gint k2 = 0;
	GdkPoint _tmp2_;
	GdkPoint _tmp3_;
	gint result;
#line 114 "../src/InternalUtils.vala"
	g_return_val_if_fail (a != NULL, 0);
#line 114 "../src/InternalUtils.vala"
	g_return_val_if_fail (b != NULL, 0);
#line 115 "../src/InternalUtils.vala"
	_tmp0_ = *b;
#line 115 "../src/InternalUtils.vala"
	_tmp1_ = *a;
#line 115 "../src/InternalUtils.vala"
	k1 = _tmp0_.x - _tmp1_.x;
#line 116 "../src/InternalUtils.vala"
	_tmp2_ = *b;
#line 116 "../src/InternalUtils.vala"
	_tmp3_ = *a;
#line 116 "../src/InternalUtils.vala"
	k2 = _tmp2_.y - _tmp3_.y;
#line 118 "../src/InternalUtils.vala"
	result = (k1 * k1) + (k2 * k2);
#line 118 "../src/InternalUtils.vala"
	return result;
#line 780 "InternalUtils.c"
}

static void
gala_internal_utils_rect_adjusted (MtkRectangle* rect,
                                   gint dx1,
                                   gint dy1,
                                   gint dx2,
                                   gint dy2,
                                   MtkRectangle* result)
{
	MtkRectangle _tmp0_;
	MtkRectangle _tmp1_;
	MtkRectangle _tmp2_;
	MtkRectangle _tmp3_;
	MtkRectangle _tmp4_ = {0};
#line 122 "../src/InternalUtils.vala"
	g_return_if_fail (rect != NULL);
#line 126 "../src/InternalUtils.vala"
	_tmp0_ = *rect;
#line 126 "../src/InternalUtils.vala"
	_tmp1_ = *rect;
#line 126 "../src/InternalUtils.vala"
	_tmp2_ = *rect;
#line 126 "../src/InternalUtils.vala"
	_tmp3_ = *rect;
#line 126 "../src/InternalUtils.vala"
	_tmp4_.x = _tmp0_.x + dx1;
#line 126 "../src/InternalUtils.vala"
	_tmp4_.y = _tmp1_.y + dy1;
#line 126 "../src/InternalUtils.vala"
	_tmp4_.width = _tmp2_.width + ((-dx1) + dx2);
#line 126 "../src/InternalUtils.vala"
	_tmp4_.height = _tmp3_.height + ((-dy1) + dy2);
#line 126 "../src/InternalUtils.vala"
	*result = _tmp4_;
#line 126 "../src/InternalUtils.vala"
	return;
#line 818 "InternalUtils.c"
}

static void
gala_internal_utils_rect_center (MtkRectangle* rect,
                                 GdkPoint* result)
{
	MtkRectangle _tmp0_;
	MtkRectangle _tmp1_;
	MtkRectangle _tmp2_;
	MtkRectangle _tmp3_;
	GdkPoint _tmp4_ = {0};
#line 130 "../src/InternalUtils.vala"
	g_return_if_fail (rect != NULL);
#line 134 "../src/InternalUtils.vala"
	_tmp0_ = *rect;
#line 134 "../src/InternalUtils.vala"
	_tmp1_ = *rect;
#line 134 "../src/InternalUtils.vala"
	_tmp2_ = *rect;
#line 134 "../src/InternalUtils.vala"
	_tmp3_ = *rect;
#line 134 "../src/InternalUtils.vala"
	_tmp4_.x = _tmp0_.x + (_tmp1_.width / 2);
#line 134 "../src/InternalUtils.vala"
	_tmp4_.y = _tmp2_.y + (_tmp3_.height / 2);
#line 134 "../src/InternalUtils.vala"
	*result = _tmp4_;
#line 134 "../src/InternalUtils.vala"
	return;
#line 848 "InternalUtils.c"
}

/**
         * Careful: List<TilableWindow?> windows will be modified in place and shouldn't be used afterwards.
         */
static gpointer
_gala_internal_utils_tilable_window_dup0 (gpointer self)
{
#line 180 "../src/InternalUtils.vala"
	return self ? gala_internal_utils_tilable_window_dup (self) : NULL;
#line 859 "InternalUtils.c"
}

static gboolean
_mtk_rectangle_equal (const MtkRectangle * s1,
                      const MtkRectangle * s2)
{
#line 197 "../src/InternalUtils.vala"
	if (s1 == s2) {
#line 197 "../src/InternalUtils.vala"
		return TRUE;
#line 870 "InternalUtils.c"
	}
#line 197 "../src/InternalUtils.vala"
	if (s1 == NULL) {
#line 197 "../src/InternalUtils.vala"
		return FALSE;
#line 876 "InternalUtils.c"
	}
#line 197 "../src/InternalUtils.vala"
	if (s2 == NULL) {
#line 197 "../src/InternalUtils.vala"
		return FALSE;
#line 882 "InternalUtils.c"
	}
#line 197 "../src/InternalUtils.vala"
	if (s1->x != s2->x) {
#line 197 "../src/InternalUtils.vala"
		return FALSE;
#line 888 "InternalUtils.c"
	}
#line 197 "../src/InternalUtils.vala"
	if (s1->y != s2->y) {
#line 197 "../src/InternalUtils.vala"
		return FALSE;
#line 894 "InternalUtils.c"
	}
#line 197 "../src/InternalUtils.vala"
	if (s1->width != s2->width) {
#line 197 "../src/InternalUtils.vala"
		return FALSE;
#line 900 "InternalUtils.c"
	}
#line 197 "../src/InternalUtils.vala"
	if (s1->height != s2->height) {
#line 197 "../src/InternalUtils.vala"
		return FALSE;
#line 906 "InternalUtils.c"
	}
#line 197 "../src/InternalUtils.vala"
	return TRUE;
#line 910 "InternalUtils.c"
}

static gboolean
_gala_internal_utils_tilable_window_equal (const GalaInternalUtilsTilableWindow * s1,
                                           const GalaInternalUtilsTilableWindow * s2)
{
#line 197 "../src/InternalUtils.vala"
	if (s1 == s2) {
#line 197 "../src/InternalUtils.vala"
		return TRUE;
#line 921 "InternalUtils.c"
	}
#line 197 "../src/InternalUtils.vala"
	if (s1 == NULL) {
#line 197 "../src/InternalUtils.vala"
		return FALSE;
#line 927 "InternalUtils.c"
	}
#line 197 "../src/InternalUtils.vala"
	if (s2 == NULL) {
#line 197 "../src/InternalUtils.vala"
		return FALSE;
#line 933 "InternalUtils.c"
	}
#line 197 "../src/InternalUtils.vala"
	if (!_mtk_rectangle_equal (&s1->rect, &s2->rect)) {
#line 197 "../src/InternalUtils.vala"
		return FALSE;
#line 939 "InternalUtils.c"
	}
#line 197 "../src/InternalUtils.vala"
	if (s1->id != s2->id) {
#line 197 "../src/InternalUtils.vala"
		return FALSE;
#line 945 "InternalUtils.c"
	}
#line 197 "../src/InternalUtils.vala"
	return TRUE;
#line 949 "InternalUtils.c"
}

GList*
gala_internal_utils_calculate_grid_placement (MtkRectangle* area,
                                              GList* windows)
{
	guint window_count = 0U;
	gint columns = 0;
	gint rows = 0;
	gint slot_width = 0;
	MtkRectangle _tmp0_;
	gint slot_height = 0;
	MtkRectangle _tmp1_;
	GalaInternalUtilsTilableWindow** taken_slots = NULL;
	GalaInternalUtilsTilableWindow** _tmp2_;
	gint taken_slots_length1;
	gint _taken_slots_size_;
	gint _tmp3_;
	GdkPoint* slot_centers = NULL;
	GdkPoint* _tmp4_;
	gint slot_centers_length1;
	gint _slot_centers_size_;
	gint _tmp5_;
	GList* _result_ = NULL;
	gint left_over = 0;
	GList* result;
#line 150 "../src/InternalUtils.vala"
	g_return_val_if_fail (area != NULL, NULL);
#line 154 "../src/InternalUtils.vala"
	window_count = g_list_length (windows);
#line 155 "../src/InternalUtils.vala"
	columns = (gint) ceil (sqrt ((gdouble) window_count));
#line 156 "../src/InternalUtils.vala"
	rows = (gint) ceil (window_count / ((gdouble) columns));
#line 159 "../src/InternalUtils.vala"
	_tmp0_ = *area;
#line 159 "../src/InternalUtils.vala"
	slot_width = _tmp0_.width / columns;
#line 160 "../src/InternalUtils.vala"
	_tmp1_ = *area;
#line 160 "../src/InternalUtils.vala"
	slot_height = _tmp1_.height / rows;
#line 162 "../src/InternalUtils.vala"
	_tmp2_ = g_new0 (GalaInternalUtilsTilableWindow*, 0);
#line 162 "../src/InternalUtils.vala"
	taken_slots = _tmp2_;
#line 162 "../src/InternalUtils.vala"
	taken_slots_length1 = 0;
#line 162 "../src/InternalUtils.vala"
	_taken_slots_size_ = taken_slots_length1;
#line 163 "../src/InternalUtils.vala"
	_tmp3_ = rows * columns;
#line 163 "../src/InternalUtils.vala"
	taken_slots = g_renew (GalaInternalUtilsTilableWindow*, taken_slots, rows * columns);
#line 163 "../src/InternalUtils.vala"
	(_tmp3_ > taken_slots_length1) ? memset (taken_slots + taken_slots_length1, 0, sizeof (GalaInternalUtilsTilableWindow*) * (_tmp3_ - taken_slots_length1)) : NULL;
#line 163 "../src/InternalUtils.vala"
	taken_slots_length1 = _tmp3_;
#line 163 "../src/InternalUtils.vala"
	_taken_slots_size_ = _tmp3_;
#line 166 "../src/InternalUtils.vala"
	_tmp4_ = g_new0 (GdkPoint, 0);
#line 166 "../src/InternalUtils.vala"
	slot_centers = _tmp4_;
#line 166 "../src/InternalUtils.vala"
	slot_centers_length1 = 0;
#line 166 "../src/InternalUtils.vala"
	_slot_centers_size_ = slot_centers_length1;
#line 167 "../src/InternalUtils.vala"
	_tmp5_ = rows * columns;
#line 167 "../src/InternalUtils.vala"
	slot_centers = g_renew (GdkPoint, slot_centers, rows * columns);
#line 167 "../src/InternalUtils.vala"
	(_tmp5_ > slot_centers_length1) ? memset (slot_centers + slot_centers_length1, 0, sizeof (GdkPoint) * (_tmp5_ - slot_centers_length1)) : NULL;
#line 167 "../src/InternalUtils.vala"
	slot_centers_length1 = _tmp5_;
#line 167 "../src/InternalUtils.vala"
	_slot_centers_size_ = _tmp5_;
#line 1028 "InternalUtils.c"
	{
		gint x = 0;
#line 168 "../src/InternalUtils.vala"
		x = 0;
#line 1033 "InternalUtils.c"
		{
			gboolean _tmp6_ = FALSE;
#line 168 "../src/InternalUtils.vala"
			_tmp6_ = TRUE;
#line 168 "../src/InternalUtils.vala"
			while (TRUE) {
#line 168 "../src/InternalUtils.vala"
				if (!_tmp6_) {
#line 1042 "InternalUtils.c"
					gint _tmp7_;
#line 168 "../src/InternalUtils.vala"
					_tmp7_ = x;
#line 168 "../src/InternalUtils.vala"
					x = _tmp7_ + 1;
#line 1048 "InternalUtils.c"
				}
#line 168 "../src/InternalUtils.vala"
				_tmp6_ = FALSE;
#line 168 "../src/InternalUtils.vala"
				if (!(x < columns)) {
#line 168 "../src/InternalUtils.vala"
					break;
#line 1056 "InternalUtils.c"
				}
				{
					gint y = 0;
#line 169 "../src/InternalUtils.vala"
					y = 0;
#line 1062 "InternalUtils.c"
					{
						gboolean _tmp8_ = FALSE;
#line 169 "../src/InternalUtils.vala"
						_tmp8_ = TRUE;
#line 169 "../src/InternalUtils.vala"
						while (TRUE) {
#line 1069 "InternalUtils.c"
							GdkPoint* _tmp10_;
							gint _tmp10__length1;
							MtkRectangle _tmp11_;
							MtkRectangle _tmp12_;
							GdkPoint _tmp13_ = {0};
#line 169 "../src/InternalUtils.vala"
							if (!_tmp8_) {
#line 1077 "InternalUtils.c"
								gint _tmp9_;
#line 169 "../src/InternalUtils.vala"
								_tmp9_ = y;
#line 169 "../src/InternalUtils.vala"
								y = _tmp9_ + 1;
#line 1083 "InternalUtils.c"
							}
#line 169 "../src/InternalUtils.vala"
							_tmp8_ = FALSE;
#line 169 "../src/InternalUtils.vala"
							if (!(y < rows)) {
#line 169 "../src/InternalUtils.vala"
								break;
#line 1091 "InternalUtils.c"
							}
#line 170 "../src/InternalUtils.vala"
							_tmp10_ = slot_centers;
#line 170 "../src/InternalUtils.vala"
							_tmp10__length1 = slot_centers_length1;
#line 170 "../src/InternalUtils.vala"
							_tmp11_ = *area;
#line 170 "../src/InternalUtils.vala"
							_tmp12_ = *area;
#line 170 "../src/InternalUtils.vala"
							_tmp13_.x = (_tmp11_.x + (slot_width * x)) + (slot_width / 2);
#line 170 "../src/InternalUtils.vala"
							_tmp13_.y = (_tmp12_.y + (slot_height * y)) + (slot_height / 2);
#line 170 "../src/InternalUtils.vala"
							_tmp10_[x + (y * columns)] = _tmp13_;
#line 1107 "InternalUtils.c"
						}
					}
				}
			}
		}
	}
#line 178 "../src/InternalUtils.vala"
	while (TRUE) {
#line 1116 "InternalUtils.c"
		GList* link = NULL;
		GList* _tmp14_;
		GalaInternalUtilsTilableWindow* window = NULL;
		GList* _tmp15_;
		gconstpointer _tmp16_;
		GalaInternalUtilsTilableWindow* _tmp17_;
		MtkRectangle rect = {0};
		GalaInternalUtilsTilableWindow* _tmp18_;
		MtkRectangle _tmp19_;
		gint slot_candidate = 0;
		gint slot_candidate_distance = 0;
		GdkPoint pos = {0};
		MtkRectangle _tmp20_;
		GdkPoint _tmp21_ = {0};
		GalaInternalUtilsTilableWindow** _tmp39_;
		gint _tmp39__length1;
		GalaInternalUtilsTilableWindow* _tmp40_;
		GList* _tmp44_;
		GalaInternalUtilsTilableWindow** _tmp45_;
		gint _tmp45__length1;
		GalaInternalUtilsTilableWindow* _tmp46_;
		GalaInternalUtilsTilableWindow* _tmp47_;
#line 178 "../src/InternalUtils.vala"
		if (!(g_list_length (windows) > ((guint) 0))) {
#line 178 "../src/InternalUtils.vala"
			break;
#line 1143 "InternalUtils.c"
		}
#line 179 "../src/InternalUtils.vala"
		_tmp14_ = g_list_nth (windows, (guint) 0);
#line 179 "../src/InternalUtils.vala"
		link = _tmp14_;
#line 180 "../src/InternalUtils.vala"
		_tmp15_ = link;
#line 180 "../src/InternalUtils.vala"
		_tmp16_ = _tmp15_->data;
#line 180 "../src/InternalUtils.vala"
		_tmp17_ = _gala_internal_utils_tilable_window_dup0 ((GalaInternalUtilsTilableWindow*) _tmp16_);
#line 180 "../src/InternalUtils.vala"
		window = _tmp17_;
#line 181 "../src/InternalUtils.vala"
		_tmp18_ = window;
#line 181 "../src/InternalUtils.vala"
		_tmp19_ = (*_tmp18_).rect;
#line 181 "../src/InternalUtils.vala"
		rect = _tmp19_;
#line 183 "../src/InternalUtils.vala"
		slot_candidate = -1;
#line 184 "../src/InternalUtils.vala"
		slot_candidate_distance = G_MAXINT;
#line 185 "../src/InternalUtils.vala"
		_tmp20_ = rect;
#line 185 "../src/InternalUtils.vala"
		gala_internal_utils_rect_center (&_tmp20_, &_tmp21_);
#line 185 "../src/InternalUtils.vala"
		pos = _tmp21_;
#line 1173 "InternalUtils.c"
		{
			gint i = 0;
#line 188 "../src/InternalUtils.vala"
			i = 0;
#line 1178 "InternalUtils.c"
			{
				gboolean _tmp22_ = FALSE;
#line 188 "../src/InternalUtils.vala"
				_tmp22_ = TRUE;
#line 188 "../src/InternalUtils.vala"
				while (TRUE) {
#line 1185 "InternalUtils.c"
					gint dist = 0;
					GdkPoint _tmp24_;
					GdkPoint* _tmp25_;
					gint _tmp25__length1;
					GdkPoint _tmp26_;
#line 188 "../src/InternalUtils.vala"
					if (!_tmp22_) {
#line 1193 "InternalUtils.c"
						gint _tmp23_;
#line 188 "../src/InternalUtils.vala"
						_tmp23_ = i;
#line 188 "../src/InternalUtils.vala"
						i = _tmp23_ + 1;
#line 1199 "InternalUtils.c"
					}
#line 188 "../src/InternalUtils.vala"
					_tmp22_ = FALSE;
#line 188 "../src/InternalUtils.vala"
					if (!(i < (columns * rows))) {
#line 188 "../src/InternalUtils.vala"
						break;
#line 1207 "InternalUtils.c"
					}
#line 189 "../src/InternalUtils.vala"
					if (((guint) i) > (window_count - 1)) {
#line 190 "../src/InternalUtils.vala"
						break;
#line 1213 "InternalUtils.c"
					}
#line 192 "../src/InternalUtils.vala"
					_tmp24_ = pos;
#line 192 "../src/InternalUtils.vala"
					_tmp25_ = slot_centers;
#line 192 "../src/InternalUtils.vala"
					_tmp25__length1 = slot_centers_length1;
#line 192 "../src/InternalUtils.vala"
					_tmp26_ = _tmp25_[i];
#line 192 "../src/InternalUtils.vala"
					dist = gala_internal_utils_squared_distance (&_tmp24_, &_tmp26_);
#line 194 "../src/InternalUtils.vala"
					if (dist < slot_candidate_distance) {
#line 1227 "InternalUtils.c"
						GalaInternalUtilsTilableWindow* occupier = NULL;
						GalaInternalUtilsTilableWindow** _tmp27_;
						gint _tmp27__length1;
						GalaInternalUtilsTilableWindow* _tmp28_;
						GalaInternalUtilsTilableWindow* _tmp29_;
						GalaInternalUtilsTilableWindow* _tmp30_;
						GalaInternalUtilsTilableWindow* _tmp31_;
						gboolean _tmp32_ = FALSE;
						GalaInternalUtilsTilableWindow* _tmp33_;
#line 196 "../src/InternalUtils.vala"
						_tmp27_ = taken_slots;
#line 196 "../src/InternalUtils.vala"
						_tmp27__length1 = taken_slots_length1;
#line 196 "../src/InternalUtils.vala"
						_tmp28_ = _tmp27_[i];
#line 196 "../src/InternalUtils.vala"
						_tmp29_ = _gala_internal_utils_tilable_window_dup0 (_tmp28_);
#line 196 "../src/InternalUtils.vala"
						occupier = _tmp29_;
#line 197 "../src/InternalUtils.vala"
						_tmp30_ = occupier;
#line 197 "../src/InternalUtils.vala"
						_tmp31_ = window;
#line 197 "../src/InternalUtils.vala"
						if (_gala_internal_utils_tilable_window_equal (_tmp30_, _tmp31_) == TRUE) {
#line 198 "../src/InternalUtils.vala"
							_gala_internal_utils_tilable_window_free0 (occupier);
#line 198 "../src/InternalUtils.vala"
							continue;
#line 1257 "InternalUtils.c"
						}
#line 200 "../src/InternalUtils.vala"
						_tmp33_ = occupier;
#line 200 "../src/InternalUtils.vala"
						if (_tmp33_ == NULL) {
#line 200 "../src/InternalUtils.vala"
							_tmp32_ = TRUE;
#line 1265 "InternalUtils.c"
						} else {
							GalaInternalUtilsTilableWindow* _tmp34_;
							MtkRectangle _tmp35_;
							GdkPoint _tmp36_ = {0};
							GdkPoint* _tmp37_;
							gint _tmp37__length1;
							GdkPoint _tmp38_;
#line 200 "../src/InternalUtils.vala"
							_tmp34_ = occupier;
#line 200 "../src/InternalUtils.vala"
							_tmp35_ = (*_tmp34_).rect;
#line 200 "../src/InternalUtils.vala"
							gala_internal_utils_rect_center (&_tmp35_, &_tmp36_);
#line 200 "../src/InternalUtils.vala"
							_tmp37_ = slot_centers;
#line 200 "../src/InternalUtils.vala"
							_tmp37__length1 = slot_centers_length1;
#line 200 "../src/InternalUtils.vala"
							_tmp38_ = _tmp37_[i];
#line 200 "../src/InternalUtils.vala"
							_tmp32_ = dist < gala_internal_utils_squared_distance (&_tmp36_, &_tmp38_);
#line 1287 "InternalUtils.c"
						}
#line 200 "../src/InternalUtils.vala"
						if (_tmp32_) {
#line 202 "../src/InternalUtils.vala"
							slot_candidate = i;
#line 203 "../src/InternalUtils.vala"
							slot_candidate_distance = dist;
#line 1295 "InternalUtils.c"
						}
#line 194 "../src/InternalUtils.vala"
						_gala_internal_utils_tilable_window_free0 (occupier);
#line 1299 "InternalUtils.c"
					}
				}
			}
		}
#line 208 "../src/InternalUtils.vala"
		if (slot_candidate == -1) {
#line 209 "../src/InternalUtils.vala"
			_gala_internal_utils_tilable_window_free0 (window);
#line 209 "../src/InternalUtils.vala"
			continue;
#line 1310 "InternalUtils.c"
		}
#line 211 "../src/InternalUtils.vala"
		_tmp39_ = taken_slots;
#line 211 "../src/InternalUtils.vala"
		_tmp39__length1 = taken_slots_length1;
#line 211 "../src/InternalUtils.vala"
		_tmp40_ = _tmp39_[slot_candidate];
#line 211 "../src/InternalUtils.vala"
		if (_tmp40_ != NULL) {
#line 1320 "InternalUtils.c"
			GalaInternalUtilsTilableWindow** _tmp41_;
			gint _tmp41__length1;
			GalaInternalUtilsTilableWindow* _tmp42_;
			GalaInternalUtilsTilableWindow* _tmp43_;
#line 212 "../src/InternalUtils.vala"
			_tmp41_ = taken_slots;
#line 212 "../src/InternalUtils.vala"
			_tmp41__length1 = taken_slots_length1;
#line 212 "../src/InternalUtils.vala"
			_tmp42_ = _tmp41_[slot_candidate];
#line 212 "../src/InternalUtils.vala"
			_tmp43_ = _gala_internal_utils_tilable_window_dup0 (_tmp42_);
#line 212 "../src/InternalUtils.vala"
			windows = g_list_prepend (windows, _tmp43_);
#line 1335 "InternalUtils.c"
		}
#line 214 "../src/InternalUtils.vala"
		_tmp44_ = link;
#line 214 "../src/InternalUtils.vala"
		windows = g_list_remove_link (windows, _tmp44_);
#line 215 "../src/InternalUtils.vala"
		_tmp45_ = taken_slots;
#line 215 "../src/InternalUtils.vala"
		_tmp45__length1 = taken_slots_length1;
#line 215 "../src/InternalUtils.vala"
		_tmp46_ = window;
#line 215 "../src/InternalUtils.vala"
		_tmp47_ = _gala_internal_utils_tilable_window_dup0 (_tmp46_);
#line 215 "../src/InternalUtils.vala"
		_gala_internal_utils_tilable_window_free0 (_tmp45_[slot_candidate]);
#line 215 "../src/InternalUtils.vala"
		_tmp45_[slot_candidate] = _tmp47_;
#line 178 "../src/InternalUtils.vala"
		_gala_internal_utils_tilable_window_free0 (window);
#line 1355 "InternalUtils.c"
	}
#line 218 "../src/InternalUtils.vala"
	_result_ = NULL;
#line 221 "../src/InternalUtils.vala"
	left_over = ((gint) window_count) - (columns * (rows - 1));
#line 1361 "InternalUtils.c"
	{
		gint slot = 0;
#line 223 "../src/InternalUtils.vala"
		slot = 0;
#line 1366 "InternalUtils.c"
		{
			gboolean _tmp48_ = FALSE;
#line 223 "../src/InternalUtils.vala"
			_tmp48_ = TRUE;
#line 223 "../src/InternalUtils.vala"
			while (TRUE) {
#line 1373 "InternalUtils.c"
				GalaInternalUtilsTilableWindow* window = NULL;
				GalaInternalUtilsTilableWindow** _tmp50_;
				gint _tmp50__length1;
				GalaInternalUtilsTilableWindow* _tmp51_;
				GalaInternalUtilsTilableWindow* _tmp52_;
				GalaInternalUtilsTilableWindow* _tmp53_;
				MtkRectangle rect = {0};
				GalaInternalUtilsTilableWindow* _tmp54_;
				MtkRectangle _tmp55_;
				MtkRectangle target = {0};
				MtkRectangle _tmp56_;
				MtkRectangle _tmp57_;
				MtkRectangle _tmp58_ = {0};
				MtkRectangle _tmp59_;
				MtkRectangle _tmp60_ = {0};
				gfloat scale = 0.0F;
				MtkRectangle _tmp61_;
				MtkRectangle _tmp62_;
				MtkRectangle _tmp63_;
				MtkRectangle _tmp64_;
				gboolean _tmp84_ = FALSE;
				MtkRectangle _tmp85_;
				GalaInternalUtilsTilableWindow* _tmp86_;
				GalaWindowClone* _tmp87_;
				GalaInternalUtilsTilableWindow _tmp88_ = {0};
				GalaInternalUtilsTilableWindow* _tmp89_;
#line 223 "../src/InternalUtils.vala"
				if (!_tmp48_) {
#line 1402 "InternalUtils.c"
					gint _tmp49_;
#line 223 "../src/InternalUtils.vala"
					_tmp49_ = slot;
#line 223 "../src/InternalUtils.vala"
					slot = _tmp49_ + 1;
#line 1408 "InternalUtils.c"
				}
#line 223 "../src/InternalUtils.vala"
				_tmp48_ = FALSE;
#line 223 "../src/InternalUtils.vala"
				if (!(slot < (columns * rows))) {
#line 223 "../src/InternalUtils.vala"
					break;
#line 1416 "InternalUtils.c"
				}
#line 224 "../src/InternalUtils.vala"
				_tmp50_ = taken_slots;
#line 224 "../src/InternalUtils.vala"
				_tmp50__length1 = taken_slots_length1;
#line 224 "../src/InternalUtils.vala"
				_tmp51_ = _tmp50_[slot];
#line 224 "../src/InternalUtils.vala"
				_tmp52_ = _gala_internal_utils_tilable_window_dup0 (_tmp51_);
#line 224 "../src/InternalUtils.vala"
				window = _tmp52_;
#line 226 "../src/InternalUtils.vala"
				_tmp53_ = window;
#line 226 "../src/InternalUtils.vala"
				if (_tmp53_ == NULL) {
#line 227 "../src/InternalUtils.vala"
					_gala_internal_utils_tilable_window_free0 (window);
#line 227 "../src/InternalUtils.vala"
					continue;
#line 1436 "InternalUtils.c"
				}
#line 229 "../src/InternalUtils.vala"
				_tmp54_ = window;
#line 229 "../src/InternalUtils.vala"
				_tmp55_ = (*_tmp54_).rect;
#line 229 "../src/InternalUtils.vala"
				rect = _tmp55_;
#line 233 "../src/InternalUtils.vala"
				_tmp56_ = *area;
#line 233 "../src/InternalUtils.vala"
				_tmp57_ = *area;
#line 233 "../src/InternalUtils.vala"
				_tmp58_.x = _tmp56_.x + ((slot % columns) * slot_width);
#line 233 "../src/InternalUtils.vala"
				_tmp58_.y = _tmp57_.y + ((slot / columns) * slot_height);
#line 233 "../src/InternalUtils.vala"
				_tmp58_.width = slot_width;
#line 233 "../src/InternalUtils.vala"
				_tmp58_.height = slot_height;
#line 233 "../src/InternalUtils.vala"
				target = _tmp58_;
#line 242 "../src/InternalUtils.vala"
				_tmp59_ = target;
#line 242 "../src/InternalUtils.vala"
				gala_internal_utils_rect_adjusted (&_tmp59_, 10, 10, -10, -10, &_tmp60_);
#line 242 "../src/InternalUtils.vala"
				target = _tmp60_;
#line 245 "../src/InternalUtils.vala"
				_tmp61_ = target;
#line 245 "../src/InternalUtils.vala"
				_tmp62_ = rect;
#line 245 "../src/InternalUtils.vala"
				_tmp63_ = target;
#line 245 "../src/InternalUtils.vala"
				_tmp64_ = rect;
#line 245 "../src/InternalUtils.vala"
				if ((_tmp61_.width / ((gdouble) _tmp62_.width)) < (_tmp63_.height / ((gdouble) _tmp64_.height))) {
#line 1474 "InternalUtils.c"
					MtkRectangle _tmp65_;
					MtkRectangle _tmp66_;
					MtkRectangle _tmp67_;
					MtkRectangle _tmp68_;
					MtkRectangle _tmp69_;
#line 247 "../src/InternalUtils.vala"
					_tmp65_ = target;
#line 247 "../src/InternalUtils.vala"
					_tmp66_ = rect;
#line 247 "../src/InternalUtils.vala"
					scale = _tmp65_.width / ((gfloat) _tmp66_.width);
#line 248 "../src/InternalUtils.vala"
					_tmp67_ = target;
#line 248 "../src/InternalUtils.vala"
					_tmp68_ = rect;
#line 248 "../src/InternalUtils.vala"
					target.y = target.y + ((_tmp67_.height - ((gint) (_tmp68_.height * scale))) / 2);
#line 249 "../src/InternalUtils.vala"
					_tmp69_ = rect;
#line 249 "../src/InternalUtils.vala"
					target.height = (gint) floorf (_tmp69_.height * scale);
#line 1496 "InternalUtils.c"
				} else {
					MtkRectangle _tmp70_;
					MtkRectangle _tmp71_;
					MtkRectangle _tmp72_;
					MtkRectangle _tmp73_;
					MtkRectangle _tmp74_;
#line 252 "../src/InternalUtils.vala"
					_tmp70_ = target;
#line 252 "../src/InternalUtils.vala"
					_tmp71_ = rect;
#line 252 "../src/InternalUtils.vala"
					scale = _tmp70_.height / ((gfloat) _tmp71_.height);
#line 253 "../src/InternalUtils.vala"
					_tmp72_ = target;
#line 253 "../src/InternalUtils.vala"
					_tmp73_ = rect;
#line 253 "../src/InternalUtils.vala"
					target.x = target.x + ((_tmp72_.width - ((gint) (_tmp73_.width * scale))) / 2);
#line 254 "../src/InternalUtils.vala"
					_tmp74_ = rect;
#line 254 "../src/InternalUtils.vala"
					target.width = (gint) floorf (_tmp74_.width * scale);
#line 1519 "InternalUtils.c"
				}
#line 258 "../src/InternalUtils.vala"
				if (((gdouble) scale) > 1.0) {
#line 1523 "InternalUtils.c"
					MtkRectangle _tmp75_;
					GdkPoint _tmp76_ = {0};
					MtkRectangle _tmp77_;
					MtkRectangle _tmp78_;
					GdkPoint _tmp79_ = {0};
					MtkRectangle _tmp80_;
					MtkRectangle _tmp81_;
					MtkRectangle _tmp82_;
					MtkRectangle _tmp83_ = {0};
#line 259 "../src/InternalUtils.vala"
					scale = 1.0f;
#line 260 "../src/InternalUtils.vala"
					_tmp75_ = target;
#line 260 "../src/InternalUtils.vala"
					gala_internal_utils_rect_center (&_tmp75_, &_tmp76_);
#line 260 "../src/InternalUtils.vala"
					_tmp77_ = rect;
#line 260 "../src/InternalUtils.vala"
					_tmp78_ = target;
#line 260 "../src/InternalUtils.vala"
					gala_internal_utils_rect_center (&_tmp78_, &_tmp79_);
#line 260 "../src/InternalUtils.vala"
					_tmp80_ = rect;
#line 260 "../src/InternalUtils.vala"
					_tmp81_ = rect;
#line 260 "../src/InternalUtils.vala"
					_tmp82_ = rect;
#line 260 "../src/InternalUtils.vala"
					_tmp83_.x = _tmp76_.x - (((gint) floorf (_tmp77_.width * scale)) / 2);
#line 260 "../src/InternalUtils.vala"
					_tmp83_.y = _tmp79_.y - (((gint) floorf (_tmp80_.height * scale)) / 2);
#line 260 "../src/InternalUtils.vala"
					_tmp83_.width = (gint) floorf (scale * _tmp81_.width);
#line 260 "../src/InternalUtils.vala"
					_tmp83_.height = (gint) floorf (scale * _tmp82_.height);
#line 260 "../src/InternalUtils.vala"
					target = _tmp83_;
#line 1561 "InternalUtils.c"
				}
#line 267 "../src/InternalUtils.vala"
				if (left_over != columns) {
#line 267 "../src/InternalUtils.vala"
					_tmp84_ = slot >= (columns * (rows - 1));
#line 1567 "InternalUtils.c"
				} else {
#line 267 "../src/InternalUtils.vala"
					_tmp84_ = FALSE;
#line 1571 "InternalUtils.c"
				}
#line 267 "../src/InternalUtils.vala"
				if (_tmp84_) {
#line 268 "../src/InternalUtils.vala"
					target.x = target.x + (((columns - left_over) * slot_width) / 2);
#line 1577 "InternalUtils.c"
				}
#line 270 "../src/InternalUtils.vala"
				_tmp85_ = target;
#line 270 "../src/InternalUtils.vala"
				_tmp86_ = window;
#line 270 "../src/InternalUtils.vala"
				_tmp87_ = (*_tmp86_).id;
#line 270 "../src/InternalUtils.vala"
				_tmp88_.rect = _tmp85_;
#line 270 "../src/InternalUtils.vala"
				_tmp88_.id = _tmp87_;
#line 270 "../src/InternalUtils.vala"
				_tmp89_ = _gala_internal_utils_tilable_window_dup0 (&_tmp88_);
#line 270 "../src/InternalUtils.vala"
				_result_ = g_list_prepend (_result_, _tmp89_);
#line 223 "../src/InternalUtils.vala"
				_gala_internal_utils_tilable_window_free0 (window);
#line 1595 "InternalUtils.c"
			}
		}
	}
#line 273 "../src/InternalUtils.vala"
	_result_ = g_list_reverse (_result_);
#line 274 "../src/InternalUtils.vala"
	result = _result_;
#line 274 "../src/InternalUtils.vala"
	slot_centers = (g_free (slot_centers), NULL);
#line 274 "../src/InternalUtils.vala"
	taken_slots = (_vala_array_free (taken_slots, taken_slots_length1, (GDestroyNotify) gala_internal_utils_tilable_window_free), NULL);
#line 274 "../src/InternalUtils.vala"
	return result;
#line 1609 "InternalUtils.c"
}

static gpointer
_g_object_ref0 (gpointer self)
{
#line 286 "../src/InternalUtils.vala"
	return self ? g_object_ref (self) : NULL;
#line 1617 "InternalUtils.c"
}

static void
_g_object_unref0_ (gpointer var)
{
#line 300 "../src/InternalUtils.vala"
	(var == NULL) ? NULL : (var = (g_object_unref (var), NULL));
#line 1625 "InternalUtils.c"
}

static inline void
_g_slist_free__g_object_unref0_ (GSList* self)
{
#line 300 "../src/InternalUtils.vala"
	g_slist_free_full (self, (GDestroyNotify) _g_object_unref0_);
#line 1633 "InternalUtils.c"
}

GSList*
gala_internal_utils_sort_windows (MetaDisplay* display,
                                  GList* windows)
{
	GSList* windows_on_active_workspace = NULL;
	GSList* windows_on_other_workspaces = NULL;
	MetaWorkspace* active_workspace = NULL;
	MetaWorkspaceManager* _tmp0_;
	MetaWorkspace* _tmp1_;
	GSList* sorted_windows = NULL;
	GSList* windows_on_active_workspace_sorted = NULL;
	GSList* _tmp9_;
	GSList* _tmp10_;
	GSList* windows_on_other_workspaces_sorted = NULL;
	GSList* _tmp11_;
	GSList* _tmp12_;
	GSList* _tmp13_;
	GSList* _tmp14_;
	GSList* result;
#line 280 "../src/InternalUtils.vala"
	g_return_val_if_fail (display != NULL, NULL);
#line 281 "../src/InternalUtils.vala"
	windows_on_active_workspace = NULL;
#line 282 "../src/InternalUtils.vala"
	windows_on_other_workspaces = NULL;
#line 283 "../src/InternalUtils.vala"
	_tmp0_ = meta_display_get_workspace_manager (display);
#line 283 "../src/InternalUtils.vala"
	_tmp1_ = meta_workspace_manager_get_active_workspace (_tmp0_);
#line 283 "../src/InternalUtils.vala"
	active_workspace = _tmp1_;
#line 1667 "InternalUtils.c"
	{
		GList* window_collection = NULL;
		GList* window_it = NULL;
#line 284 "../src/InternalUtils.vala"
		window_collection = windows;
#line 284 "../src/InternalUtils.vala"
		for (window_it = window_collection; window_it != NULL; window_it = window_it->next) {
#line 1675 "InternalUtils.c"
			MetaWindow* window = NULL;
#line 284 "../src/InternalUtils.vala"
			window = (MetaWindow*) window_it->data;
#line 1679 "InternalUtils.c"
			{
				MetaWindow* _tmp2_;
				MetaWorkspace* _tmp3_;
				MetaWorkspace* _tmp4_;
#line 285 "../src/InternalUtils.vala"
				_tmp2_ = window;
#line 285 "../src/InternalUtils.vala"
				_tmp3_ = meta_window_get_workspace (_tmp2_);
#line 285 "../src/InternalUtils.vala"
				_tmp4_ = active_workspace;
#line 285 "../src/InternalUtils.vala"
				if (_tmp3_ == _tmp4_) {
#line 1692 "InternalUtils.c"
					MetaWindow* _tmp5_;
					MetaWindow* _tmp6_;
#line 286 "../src/InternalUtils.vala"
					_tmp5_ = window;
#line 286 "../src/InternalUtils.vala"
					_tmp6_ = _g_object_ref0 (_tmp5_);
#line 286 "../src/InternalUtils.vala"
					windows_on_active_workspace = g_slist_append (windows_on_active_workspace, _tmp6_);
#line 1701 "InternalUtils.c"
				} else {
					MetaWindow* _tmp7_;
					MetaWindow* _tmp8_;
#line 288 "../src/InternalUtils.vala"
					_tmp7_ = window;
#line 288 "../src/InternalUtils.vala"
					_tmp8_ = _g_object_ref0 (_tmp7_);
#line 288 "../src/InternalUtils.vala"
					windows_on_other_workspaces = g_slist_append (windows_on_other_workspaces, _tmp8_);
#line 1711 "InternalUtils.c"
				}
			}
		}
	}
#line 292 "../src/InternalUtils.vala"
	sorted_windows = NULL;
#line 293 "../src/InternalUtils.vala"
	_tmp9_ = windows_on_active_workspace;
#line 293 "../src/InternalUtils.vala"
	_tmp10_ = meta_display_sort_windows_by_stacking (display, _tmp9_);
#line 293 "../src/InternalUtils.vala"
	windows_on_active_workspace_sorted = _tmp10_;
#line 294 "../src/InternalUtils.vala"
	windows_on_active_workspace_sorted = g_slist_reverse (windows_on_active_workspace_sorted);
#line 295 "../src/InternalUtils.vala"
	_tmp11_ = windows_on_other_workspaces;
#line 295 "../src/InternalUtils.vala"
	_tmp12_ = meta_display_sort_windows_by_stacking (display, _tmp11_);
#line 295 "../src/InternalUtils.vala"
	windows_on_other_workspaces_sorted = _tmp12_;
#line 296 "../src/InternalUtils.vala"
	windows_on_other_workspaces_sorted = g_slist_reverse (windows_on_other_workspaces_sorted);
#line 297 "../src/InternalUtils.vala"
	_tmp13_ = windows_on_active_workspace_sorted;
#line 297 "../src/InternalUtils.vala"
	windows_on_active_workspace_sorted = NULL;
#line 297 "../src/InternalUtils.vala"
	sorted_windows = g_slist_concat (sorted_windows, _tmp13_);
#line 298 "../src/InternalUtils.vala"
	_tmp14_ = windows_on_other_workspaces_sorted;
#line 298 "../src/InternalUtils.vala"
	windows_on_other_workspaces_sorted = NULL;
#line 298 "../src/InternalUtils.vala"
	sorted_windows = g_slist_concat (sorted_windows, _tmp14_);
#line 300 "../src/InternalUtils.vala"
	result = sorted_windows;
#line 300 "../src/InternalUtils.vala"
	(windows_on_other_workspaces_sorted == NULL) ? NULL : (windows_on_other_workspaces_sorted = (g_slist_free (windows_on_other_workspaces_sorted), NULL));
#line 300 "../src/InternalUtils.vala"
	(windows_on_active_workspace_sorted == NULL) ? NULL : (windows_on_active_workspace_sorted = (g_slist_free (windows_on_active_workspace_sorted), NULL));
#line 300 "../src/InternalUtils.vala"
	(windows_on_other_workspaces == NULL) ? NULL : (windows_on_other_workspaces = (_g_slist_free__g_object_unref0_ (windows_on_other_workspaces), NULL));
#line 300 "../src/InternalUtils.vala"
	(windows_on_active_workspace == NULL) ? NULL : (windows_on_active_workspace = (_g_slist_free__g_object_unref0_ (windows_on_active_workspace), NULL));
#line 300 "../src/InternalUtils.vala"
	return result;
#line 1758 "InternalUtils.c"
}

inline gboolean
gala_internal_utils_get_window_is_normal (MetaWindow* window)
{
	MetaWindowType _tmp0_;
	MetaWindowType _tmp1_;
	gboolean result;
#line 303 "../src/InternalUtils.vala"
	g_return_val_if_fail (window != NULL, FALSE);
#line 304 "../src/InternalUtils.vala"
	_tmp0_ = meta_window_get_window_type (window);
#line 304 "../src/InternalUtils.vala"
	_tmp1_ = _tmp0_;
#line 304 "../src/InternalUtils.vala"
	switch (_tmp1_) {
#line 304 "../src/InternalUtils.vala"
		case META_WINDOW_NORMAL:
#line 304 "../src/InternalUtils.vala"
		case META_WINDOW_DIALOG:
#line 304 "../src/InternalUtils.vala"
		case META_WINDOW_MODAL_DIALOG:
#line 1781 "InternalUtils.c"
		{
#line 308 "../src/InternalUtils.vala"
			result = TRUE;
#line 308 "../src/InternalUtils.vala"
			return result;
#line 1787 "InternalUtils.c"
		}
		default:
		{
#line 310 "../src/InternalUtils.vala"
			result = FALSE;
#line 310 "../src/InternalUtils.vala"
			return result;
#line 1795 "InternalUtils.c"
		}
	}
}

/**
         * Multiplies an integer by a floating scaling factor, and then
         * returns the result rounded to the nearest integer
         */
gint
gala_internal_utils_scale_to_int (gint value,
                                  gfloat scale_factor)
{
	gint result;
#line 319 "../src/InternalUtils.vala"
	result = (gint) round ((gdouble) (((gfloat) value) * scale_factor));
#line 319 "../src/InternalUtils.vala"
	return result;
#line 1813 "InternalUtils.c"
}

/**
         * Returns the workspaces geometry following the only_on_primary settings.
         */
void
gala_internal_utils_get_workspaces_geometry (MetaDisplay* display,
                                             MtkRectangle* result)
{
#line 326 "../src/InternalUtils.vala"
	g_return_if_fail (display != NULL);
#line 330 "../src/InternalUtils.vala"
	if (gala_internal_utils_workspaces_only_on_primary ()) {
#line 1827 "InternalUtils.c"
		gint primary = 0;
		MtkRectangle _tmp0_ = {0};
#line 331 "../src/InternalUtils.vala"
		primary = meta_display_get_primary_monitor (display);
#line 332 "../src/InternalUtils.vala"
		meta_display_get_monitor_geometry (display, primary, &_tmp0_);
#line 332 "../src/InternalUtils.vala"
		*result = _tmp0_;
#line 332 "../src/InternalUtils.vala"
		return;
#line 1838 "InternalUtils.c"
	} else {
		gfloat screen_width = 0.0F;
		gfloat screen_height = 0.0F;
		gint _tmp1_ = 0;
		gint _tmp2_ = 0;
		MtkRectangle _tmp3_ = {0};
#line 335 "../src/InternalUtils.vala"
		meta_display_get_size (display, &_tmp1_, &_tmp2_);
#line 335 "../src/InternalUtils.vala"
		screen_width = (gfloat) _tmp1_;
#line 335 "../src/InternalUtils.vala"
		screen_height = (gfloat) _tmp2_;
#line 336 "../src/InternalUtils.vala"
		_tmp3_.x = 0;
#line 336 "../src/InternalUtils.vala"
		_tmp3_.y = 0;
#line 336 "../src/InternalUtils.vala"
		_tmp3_.width = (gint) screen_width;
#line 336 "../src/InternalUtils.vala"
		_tmp3_.height = (gint) screen_height;
#line 336 "../src/InternalUtils.vala"
		*result = _tmp3_;
#line 336 "../src/InternalUtils.vala"
		return;
#line 1863 "InternalUtils.c"
	}
}

GalaInternalUtils*
gala_internal_utils_construct (GType object_type)
{
	GalaInternalUtils* self = NULL;
#line 15 "../src/InternalUtils.vala"
	self = (GalaInternalUtils*) g_type_create_instance (object_type);
#line 15 "../src/InternalUtils.vala"
	return self;
#line 1875 "InternalUtils.c"
}

GalaInternalUtils*
gala_internal_utils_new (void)
{
#line 15 "../src/InternalUtils.vala"
	return gala_internal_utils_construct (GALA_TYPE_INTERNAL_UTILS);
#line 1883 "InternalUtils.c"
}

GalaInternalUtilsTilableWindow*
gala_internal_utils_tilable_window_dup (const GalaInternalUtilsTilableWindow* self)
{
	GalaInternalUtilsTilableWindow* dup;
#line 137 "../src/InternalUtils.vala"
	dup = g_new0 (GalaInternalUtilsTilableWindow, 1);
#line 137 "../src/InternalUtils.vala"
	memcpy (dup, self, sizeof (GalaInternalUtilsTilableWindow));
#line 137 "../src/InternalUtils.vala"
	return dup;
#line 1896 "InternalUtils.c"
}

void
gala_internal_utils_tilable_window_free (GalaInternalUtilsTilableWindow* self)
{
#line 137 "../src/InternalUtils.vala"
	g_free (self);
#line 1904 "InternalUtils.c"
}

 G_GNUC_NO_INLINE static GType
gala_internal_utils_tilable_window_get_type_once (void)
{
	GType gala_internal_utils_tilable_window_type_id;
	gala_internal_utils_tilable_window_type_id = g_boxed_type_register_static ("GalaInternalUtilsTilableWindow", (GBoxedCopyFunc) gala_internal_utils_tilable_window_dup, (GBoxedFreeFunc) gala_internal_utils_tilable_window_free);
	return gala_internal_utils_tilable_window_type_id;
}

GType
gala_internal_utils_tilable_window_get_type (void)
{
	static gsize gala_internal_utils_tilable_window_type_id__once = 0;
	if (g_once_init_enter (&gala_internal_utils_tilable_window_type_id__once)) {
		GType gala_internal_utils_tilable_window_type_id;
		gala_internal_utils_tilable_window_type_id = gala_internal_utils_tilable_window_get_type_once ();
		g_once_init_leave (&gala_internal_utils_tilable_window_type_id__once, gala_internal_utils_tilable_window_type_id);
	}
	return gala_internal_utils_tilable_window_type_id__once;
}

static void
gala_value_internal_utils_init (GValue* value)
{
#line 15 "../src/InternalUtils.vala"
	value->data[0].v_pointer = NULL;
#line 1932 "InternalUtils.c"
}

static void
gala_value_internal_utils_free_value (GValue* value)
{
#line 15 "../src/InternalUtils.vala"
	if (value->data[0].v_pointer) {
#line 15 "../src/InternalUtils.vala"
		gala_internal_utils_unref (value->data[0].v_pointer);
#line 1942 "InternalUtils.c"
	}
}

static void
gala_value_internal_utils_copy_value (const GValue* src_value,
                                      GValue* dest_value)
{
#line 15 "../src/InternalUtils.vala"
	if (src_value->data[0].v_pointer) {
#line 15 "../src/InternalUtils.vala"
		dest_value->data[0].v_pointer = gala_internal_utils_ref (src_value->data[0].v_pointer);
#line 1954 "InternalUtils.c"
	} else {
#line 15 "../src/InternalUtils.vala"
		dest_value->data[0].v_pointer = NULL;
#line 1958 "InternalUtils.c"
	}
}

static gpointer
gala_value_internal_utils_peek_pointer (const GValue* value)
{
#line 15 "../src/InternalUtils.vala"
	return value->data[0].v_pointer;
#line 1967 "InternalUtils.c"
}

static gchar*
gala_value_internal_utils_collect_value (GValue* value,
                                         guint n_collect_values,
                                         GTypeCValue* collect_values,
                                         guint collect_flags)
{
#line 15 "../src/InternalUtils.vala"
	if (collect_values[0].v_pointer) {
#line 1978 "InternalUtils.c"
		GalaInternalUtils * object;
		object = collect_values[0].v_pointer;
#line 15 "../src/InternalUtils.vala"
		if (object->parent_instance.g_class == NULL) {
#line 15 "../src/InternalUtils.vala"
			return g_strconcat ("invalid unclassed object pointer for value type `", G_VALUE_TYPE_NAME (value), "'", NULL);
#line 1985 "InternalUtils.c"
		} else if (!g_value_type_compatible (G_TYPE_FROM_INSTANCE (object), G_VALUE_TYPE (value))) {
#line 15 "../src/InternalUtils.vala"
			return g_strconcat ("invalid object type `", g_type_name (G_TYPE_FROM_INSTANCE (object)), "' for value type `", G_VALUE_TYPE_NAME (value), "'", NULL);
#line 1989 "InternalUtils.c"
		}
#line 15 "../src/InternalUtils.vala"
		value->data[0].v_pointer = gala_internal_utils_ref (object);
#line 1993 "InternalUtils.c"
	} else {
#line 15 "../src/InternalUtils.vala"
		value->data[0].v_pointer = NULL;
#line 1997 "InternalUtils.c"
	}
#line 15 "../src/InternalUtils.vala"
	return NULL;
#line 2001 "InternalUtils.c"
}

static gchar*
gala_value_internal_utils_lcopy_value (const GValue* value,
                                       guint n_collect_values,
                                       GTypeCValue* collect_values,
                                       guint collect_flags)
{
	GalaInternalUtils ** object_p;
	object_p = collect_values[0].v_pointer;
#line 15 "../src/InternalUtils.vala"
	if (!object_p) {
#line 15 "../src/InternalUtils.vala"
		return g_strdup_printf ("value location for `%s' passed as NULL", G_VALUE_TYPE_NAME (value));
#line 2016 "InternalUtils.c"
	}
#line 15 "../src/InternalUtils.vala"
	if (!value->data[0].v_pointer) {
#line 15 "../src/InternalUtils.vala"
		*object_p = NULL;
#line 2022 "InternalUtils.c"
	} else if (collect_flags & G_VALUE_NOCOPY_CONTENTS) {
#line 15 "../src/InternalUtils.vala"
		*object_p = value->data[0].v_pointer;
#line 2026 "InternalUtils.c"
	} else {
#line 15 "../src/InternalUtils.vala"
		*object_p = gala_internal_utils_ref (value->data[0].v_pointer);
#line 2030 "InternalUtils.c"
	}
#line 15 "../src/InternalUtils.vala"
	return NULL;
#line 2034 "InternalUtils.c"
}

GParamSpec*
gala_param_spec_internal_utils (const gchar* name,
                                const gchar* nick,
                                const gchar* blurb,
                                GType object_type,
                                GParamFlags flags)
{
	GalaParamSpecInternalUtils* spec;
#line 15 "../src/InternalUtils.vala"
	g_return_val_if_fail (g_type_is_a (object_type, GALA_TYPE_INTERNAL_UTILS), NULL);
#line 15 "../src/InternalUtils.vala"
	spec = g_param_spec_internal (G_TYPE_PARAM_OBJECT, name, nick, blurb, flags);
#line 15 "../src/InternalUtils.vala"
	G_PARAM_SPEC (spec)->value_type = object_type;
#line 15 "../src/InternalUtils.vala"
	return G_PARAM_SPEC (spec);
#line 2053 "InternalUtils.c"
}

gpointer
gala_value_get_internal_utils (const GValue* value)
{
#line 15 "../src/InternalUtils.vala"
	g_return_val_if_fail (G_TYPE_CHECK_VALUE_TYPE (value, GALA_TYPE_INTERNAL_UTILS), NULL);
#line 15 "../src/InternalUtils.vala"
	return value->data[0].v_pointer;
#line 2063 "InternalUtils.c"
}

void
gala_value_set_internal_utils (GValue* value,
                               gpointer v_object)
{
	GalaInternalUtils * old;
#line 15 "../src/InternalUtils.vala"
	g_return_if_fail (G_TYPE_CHECK_VALUE_TYPE (value, GALA_TYPE_INTERNAL_UTILS));
#line 15 "../src/InternalUtils.vala"
	old = value->data[0].v_pointer;
#line 15 "../src/InternalUtils.vala"
	if (v_object) {
#line 15 "../src/InternalUtils.vala"
		g_return_if_fail (G_TYPE_CHECK_INSTANCE_TYPE (v_object, GALA_TYPE_INTERNAL_UTILS));
#line 15 "../src/InternalUtils.vala"
		g_return_if_fail (g_value_type_compatible (G_TYPE_FROM_INSTANCE (v_object), G_VALUE_TYPE (value)));
#line 15 "../src/InternalUtils.vala"
		value->data[0].v_pointer = v_object;
#line 15 "../src/InternalUtils.vala"
		gala_internal_utils_ref (value->data[0].v_pointer);
#line 2085 "InternalUtils.c"
	} else {
#line 15 "../src/InternalUtils.vala"
		value->data[0].v_pointer = NULL;
#line 2089 "InternalUtils.c"
	}
#line 15 "../src/InternalUtils.vala"
	if (old) {
#line 15 "../src/InternalUtils.vala"
		gala_internal_utils_unref (old);
#line 2095 "InternalUtils.c"
	}
}

void
gala_value_take_internal_utils (GValue* value,
                                gpointer v_object)
{
	GalaInternalUtils * old;
#line 15 "../src/InternalUtils.vala"
	g_return_if_fail (G_TYPE_CHECK_VALUE_TYPE (value, GALA_TYPE_INTERNAL_UTILS));
#line 15 "../src/InternalUtils.vala"
	old = value->data[0].v_pointer;
#line 15 "../src/InternalUtils.vala"
	if (v_object) {
#line 15 "../src/InternalUtils.vala"
		g_return_if_fail (G_TYPE_CHECK_INSTANCE_TYPE (v_object, GALA_TYPE_INTERNAL_UTILS));
#line 15 "../src/InternalUtils.vala"
		g_return_if_fail (g_value_type_compatible (G_TYPE_FROM_INSTANCE (v_object), G_VALUE_TYPE (value)));
#line 15 "../src/InternalUtils.vala"
		value->data[0].v_pointer = v_object;
#line 2116 "InternalUtils.c"
	} else {
#line 15 "../src/InternalUtils.vala"
		value->data[0].v_pointer = NULL;
#line 2120 "InternalUtils.c"
	}
#line 15 "../src/InternalUtils.vala"
	if (old) {
#line 15 "../src/InternalUtils.vala"
		gala_internal_utils_unref (old);
#line 2126 "InternalUtils.c"
	}
}

static void
gala_internal_utils_class_init (GalaInternalUtilsClass * klass,
                                gpointer klass_data)
{
#line 15 "../src/InternalUtils.vala"
	gala_internal_utils_parent_class = g_type_class_peek_parent (klass);
#line 15 "../src/InternalUtils.vala"
	((GalaInternalUtilsClass *) klass)->finalize = gala_internal_utils_finalize;
#line 2138 "InternalUtils.c"
}

static void
gala_internal_utils_instance_init (GalaInternalUtils * self,
                                   gpointer klass)
{
#line 15 "../src/InternalUtils.vala"
	self->ref_count = 1;
#line 2147 "InternalUtils.c"
}

static void
gala_internal_utils_finalize (GalaInternalUtils * obj)
{
	GalaInternalUtils * self;
#line 15 "../src/InternalUtils.vala"
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, GALA_TYPE_INTERNAL_UTILS, GalaInternalUtils);
#line 15 "../src/InternalUtils.vala"
	g_signal_handlers_destroy (self);
#line 2158 "InternalUtils.c"
}

 G_GNUC_NO_INLINE static GType
gala_internal_utils_get_type_once (void)
{
	static const GTypeValueTable g_define_type_value_table = { gala_value_internal_utils_init, gala_value_internal_utils_free_value, gala_value_internal_utils_copy_value, gala_value_internal_utils_peek_pointer, "p", gala_value_internal_utils_collect_value, "p", gala_value_internal_utils_lcopy_value };
	static const GTypeInfo g_define_type_info = { sizeof (GalaInternalUtilsClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) gala_internal_utils_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (GalaInternalUtils), 0, (GInstanceInitFunc) gala_internal_utils_instance_init, &g_define_type_value_table };
	static const GTypeFundamentalInfo g_define_type_fundamental_info = { (G_TYPE_FLAG_CLASSED | G_TYPE_FLAG_INSTANTIATABLE | G_TYPE_FLAG_DERIVABLE | G_TYPE_FLAG_DEEP_DERIVABLE) };
	GType gala_internal_utils_type_id;
	gala_internal_utils_type_id = g_type_register_fundamental (g_type_fundamental_next (), "GalaInternalUtils", &g_define_type_info, &g_define_type_fundamental_info, 0);
	return gala_internal_utils_type_id;
}

GType
gala_internal_utils_get_type (void)
{
	static gsize gala_internal_utils_type_id__once = 0;
	if (g_once_init_enter (&gala_internal_utils_type_id__once)) {
		GType gala_internal_utils_type_id;
		gala_internal_utils_type_id = gala_internal_utils_get_type_once ();
		g_once_init_leave (&gala_internal_utils_type_id__once, gala_internal_utils_type_id);
	}
	return gala_internal_utils_type_id__once;
}

gpointer
gala_internal_utils_ref (gpointer instance)
{
	GalaInternalUtils * self;
	self = instance;
#line 15 "../src/InternalUtils.vala"
	g_atomic_int_inc (&self->ref_count);
#line 15 "../src/InternalUtils.vala"
	return instance;
#line 2193 "InternalUtils.c"
}

void
gala_internal_utils_unref (gpointer instance)
{
	GalaInternalUtils * self;
	self = instance;
#line 15 "../src/InternalUtils.vala"
	if (g_atomic_int_dec_and_test (&self->ref_count)) {
#line 15 "../src/InternalUtils.vala"
		GALA_INTERNAL_UTILS_GET_CLASS (self)->finalize (self);
#line 15 "../src/InternalUtils.vala"
		g_type_free_instance ((GTypeInstance *) self);
#line 2207 "InternalUtils.c"
	}
}

static void
_vala_array_destroy (gpointer array,
                     gssize array_length,
                     GDestroyNotify destroy_func)
{
	if ((array != NULL) && (destroy_func != NULL)) {
		gssize i;
		for (i = 0; i < array_length; i = i + 1) {
			if (((gpointer*) array)[i] != NULL) {
				destroy_func (((gpointer*) array)[i]);
			}
		}
	}
}

static void
_vala_array_free (gpointer array,
                  gssize array_length,
                  GDestroyNotify destroy_func)
{
	_vala_array_destroy (array, array_length, destroy_func);
	g_free (array);
}

