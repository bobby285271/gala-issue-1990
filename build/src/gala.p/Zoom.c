/* Zoom.c generated by valac 0.56.17, the Vala compiler
 * generated from Zoom.vala, do not modify */

/*
 * Copyright 2022 elementary, Inc. (https://elementary.io)
 * Copyright 2013 Tom Beckmann
 * Copyright 2013 Rico Tzschichholz
 * SPDX-License-Identifier: GPL-3.0-or-later
 */

#include <glib-object.h>
#include "gala.h"
#include <glib.h>
#include <float.h>
#include <math.h>
#include <meta/display.h>
#include <meta/meta-plugin.h>
#include <gio/gio.h>
#include "config.h"
#include <meta/prefs.h>
#include <meta/window.h>
#include <clutter/clutter.h>
#include <meta/keybindings.h>
#include <stdlib.h>
#include <string.h>
#include <graphene-gobject.h>
#include <meta/meta-cursor-tracker.h>
#include <gdk/gdk.h>

#define GALA_ZOOM_MIN_ZOOM 1.0f
#define GALA_ZOOM_MAX_ZOOM 10.0f
#define GALA_ZOOM_SHORTCUT_DELTA 0.5f
#define GALA_ZOOM_ANIMATION_DURATION 300
#define GALA_ZOOM_MOUSE_POLL_TIME ((guint) 50)
#if !defined(VALA_STRICT_C)
#if !defined(__clang__) && defined(__GNUC__) && (__GNUC__ >= 14)
#pragma GCC diagnostic warning "-Wincompatible-pointer-types"
#elif defined(__clang__) && (__clang_major__ >= 16)
#pragma clang diagnostic ignored "-Wincompatible-function-pointer-types"
#pragma clang diagnostic ignored "-Wincompatible-pointer-types"
#endif
#endif
#if !defined(VALA_EXTERN)
#if defined(_MSC_VER)
#define VALA_EXTERN __declspec(dllexport) extern
#elif __GNUC__ >= 4
#define VALA_EXTERN __attribute__((visibility("default"))) extern
#else
#define VALA_EXTERN extern
#endif
#endif

#define GALA_TYPE_ZOOM (gala_zoom_get_type ())
#define GALA_ZOOM(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), GALA_TYPE_ZOOM, GalaZoom))
#define GALA_ZOOM_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), GALA_TYPE_ZOOM, GalaZoomClass))
#define GALA_IS_ZOOM(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), GALA_TYPE_ZOOM))
#define GALA_IS_ZOOM_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), GALA_TYPE_ZOOM))
#define GALA_ZOOM_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), GALA_TYPE_ZOOM, GalaZoomClass))

typedef struct _GalaZoom GalaZoom;
typedef struct _GalaZoomClass GalaZoomClass;
typedef struct _GalaZoomPrivate GalaZoomPrivate;

#define GALA_TYPE_GESTURE_TRACKER (gala_gesture_tracker_get_type ())
#define GALA_GESTURE_TRACKER(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), GALA_TYPE_GESTURE_TRACKER, GalaGestureTracker))
#define GALA_GESTURE_TRACKER_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), GALA_TYPE_GESTURE_TRACKER, GalaGestureTrackerClass))
#define GALA_IS_GESTURE_TRACKER(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), GALA_TYPE_GESTURE_TRACKER))
#define GALA_IS_GESTURE_TRACKER_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), GALA_TYPE_GESTURE_TRACKER))
#define GALA_GESTURE_TRACKER_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), GALA_TYPE_GESTURE_TRACKER, GalaGestureTrackerClass))

typedef struct _GalaGestureTracker GalaGestureTracker;
typedef struct _GalaGestureTrackerClass GalaGestureTrackerClass;
enum  {
	GALA_ZOOM_0_PROPERTY,
	GALA_ZOOM_WM_PROPERTY,
	GALA_ZOOM_NUM_PROPERTIES
};
static GParamSpec* gala_zoom_properties[GALA_ZOOM_NUM_PROPERTIES];
#define _g_object_unref0(var) ((var == NULL) ? NULL : (var = (g_object_unref (var), NULL)))

#define GALA_TYPE_GESTURE (gala_gesture_get_type ())
#define GALA_GESTURE(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), GALA_TYPE_GESTURE, GalaGesture))
#define GALA_GESTURE_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), GALA_TYPE_GESTURE, GalaGestureClass))
#define GALA_IS_GESTURE(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), GALA_TYPE_GESTURE))
#define GALA_IS_GESTURE_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), GALA_TYPE_GESTURE))
#define GALA_GESTURE_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), GALA_TYPE_GESTURE, GalaGestureClass))

typedef struct _GalaGesture GalaGesture;
typedef struct _GalaGestureClass GalaGestureClass;
typedef struct _GalaGesturePrivate GalaGesturePrivate;
typedef enum  {
	GALA_GESTURE_DIRECTION_UNKNOWN = 0,
	GALA_GESTURE_DIRECTION_UP = 1,
	GALA_GESTURE_DIRECTION_DOWN = 2,
	GALA_GESTURE_DIRECTION_LEFT = 3,
	GALA_GESTURE_DIRECTION_RIGHT = 4,
	GALA_GESTURE_DIRECTION_IN = 5,
	GALA_GESTURE_DIRECTION_OUT = 6
} GalaGestureDirection;

#define GALA_TYPE_GESTURE_DIRECTION (gala_gesture_direction_get_type ())
#define _g_free0(var) (var = (g_free (var), NULL))
typedef struct _Block35Data Block35Data;
typedef void (*GalaGestureTrackerOnUpdate) (gdouble percentage, gpointer user_data);
typedef void (*GalaGestureTrackerOnBegin) (gdouble percentage, gpointer user_data);
typedef void (*GalaGestureTrackerOnEnd) (gdouble percentage, gboolean cancel_action, gint calculated_duration, gpointer user_data);
typedef struct _Block36Data Block36Data;
#define __vala_graphene_point_t_free0(var) ((var == NULL) ? NULL : (var = (_vala_graphene_point_t_free (var), NULL)))

struct _GalaZoom {
	GObject parent_instance;
	GalaZoomPrivate * priv;
};

struct _GalaZoomClass {
	GObjectClass parent_class;
};

struct _GalaZoomPrivate {
	GalaWindowManager* _wm;
	guint mouse_poll_timer;
	gfloat current_zoom;
	gulong wins_handler_id;
	GalaGestureTracker* gesture_tracker;
};

struct _GalaGesture {
	GTypeInstance parent_instance;
	volatile int ref_count;
	GalaGesturePrivate * priv;
	ClutterEventType type;
	GalaGestureDirection direction;
	gint fingers;
	ClutterInputDeviceType performed_on_device_type;
};

struct _GalaGestureClass {
	GTypeClass parent_class;
	void (*finalize) (GalaGesture *self);
};

struct _Block35Data {
	int _ref_count_;
	GalaZoom* self;
	gfloat initial_zoom;
	gfloat target_zoom;
};

struct _Block36Data {
	int _ref_count_;
	GalaZoom* self;
	ClutterActor* wins;
};

static gint GalaZoom_private_offset;
static gpointer gala_zoom_parent_class = NULL;

VALA_EXTERN GType gala_zoom_get_type (void) G_GNUC_CONST ;
G_DEFINE_AUTOPTR_CLEANUP_FUNC (GalaZoom, g_object_unref)
VALA_EXTERN GType gala_gesture_tracker_get_type (void) G_GNUC_CONST ;
G_DEFINE_AUTOPTR_CLEANUP_FUNC (GalaGestureTracker, g_object_unref)
VALA_EXTERN GalaWindowManager* gala_zoom_get_wm (GalaZoom* self);
VALA_EXTERN GalaZoom* gala_zoom_new (GalaWindowManager* wm);
VALA_EXTERN GalaZoom* gala_zoom_construct (GType object_type,
                               GalaWindowManager* wm);
static void gala_zoom_zoom_in (MetaDisplay* display,
                        MetaWindow* window,
                        ClutterKeyEvent* event,
                        MetaKeyBinding* binding,
                        GalaZoom* self);
static void gala_zoom_zoom_out (MetaDisplay* display,
                         MetaWindow* window,
                         ClutterKeyEvent* event,
                         MetaKeyBinding* binding,
                         GalaZoom* self);
VALA_EXTERN GalaGestureTracker* gala_gesture_tracker_new (gint min_animation_duration,
                                              gint max_animation_duration);
VALA_EXTERN GalaGestureTracker* gala_gesture_tracker_construct (GType object_type,
                                                    gint min_animation_duration,
                                                    gint max_animation_duration);
VALA_EXTERN void gala_gesture_tracker_enable_touchpad (GalaGestureTracker* self);
VALA_EXTERN gpointer gala_gesture_ref (gpointer instance);
VALA_EXTERN void gala_gesture_unref (gpointer instance);
VALA_EXTERN GParamSpec* gala_param_spec_gesture (const gchar* name,
                                     const gchar* nick,
                                     const gchar* blurb,
                                     GType object_type,
                                     GParamFlags flags);
VALA_EXTERN void gala_value_set_gesture (GValue* value,
                             gpointer v_object);
VALA_EXTERN void gala_value_take_gesture (GValue* value,
                              gpointer v_object);
VALA_EXTERN gpointer gala_value_get_gesture (const GValue* value);
VALA_EXTERN GType gala_gesture_get_type (void) G_GNUC_CONST ;
G_DEFINE_AUTOPTR_CLEANUP_FUNC (GalaGesture, gala_gesture_unref)
static void gala_zoom_on_gesture_detected (GalaZoom* self,
                                    GalaGesture* gesture);
static void _gala_zoom_on_gesture_detected_gala_gesture_tracker_on_gesture_detected (GalaGestureTracker* _sender,
                                                                              GalaGesture* gesture,
                                                                              gpointer self);
static void gala_zoom_zoom (GalaZoom* self,
                     gfloat delta,
                     gboolean play_sound,
                     gboolean animate);
VALA_EXTERN GType gala_gesture_direction_get_type (void) G_GNUC_CONST ;
VALA_EXTERN gchar* gala_gesture_settings_get_string (const gchar* setting_id);
static void gala_zoom_zoom_with_gesture (GalaZoom* self,
                                  GalaGestureDirection direction);
static Block35Data* block35_data_ref (Block35Data* _data35_);
static void block35_data_unref (void * _userdata_);
static void __lambda92_ (Block35Data* _data35_,
                  gdouble percentage);
VALA_EXTERN gfloat gala_gesture_tracker_animation_value (gfloat initial_value,
                                             gfloat target_value,
                                             gdouble percentage,
                                             gboolean rounded);
static void ___lambda92__gala_gesture_tracker_on_update (gdouble percentage,
                                                  gpointer self);
VALA_EXTERN void gala_gesture_tracker_connect_handlers (GalaGestureTracker* self,
                                            GalaGestureTrackerOnBegin on_begin_handler,
                                            gpointer on_begin_handler_target,
                                            GDestroyNotify on_begin_handler_target_destroy_notify,
                                            GalaGestureTrackerOnUpdate on_update_handler,
                                            gpointer on_update_handler_target,
                                            GDestroyNotify on_update_handler_target_destroy_notify,
                                            GalaGestureTrackerOnEnd on_end_handler,
                                            gpointer on_end_handler_target,
                                            GDestroyNotify on_end_handler_target_destroy_notify);
static inline void gala_zoom_compute_new_pivot_point (GalaZoom* self,
                                        graphene_point_t* result);
static Block36Data* block36_data_ref (Block36Data* _data36_);
static void block36_data_unref (void * _userdata_);
static gboolean ___lambda90_ (Block36Data* _data36_);
static void _vala_graphene_point_t_free (graphene_point_t* self);
static gboolean ____lambda90__gsource_func (gpointer self);
static void ____lambda91_ (Block36Data* _data36_);
static void _____lambda91__clutter_actor_transitions_completed (ClutterActor* _sender,
                                                         gpointer self);
static void gala_zoom_set_wm (GalaZoom* self,
                       GalaWindowManager* value);
static void gala_zoom_finalize (GObject * obj);
static GType gala_zoom_get_type_once (void);
static void _vala_gala_zoom_get_property (GObject * object,
                                   guint property_id,
                                   GValue * value,
                                   GParamSpec * pspec);
static void _vala_gala_zoom_set_property (GObject * object,
                                   guint property_id,
                                   const GValue * value,
                                   GParamSpec * pspec);

static inline gpointer
gala_zoom_get_instance_private (GalaZoom* self)
{
	return G_STRUCT_MEMBER_P (self, GalaZoom_private_offset);
}

static void
_gala_zoom_on_gesture_detected_gala_gesture_tracker_on_gesture_detected (GalaGestureTracker* _sender,
                                                                         GalaGesture* gesture,
                                                                         gpointer self)
{
#line 34 "../src/Zoom.vala"
	gala_zoom_on_gesture_detected ((GalaZoom*) self, gesture);
#line 266 "Zoom.c"
}

GalaZoom*
gala_zoom_construct (GType object_type,
                     GalaWindowManager* wm)
{
	GalaZoom * self = NULL;
	MetaDisplay* display = NULL;
	MetaDisplay* _tmp0_;
	GSettings* schema = NULL;
	GSettings* _tmp1_;
	GalaGestureTracker* _tmp2_;
	GalaGestureTracker* _tmp3_;
	GalaGestureTracker* _tmp4_;
#line 23 "../src/Zoom.vala"
	g_return_val_if_fail (wm != NULL, NULL);
#line 24 "../src/Zoom.vala"
	self = (GalaZoom*) g_object_new (object_type, "wm", wm, NULL);
#line 26 "../src/Zoom.vala"
	_tmp0_ = meta_plugin_get_display ((MetaPlugin*) wm);
#line 26 "../src/Zoom.vala"
	display = _tmp0_;
#line 27 "../src/Zoom.vala"
	_tmp1_ = g_settings_new (SCHEMA ".keybindings");
#line 27 "../src/Zoom.vala"
	schema = _tmp1_;
#line 29 "../src/Zoom.vala"
	meta_display_add_keybinding (display, "zoom-in", schema, META_KEY_BINDING_NONE, (MetaKeyHandlerFunc) gala_zoom_zoom_in, g_object_ref (self), g_object_unref);
#line 30 "../src/Zoom.vala"
	meta_display_add_keybinding (display, "zoom-out", schema, META_KEY_BINDING_NONE, (MetaKeyHandlerFunc) gala_zoom_zoom_out, g_object_ref (self), g_object_unref);
#line 32 "../src/Zoom.vala"
	_tmp2_ = gala_gesture_tracker_new (GALA_ZOOM_ANIMATION_DURATION, GALA_ZOOM_ANIMATION_DURATION);
#line 32 "../src/Zoom.vala"
	_g_object_unref0 (self->priv->gesture_tracker);
#line 32 "../src/Zoom.vala"
	self->priv->gesture_tracker = _tmp2_;
#line 33 "../src/Zoom.vala"
	_tmp3_ = self->priv->gesture_tracker;
#line 33 "../src/Zoom.vala"
	gala_gesture_tracker_enable_touchpad (_tmp3_);
#line 34 "../src/Zoom.vala"
	_tmp4_ = self->priv->gesture_tracker;
#line 34 "../src/Zoom.vala"
	g_signal_connect_object (_tmp4_, "on-gesture-detected", (GCallback) _gala_zoom_on_gesture_detected_gala_gesture_tracker_on_gesture_detected, self, 0);
#line 23 "../src/Zoom.vala"
	_g_object_unref0 (schema);
#line 23 "../src/Zoom.vala"
	return self;
#line 315 "Zoom.c"
}

GalaZoom*
gala_zoom_new (GalaWindowManager* wm)
{
#line 23 "../src/Zoom.vala"
	return gala_zoom_construct (GALA_TYPE_ZOOM, wm);
#line 323 "Zoom.c"
}

static void
gala_zoom_zoom_in (MetaDisplay* display,
                   MetaWindow* window,
                   ClutterKeyEvent* event,
                   MetaKeyBinding* binding,
                   GalaZoom* self)
{
	GalaWindowManager* _tmp0_;
	gboolean _tmp1_;
	gboolean _tmp2_;
#line 53 "../src/Zoom.vala"
	g_return_if_fail (self != NULL);
#line 53 "../src/Zoom.vala"
	g_return_if_fail (display != NULL);
#line 53 "../src/Zoom.vala"
	g_return_if_fail (event != NULL);
#line 53 "../src/Zoom.vala"
	g_return_if_fail (binding != NULL);
#line 55 "../src/Zoom.vala"
	_tmp0_ = self->priv->_wm;
#line 55 "../src/Zoom.vala"
	_tmp1_ = gala_window_manager_get_enable_animations (_tmp0_);
#line 55 "../src/Zoom.vala"
	_tmp2_ = _tmp1_;
#line 55 "../src/Zoom.vala"
	gala_zoom_zoom (self, GALA_ZOOM_SHORTCUT_DELTA, TRUE, _tmp2_);
#line 352 "Zoom.c"
}

static void
gala_zoom_zoom_out (MetaDisplay* display,
                    MetaWindow* window,
                    ClutterKeyEvent* event,
                    MetaKeyBinding* binding,
                    GalaZoom* self)
{
	GalaWindowManager* _tmp0_;
	gboolean _tmp1_;
	gboolean _tmp2_;
#line 59 "../src/Zoom.vala"
	g_return_if_fail (self != NULL);
#line 59 "../src/Zoom.vala"
	g_return_if_fail (display != NULL);
#line 59 "../src/Zoom.vala"
	g_return_if_fail (event != NULL);
#line 59 "../src/Zoom.vala"
	g_return_if_fail (binding != NULL);
#line 61 "../src/Zoom.vala"
	_tmp0_ = self->priv->_wm;
#line 61 "../src/Zoom.vala"
	_tmp1_ = gala_window_manager_get_enable_animations (_tmp0_);
#line 61 "../src/Zoom.vala"
	_tmp2_ = _tmp1_;
#line 61 "../src/Zoom.vala"
	gala_zoom_zoom (self, -GALA_ZOOM_SHORTCUT_DELTA, TRUE, _tmp2_);
#line 381 "Zoom.c"
}

static void
gala_zoom_on_gesture_detected (GalaZoom* self,
                               GalaGesture* gesture)
{
	gboolean _tmp0_ = FALSE;
	gboolean _tmp2_ = FALSE;
	gboolean _tmp3_ = FALSE;
#line 64 "../src/Zoom.vala"
	g_return_if_fail (self != NULL);
#line 64 "../src/Zoom.vala"
	g_return_if_fail (gesture != NULL);
#line 65 "../src/Zoom.vala"
	if (gesture->type != CLUTTER_TOUCHPAD_PINCH) {
#line 65 "../src/Zoom.vala"
		_tmp0_ = TRUE;
#line 399 "Zoom.c"
	} else {
		gboolean _tmp1_ = FALSE;
#line 66 "../src/Zoom.vala"
		if (gesture->direction != GALA_GESTURE_DIRECTION_IN) {
#line 66 "../src/Zoom.vala"
			_tmp1_ = gesture->direction != GALA_GESTURE_DIRECTION_OUT;
#line 406 "Zoom.c"
		} else {
#line 66 "../src/Zoom.vala"
			_tmp1_ = FALSE;
#line 410 "Zoom.c"
		}
#line 66 "../src/Zoom.vala"
		_tmp0_ = _tmp1_;
#line 414 "Zoom.c"
	}
#line 65 "../src/Zoom.vala"
	if (_tmp0_) {
#line 68 "../src/Zoom.vala"
		return;
#line 420 "Zoom.c"
	}
#line 71 "../src/Zoom.vala"
	if (gesture->fingers == 3) {
#line 424 "Zoom.c"
		gchar* _tmp4_;
		gchar* _tmp5_;
#line 71 "../src/Zoom.vala"
		_tmp4_ = gala_gesture_settings_get_string ("three-finger-pinch");
#line 71 "../src/Zoom.vala"
		_tmp5_ = _tmp4_;
#line 71 "../src/Zoom.vala"
		_tmp3_ = g_strcmp0 (_tmp5_, "zoom") == 0;
#line 71 "../src/Zoom.vala"
		_g_free0 (_tmp5_);
#line 435 "Zoom.c"
	} else {
#line 71 "../src/Zoom.vala"
		_tmp3_ = FALSE;
#line 439 "Zoom.c"
	}
#line 71 "../src/Zoom.vala"
	if (_tmp3_) {
#line 71 "../src/Zoom.vala"
		_tmp2_ = TRUE;
#line 445 "Zoom.c"
	} else {
		gboolean _tmp6_ = FALSE;
#line 72 "../src/Zoom.vala"
		if (gesture->fingers == 4) {
#line 450 "Zoom.c"
			gchar* _tmp7_;
			gchar* _tmp8_;
#line 72 "../src/Zoom.vala"
			_tmp7_ = gala_gesture_settings_get_string ("four-finger-pinch");
#line 72 "../src/Zoom.vala"
			_tmp8_ = _tmp7_;
#line 72 "../src/Zoom.vala"
			_tmp6_ = g_strcmp0 (_tmp8_, "zoom") == 0;
#line 72 "../src/Zoom.vala"
			_g_free0 (_tmp8_);
#line 461 "Zoom.c"
		} else {
#line 72 "../src/Zoom.vala"
			_tmp6_ = FALSE;
#line 465 "Zoom.c"
		}
#line 72 "../src/Zoom.vala"
		_tmp2_ = _tmp6_;
#line 469 "Zoom.c"
	}
#line 71 "../src/Zoom.vala"
	if (_tmp2_) {
#line 74 "../src/Zoom.vala"
		gala_zoom_zoom_with_gesture (self, gesture->direction);
#line 475 "Zoom.c"
	}
}

static Block35Data*
block35_data_ref (Block35Data* _data35_)
{
#line 78 "../src/Zoom.vala"
	g_atomic_int_inc (&_data35_->_ref_count_);
#line 78 "../src/Zoom.vala"
	return _data35_;
#line 486 "Zoom.c"
}

static void
block35_data_unref (void * _userdata_)
{
	Block35Data* _data35_;
	_data35_ = (Block35Data*) _userdata_;
#line 78 "../src/Zoom.vala"
	if (g_atomic_int_dec_and_test (&_data35_->_ref_count_)) {
#line 496 "Zoom.c"
		GalaZoom* self;
#line 78 "../src/Zoom.vala"
		self = _data35_->self;
#line 78 "../src/Zoom.vala"
		_g_object_unref0 (self);
#line 78 "../src/Zoom.vala"
		g_slice_free (Block35Data, _data35_);
#line 504 "Zoom.c"
	}
}

static void
__lambda92_ (Block35Data* _data35_,
             gdouble percentage)
{
	GalaZoom* self;
	gfloat zoom_level = 0.0F;
	gfloat delta = 0.0F;
	GalaWindowManager* _tmp0_;
	gboolean _tmp1_;
	gboolean _tmp2_;
#line 84 "../src/Zoom.vala"
	self = _data35_->self;
#line 85 "../src/Zoom.vala"
	zoom_level = gala_gesture_tracker_animation_value (_data35_->initial_zoom, _data35_->target_zoom, percentage, FALSE);
#line 86 "../src/Zoom.vala"
	delta = zoom_level - self->priv->current_zoom;
#line 88 "../src/Zoom.vala"
	_tmp0_ = self->priv->_wm;
#line 88 "../src/Zoom.vala"
	_tmp1_ = gala_window_manager_get_enable_animations (_tmp0_);
#line 88 "../src/Zoom.vala"
	_tmp2_ = _tmp1_;
#line 88 "../src/Zoom.vala"
	if (!_tmp2_) {
#line 89 "../src/Zoom.vala"
		if (fabsf (delta) >= GALA_ZOOM_SHORTCUT_DELTA) {
#line 534 "Zoom.c"
			gfloat _tmp3_ = 0.0F;
#line 90 "../src/Zoom.vala"
			if (delta > ((gfloat) 0)) {
#line 90 "../src/Zoom.vala"
				_tmp3_ = GALA_ZOOM_SHORTCUT_DELTA;
#line 540 "Zoom.c"
			} else {
#line 90 "../src/Zoom.vala"
				_tmp3_ = -GALA_ZOOM_SHORTCUT_DELTA;
#line 544 "Zoom.c"
			}
#line 90 "../src/Zoom.vala"
			delta = _tmp3_;
#line 548 "Zoom.c"
		} else {
#line 92 "../src/Zoom.vala"
			delta = (gfloat) 0;
#line 552 "Zoom.c"
		}
	}
#line 96 "../src/Zoom.vala"
	gala_zoom_zoom (self, delta, FALSE, FALSE);
#line 557 "Zoom.c"
}

static void
___lambda92__gala_gesture_tracker_on_update (gdouble percentage,
                                             gpointer self)
{
#line 84 "../src/Zoom.vala"
	__lambda92_ (self, percentage);
#line 566 "Zoom.c"
}

static void
gala_zoom_zoom_with_gesture (GalaZoom* self,
                             GalaGestureDirection direction)
{
	Block35Data* _data35_;
	gfloat _tmp0_ = 0.0F;
	GalaGestureTrackerOnUpdate on_animation_update = NULL;
	gpointer on_animation_update_target;
	GDestroyNotify on_animation_update_target_destroy_notify;
	GalaGestureTracker* _tmp1_;
	GalaGestureTrackerOnUpdate _tmp2_;
	gpointer _tmp2__target;
	GDestroyNotify _tmp2__target_destroy_notify;
#line 78 "../src/Zoom.vala"
	g_return_if_fail (self != NULL);
#line 78 "../src/Zoom.vala"
	_data35_ = g_slice_new0 (Block35Data);
#line 78 "../src/Zoom.vala"
	_data35_->_ref_count_ = 1;
#line 78 "../src/Zoom.vala"
	_data35_->self = g_object_ref (self);
#line 79 "../src/Zoom.vala"
	_data35_->initial_zoom = self->priv->current_zoom;
#line 80 "../src/Zoom.vala"
	if (direction == GALA_GESTURE_DIRECTION_IN) {
#line 81 "../src/Zoom.vala"
		_tmp0_ = _data35_->initial_zoom - GALA_ZOOM_MAX_ZOOM;
#line 596 "Zoom.c"
	} else {
#line 82 "../src/Zoom.vala"
		_tmp0_ = _data35_->initial_zoom + GALA_ZOOM_MAX_ZOOM;
#line 600 "Zoom.c"
	}
#line 80 "../src/Zoom.vala"
	_data35_->target_zoom = _tmp0_;
#line 84 "../src/Zoom.vala"
	on_animation_update = ___lambda92__gala_gesture_tracker_on_update;
#line 84 "../src/Zoom.vala"
	on_animation_update_target = block35_data_ref (_data35_);
#line 84 "../src/Zoom.vala"
	on_animation_update_target_destroy_notify = block35_data_unref;
#line 99 "../src/Zoom.vala"
	_tmp1_ = self->priv->gesture_tracker;
#line 99 "../src/Zoom.vala"
	_tmp2_ = on_animation_update;
#line 99 "../src/Zoom.vala"
	_tmp2__target = on_animation_update_target;
#line 99 "../src/Zoom.vala"
	_tmp2__target_destroy_notify = on_animation_update_target_destroy_notify;
#line 99 "../src/Zoom.vala"
	on_animation_update = NULL;
#line 99 "../src/Zoom.vala"
	on_animation_update_target = NULL;
#line 99 "../src/Zoom.vala"
	on_animation_update_target_destroy_notify = NULL;
#line 99 "../src/Zoom.vala"
	gala_gesture_tracker_connect_handlers (_tmp1_, NULL, NULL, NULL, _tmp2_, _tmp2__target, _tmp2__target_destroy_notify, NULL, NULL, NULL);
#line 78 "../src/Zoom.vala"
	(on_animation_update_target_destroy_notify == NULL) ? NULL : (on_animation_update_target_destroy_notify (on_animation_update_target), NULL);
#line 78 "../src/Zoom.vala"
	on_animation_update = NULL;
#line 78 "../src/Zoom.vala"
	on_animation_update_target = NULL;
#line 78 "../src/Zoom.vala"
	on_animation_update_target_destroy_notify = NULL;
#line 78 "../src/Zoom.vala"
	block35_data_unref (_data35_);
#line 78 "../src/Zoom.vala"
	_data35_ = NULL;
#line 638 "Zoom.c"
}

static inline void
gala_zoom_compute_new_pivot_point (GalaZoom* self,
                                   graphene_point_t* result)
{
	ClutterActor* wins = NULL;
	GalaWindowManager* _tmp0_;
	ClutterActor* _tmp1_;
	ClutterActor* _tmp2_;
	graphene_point_t coords = {0};
	GalaWindowManager* _tmp3_;
	MetaDisplay* _tmp4_;
	MetaCursorTracker* _tmp5_;
	graphene_point_t _tmp6_ = {0};
	graphene_point_t new_pivot = {0};
	graphene_point_t _tmp7_;
	gfloat _tmp8_;
	gfloat _tmp9_;
	graphene_point_t _tmp10_;
	gfloat _tmp11_;
	gfloat _tmp12_;
	graphene_point_t _tmp13_ = {0};
#line 102 "../src/Zoom.vala"
	g_return_if_fail (self != NULL);
#line 103 "../src/Zoom.vala"
	_tmp0_ = self->priv->_wm;
#line 103 "../src/Zoom.vala"
	_tmp1_ = gala_window_manager_get_ui_group (_tmp0_);
#line 103 "../src/Zoom.vala"
	_tmp2_ = _tmp1_;
#line 103 "../src/Zoom.vala"
	wins = _tmp2_;
#line 105 "../src/Zoom.vala"
	_tmp3_ = self->priv->_wm;
#line 105 "../src/Zoom.vala"
	_tmp4_ = meta_plugin_get_display ((MetaPlugin*) _tmp3_);
#line 105 "../src/Zoom.vala"
	_tmp5_ = meta_cursor_tracker_get_for_display (_tmp4_);
#line 105 "../src/Zoom.vala"
	meta_cursor_tracker_get_pointer (_tmp5_, &_tmp6_, NULL);
#line 105 "../src/Zoom.vala"
	coords = _tmp6_;
#line 106 "../src/Zoom.vala"
	_tmp7_ = coords;
#line 106 "../src/Zoom.vala"
	_tmp8_ = clutter_actor_get_width (wins);
#line 106 "../src/Zoom.vala"
	_tmp9_ = _tmp8_;
#line 106 "../src/Zoom.vala"
	_tmp10_ = coords;
#line 106 "../src/Zoom.vala"
	_tmp11_ = clutter_actor_get_height (wins);
#line 106 "../src/Zoom.vala"
	_tmp12_ = _tmp11_;
#line 106 "../src/Zoom.vala"
	memset (&_tmp13_, 0, sizeof (graphene_point_t));
#line 106 "../src/Zoom.vala"
	_tmp13_.x = _tmp7_.x / _tmp9_;
#line 106 "../src/Zoom.vala"
	_tmp13_.y = _tmp10_.y / _tmp12_;
#line 106 "../src/Zoom.vala"
	new_pivot = _tmp13_;
#line 111 "../src/Zoom.vala"
	*result = new_pivot;
#line 111 "../src/Zoom.vala"
	return;
#line 706 "Zoom.c"
}

static Block36Data*
block36_data_ref (Block36Data* _data36_)
{
#line 114 "../src/Zoom.vala"
	g_atomic_int_inc (&_data36_->_ref_count_);
#line 114 "../src/Zoom.vala"
	return _data36_;
#line 716 "Zoom.c"
}

static void
block36_data_unref (void * _userdata_)
{
	Block36Data* _data36_;
	_data36_ = (Block36Data*) _userdata_;
#line 114 "../src/Zoom.vala"
	if (g_atomic_int_dec_and_test (&_data36_->_ref_count_)) {
#line 726 "Zoom.c"
		GalaZoom* self;
#line 114 "../src/Zoom.vala"
		self = _data36_->self;
#line 114 "../src/Zoom.vala"
		_g_object_unref0 (self);
#line 114 "../src/Zoom.vala"
		g_slice_free (Block36Data, _data36_);
#line 734 "Zoom.c"
	}
}

static void
_vala_graphene_point_t_free (graphene_point_t* self)
{
#line 131 "../src/Zoom.vala"
	g_boxed_free (graphene_point_get_type (), self);
#line 743 "Zoom.c"
}

static gboolean
___lambda90_ (Block36Data* _data36_)
{
	GalaZoom* self;
	graphene_point_t new_pivot = {0};
	graphene_point_t _tmp0_ = {0};
	ClutterActor* _tmp1_;
	graphene_point_t* _tmp2_;
	graphene_point_t* _tmp3_;
	graphene_point_t* _tmp4_;
	graphene_point_t _tmp5_;
	gboolean _tmp6_;
	ClutterActor* _tmp7_;
	ClutterActor* _tmp8_;
	ClutterActor* _tmp9_;
	ClutterActor* _tmp10_;
	graphene_point_t _tmp11_;
	ClutterActor* _tmp12_;
	gboolean result;
#line 129 "../src/Zoom.vala"
	self = _data36_->self;
#line 130 "../src/Zoom.vala"
	gala_zoom_compute_new_pivot_point (self, &_tmp0_);
#line 130 "../src/Zoom.vala"
	new_pivot = _tmp0_;
#line 131 "../src/Zoom.vala"
	_tmp1_ = _data36_->wins;
#line 131 "../src/Zoom.vala"
	g_object_get (_tmp1_, "pivot-point", &_tmp2_, NULL);
#line 131 "../src/Zoom.vala"
	_tmp3_ = _tmp2_;
#line 131 "../src/Zoom.vala"
	_tmp4_ = _tmp3_;
#line 131 "../src/Zoom.vala"
	_tmp5_ = new_pivot;
#line 131 "../src/Zoom.vala"
	_tmp6_ = graphene_point_equal (_tmp4_, &_tmp5_);
#line 131 "../src/Zoom.vala"
	__vala_graphene_point_t_free0 (_tmp4_);
#line 131 "../src/Zoom.vala"
	if (_tmp6_) {
#line 132 "../src/Zoom.vala"
		result = TRUE;
#line 132 "../src/Zoom.vala"
		return result;
#line 791 "Zoom.c"
	}
#line 135 "../src/Zoom.vala"
	_tmp7_ = _data36_->wins;
#line 135 "../src/Zoom.vala"
	clutter_actor_save_easing_state (_tmp7_);
#line 136 "../src/Zoom.vala"
	_tmp8_ = _data36_->wins;
#line 136 "../src/Zoom.vala"
	clutter_actor_set_easing_mode (_tmp8_, CLUTTER_LINEAR);
#line 137 "../src/Zoom.vala"
	_tmp9_ = _data36_->wins;
#line 137 "../src/Zoom.vala"
	clutter_actor_set_easing_duration (_tmp9_, GALA_ZOOM_MOUSE_POLL_TIME);
#line 138 "../src/Zoom.vala"
	_tmp10_ = _data36_->wins;
#line 138 "../src/Zoom.vala"
	_tmp11_ = new_pivot;
#line 138 "../src/Zoom.vala"
	g_object_set (_tmp10_, "pivot-point", &_tmp11_, NULL);
#line 139 "../src/Zoom.vala"
	_tmp12_ = _data36_->wins;
#line 139 "../src/Zoom.vala"
	clutter_actor_restore_easing_state (_tmp12_);
#line 140 "../src/Zoom.vala"
	result = TRUE;
#line 140 "../src/Zoom.vala"
	return result;
#line 819 "Zoom.c"
}

static gboolean
____lambda90__gsource_func (gpointer self)
{
	gboolean result;
	result = ___lambda90_ (self);
#line 129 "../src/Zoom.vala"
	return result;
#line 829 "Zoom.c"
}

static void
____lambda91_ (Block36Data* _data36_)
{
	GalaZoom* self;
	ClutterActor* _tmp0_;
	ClutterActor* _tmp1_;
#line 167 "../src/Zoom.vala"
	self = _data36_->self;
#line 168 "../src/Zoom.vala"
	_tmp0_ = _data36_->wins;
#line 168 "../src/Zoom.vala"
	g_signal_handler_disconnect ((GObject*) _tmp0_, self->priv->wins_handler_id);
#line 169 "../src/Zoom.vala"
	self->priv->wins_handler_id = (gulong) 0;
#line 170 "../src/Zoom.vala"
	_tmp1_ = _data36_->wins;
#line 170 "../src/Zoom.vala"
	clutter_actor_set_pivot_point (_tmp1_, 0.0f, 0.0f);
#line 850 "Zoom.c"
}

static void
_____lambda91__clutter_actor_transitions_completed (ClutterActor* _sender,
                                                    gpointer self)
{
#line 167 "../src/Zoom.vala"
	____lambda91_ (self);
#line 859 "Zoom.c"
}

static void
gala_zoom_zoom (GalaZoom* self,
                gfloat delta,
                gboolean play_sound,
                gboolean animate)
{
	Block36Data* _data36_;
	gboolean _tmp0_ = FALSE;
	gboolean _tmp1_ = FALSE;
	GalaWindowManager* _tmp3_;
	ClutterActor* _tmp4_;
	ClutterActor* _tmp5_;
	gint _tmp8_ = 0;
	gint animation_duration = 0;
	ClutterActor* _tmp18_;
	ClutterActor* _tmp19_;
	ClutterActor* _tmp20_;
	ClutterActor* _tmp21_;
	ClutterActor* _tmp22_;
#line 114 "../src/Zoom.vala"
	g_return_if_fail (self != NULL);
#line 114 "../src/Zoom.vala"
	_data36_ = g_slice_new0 (Block36Data);
#line 114 "../src/Zoom.vala"
	_data36_->_ref_count_ = 1;
#line 114 "../src/Zoom.vala"
	_data36_->self = g_object_ref (self);
#line 116 "../src/Zoom.vala"
	if (self->priv->current_zoom <= GALA_ZOOM_MIN_ZOOM) {
#line 116 "../src/Zoom.vala"
		_tmp1_ = delta < ((gfloat) 0);
#line 893 "Zoom.c"
	} else {
#line 116 "../src/Zoom.vala"
		_tmp1_ = FALSE;
#line 897 "Zoom.c"
	}
#line 116 "../src/Zoom.vala"
	if (_tmp1_) {
#line 116 "../src/Zoom.vala"
		_tmp0_ = TRUE;
#line 903 "Zoom.c"
	} else {
		gboolean _tmp2_ = FALSE;
#line 116 "../src/Zoom.vala"
		if (self->priv->current_zoom >= GALA_ZOOM_MAX_ZOOM) {
#line 116 "../src/Zoom.vala"
			_tmp2_ = delta >= ((gfloat) 0);
#line 910 "Zoom.c"
		} else {
#line 116 "../src/Zoom.vala"
			_tmp2_ = FALSE;
#line 914 "Zoom.c"
		}
#line 116 "../src/Zoom.vala"
		_tmp0_ = _tmp2_;
#line 918 "Zoom.c"
	}
#line 116 "../src/Zoom.vala"
	if (_tmp0_) {
#line 117 "../src/Zoom.vala"
		if (play_sound) {
#line 118 "../src/Zoom.vala"
			gdk_beep ();
#line 926 "Zoom.c"
		}
#line 120 "../src/Zoom.vala"
		block36_data_unref (_data36_);
#line 120 "../src/Zoom.vala"
		_data36_ = NULL;
#line 120 "../src/Zoom.vala"
		return;
#line 934 "Zoom.c"
	}
#line 123 "../src/Zoom.vala"
	_tmp3_ = self->priv->_wm;
#line 123 "../src/Zoom.vala"
	_tmp4_ = gala_window_manager_get_ui_group (_tmp3_);
#line 123 "../src/Zoom.vala"
	_tmp5_ = _tmp4_;
#line 123 "../src/Zoom.vala"
	_data36_->wins = _tmp5_;
#line 126 "../src/Zoom.vala"
	if (self->priv->mouse_poll_timer == ((guint) 0)) {
#line 946 "Zoom.c"
		ClutterActor* _tmp6_;
		graphene_point_t _tmp7_ = {0};
#line 127 "../src/Zoom.vala"
		_tmp6_ = _data36_->wins;
#line 127 "../src/Zoom.vala"
		gala_zoom_compute_new_pivot_point (self, &_tmp7_);
#line 127 "../src/Zoom.vala"
		g_object_set (_tmp6_, "pivot-point", &_tmp7_, NULL);
#line 129 "../src/Zoom.vala"
		self->priv->mouse_poll_timer = g_timeout_add_full (G_PRIORITY_DEFAULT, GALA_ZOOM_MOUSE_POLL_TIME, ____lambda90__gsource_func, block36_data_ref (_data36_), block36_data_unref);
#line 957 "Zoom.c"
	}
#line 144 "../src/Zoom.vala"
	self->priv->current_zoom = self->priv->current_zoom + delta;
#line 145 "../src/Zoom.vala"
	if (animate) {
#line 145 "../src/Zoom.vala"
		_tmp8_ = GALA_ZOOM_ANIMATION_DURATION;
#line 965 "Zoom.c"
	} else {
#line 145 "../src/Zoom.vala"
		_tmp8_ = 0;
#line 969 "Zoom.c"
	}
#line 145 "../src/Zoom.vala"
	animation_duration = _tmp8_;
#line 147 "../src/Zoom.vala"
	if (self->priv->wins_handler_id > ((gulong) 0)) {
#line 975 "Zoom.c"
		ClutterActor* _tmp9_;
#line 148 "../src/Zoom.vala"
		_tmp9_ = _data36_->wins;
#line 148 "../src/Zoom.vala"
		g_signal_handler_disconnect ((GObject*) _tmp9_, self->priv->wins_handler_id);
#line 149 "../src/Zoom.vala"
		self->priv->wins_handler_id = (gulong) 0;
#line 983 "Zoom.c"
	}
#line 152 "../src/Zoom.vala"
	if (self->priv->current_zoom <= GALA_ZOOM_MIN_ZOOM) {
#line 987 "Zoom.c"
		ClutterActor* _tmp10_;
		ClutterActor* _tmp11_;
		ClutterActor* _tmp12_;
		ClutterActor* _tmp13_;
		ClutterActor* _tmp14_;
#line 153 "../src/Zoom.vala"
		self->priv->current_zoom = GALA_ZOOM_MIN_ZOOM;
#line 155 "../src/Zoom.vala"
		if (self->priv->mouse_poll_timer > ((guint) 0)) {
#line 156 "../src/Zoom.vala"
			g_source_remove (self->priv->mouse_poll_timer);
#line 157 "../src/Zoom.vala"
			self->priv->mouse_poll_timer = (guint) 0;
#line 1001 "Zoom.c"
		}
#line 160 "../src/Zoom.vala"
		_tmp10_ = _data36_->wins;
#line 160 "../src/Zoom.vala"
		clutter_actor_save_easing_state (_tmp10_);
#line 161 "../src/Zoom.vala"
		_tmp11_ = _data36_->wins;
#line 161 "../src/Zoom.vala"
		clutter_actor_set_easing_mode (_tmp11_, CLUTTER_EASE_OUT_CUBIC);
#line 162 "../src/Zoom.vala"
		_tmp12_ = _data36_->wins;
#line 162 "../src/Zoom.vala"
		clutter_actor_set_easing_duration (_tmp12_, (guint) animation_duration);
#line 163 "../src/Zoom.vala"
		_tmp13_ = _data36_->wins;
#line 163 "../src/Zoom.vala"
		clutter_actor_set_scale (_tmp13_, (gdouble) GALA_ZOOM_MIN_ZOOM, (gdouble) GALA_ZOOM_MIN_ZOOM);
#line 164 "../src/Zoom.vala"
		_tmp14_ = _data36_->wins;
#line 164 "../src/Zoom.vala"
		clutter_actor_restore_easing_state (_tmp14_);
#line 166 "../src/Zoom.vala"
		if (animate) {
#line 1025 "Zoom.c"
			ClutterActor* _tmp15_;
			gulong _tmp16_;
#line 167 "../src/Zoom.vala"
			_tmp15_ = _data36_->wins;
#line 167 "../src/Zoom.vala"
			_tmp16_ = g_signal_connect_data (_tmp15_, "transitions-completed", (GCallback) _____lambda91__clutter_actor_transitions_completed, block36_data_ref (_data36_), (GClosureNotify) block36_data_unref, 0);
#line 167 "../src/Zoom.vala"
			self->priv->wins_handler_id = _tmp16_;
#line 1034 "Zoom.c"
		} else {
			ClutterActor* _tmp17_;
#line 173 "../src/Zoom.vala"
			_tmp17_ = _data36_->wins;
#line 173 "../src/Zoom.vala"
			clutter_actor_set_pivot_point (_tmp17_, 0.0f, 0.0f);
#line 1041 "Zoom.c"
		}
#line 176 "../src/Zoom.vala"
		block36_data_unref (_data36_);
#line 176 "../src/Zoom.vala"
		_data36_ = NULL;
#line 176 "../src/Zoom.vala"
		return;
#line 1049 "Zoom.c"
	}
#line 179 "../src/Zoom.vala"
	_tmp18_ = _data36_->wins;
#line 179 "../src/Zoom.vala"
	clutter_actor_save_easing_state (_tmp18_);
#line 180 "../src/Zoom.vala"
	_tmp19_ = _data36_->wins;
#line 180 "../src/Zoom.vala"
	clutter_actor_set_easing_mode (_tmp19_, CLUTTER_EASE_OUT_CUBIC);
#line 181 "../src/Zoom.vala"
	_tmp20_ = _data36_->wins;
#line 181 "../src/Zoom.vala"
	clutter_actor_set_easing_duration (_tmp20_, (guint) animation_duration);
#line 182 "../src/Zoom.vala"
	_tmp21_ = _data36_->wins;
#line 182 "../src/Zoom.vala"
	clutter_actor_set_scale (_tmp21_, (gdouble) self->priv->current_zoom, (gdouble) self->priv->current_zoom);
#line 183 "../src/Zoom.vala"
	_tmp22_ = _data36_->wins;
#line 183 "../src/Zoom.vala"
	clutter_actor_restore_easing_state (_tmp22_);
#line 114 "../src/Zoom.vala"
	block36_data_unref (_data36_);
#line 114 "../src/Zoom.vala"
	_data36_ = NULL;
#line 1075 "Zoom.c"
}

GalaWindowManager*
gala_zoom_get_wm (GalaZoom* self)
{
	GalaWindowManager* result;
	GalaWindowManager* _tmp0_;
#line 15 "../src/Zoom.vala"
	g_return_val_if_fail (self != NULL, NULL);
#line 15 "../src/Zoom.vala"
	_tmp0_ = self->priv->_wm;
#line 15 "../src/Zoom.vala"
	result = _tmp0_;
#line 15 "../src/Zoom.vala"
	return result;
#line 1091 "Zoom.c"
}

static gpointer
_g_object_ref0 (gpointer self)
{
#line 15 "../src/Zoom.vala"
	return self ? g_object_ref (self) : NULL;
#line 1099 "Zoom.c"
}

static void
gala_zoom_set_wm (GalaZoom* self,
                  GalaWindowManager* value)
{
	GalaWindowManager* old_value;
#line 15 "../src/Zoom.vala"
	g_return_if_fail (self != NULL);
#line 15 "../src/Zoom.vala"
	old_value = gala_zoom_get_wm (self);
#line 15 "../src/Zoom.vala"
	if (old_value != value) {
#line 1113 "Zoom.c"
		GalaWindowManager* _tmp0_;
#line 15 "../src/Zoom.vala"
		_tmp0_ = _g_object_ref0 (value);
#line 15 "../src/Zoom.vala"
		_g_object_unref0 (self->priv->_wm);
#line 15 "../src/Zoom.vala"
		self->priv->_wm = _tmp0_;
#line 15 "../src/Zoom.vala"
		g_object_notify_by_pspec ((GObject *) self, gala_zoom_properties[GALA_ZOOM_WM_PROPERTY]);
#line 1123 "Zoom.c"
	}
}

static void
gala_zoom_class_init (GalaZoomClass * klass,
                      gpointer klass_data)
{
#line 8 "../src/Zoom.vala"
	gala_zoom_parent_class = g_type_class_peek_parent (klass);
#line 8 "../src/Zoom.vala"
	g_type_class_adjust_private_offset (klass, &GalaZoom_private_offset);
#line 8 "../src/Zoom.vala"
	G_OBJECT_CLASS (klass)->get_property = _vala_gala_zoom_get_property;
#line 8 "../src/Zoom.vala"
	G_OBJECT_CLASS (klass)->set_property = _vala_gala_zoom_set_property;
#line 8 "../src/Zoom.vala"
	G_OBJECT_CLASS (klass)->finalize = gala_zoom_finalize;
#line 8 "../src/Zoom.vala"
	g_object_class_install_property (G_OBJECT_CLASS (klass), GALA_ZOOM_WM_PROPERTY, gala_zoom_properties[GALA_ZOOM_WM_PROPERTY] = g_param_spec_object ("wm", "wm", "wm", GALA_TYPE_WINDOW_MANAGER, G_PARAM_STATIC_STRINGS | G_PARAM_READABLE | G_PARAM_WRITABLE | G_PARAM_CONSTRUCT_ONLY));
#line 1143 "Zoom.c"
}

static void
gala_zoom_instance_init (GalaZoom * self,
                         gpointer klass)
{
#line 8 "../src/Zoom.vala"
	self->priv = gala_zoom_get_instance_private (self);
#line 17 "../src/Zoom.vala"
	self->priv->mouse_poll_timer = (guint) 0;
#line 18 "../src/Zoom.vala"
	self->priv->current_zoom = GALA_ZOOM_MIN_ZOOM;
#line 19 "../src/Zoom.vala"
	self->priv->wins_handler_id = 0UL;
#line 1158 "Zoom.c"
}

static void
gala_zoom_finalize (GObject * obj)
{
	GalaZoom * self;
	GalaWindowManager* _tmp0_;
	MetaDisplay* display = NULL;
	GalaWindowManager* _tmp1_;
	MetaDisplay* _tmp2_;
	MetaDisplay* _tmp3_;
	MetaDisplay* _tmp4_;
#line 8 "../src/Zoom.vala"
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, GALA_TYPE_ZOOM, GalaZoom);
#line 38 "../src/Zoom.vala"
	_tmp0_ = self->priv->_wm;
#line 38 "../src/Zoom.vala"
	if (_tmp0_ == NULL) {
#line 1177 "Zoom.c"
		goto _return;
	}
#line 42 "../src/Zoom.vala"
	_tmp1_ = self->priv->_wm;
#line 42 "../src/Zoom.vala"
	_tmp2_ = meta_plugin_get_display ((MetaPlugin*) _tmp1_);
#line 42 "../src/Zoom.vala"
	display = _tmp2_;
#line 43 "../src/Zoom.vala"
	_tmp3_ = display;
#line 43 "../src/Zoom.vala"
	meta_display_remove_keybinding (_tmp3_, "zoom-in");
#line 44 "../src/Zoom.vala"
	_tmp4_ = display;
#line 44 "../src/Zoom.vala"
	meta_display_remove_keybinding (_tmp4_, "zoom-out");
#line 46 "../src/Zoom.vala"
	if (self->priv->mouse_poll_timer > ((guint) 0)) {
#line 47 "../src/Zoom.vala"
		g_source_remove (self->priv->mouse_poll_timer);
#line 48 "../src/Zoom.vala"
		self->priv->mouse_poll_timer = (guint) 0;
#line 1200 "Zoom.c"
	}
	_return:
#line 15 "../src/Zoom.vala"
	_g_object_unref0 (self->priv->_wm);
#line 21 "../src/Zoom.vala"
	_g_object_unref0 (self->priv->gesture_tracker);
#line 8 "../src/Zoom.vala"
	G_OBJECT_CLASS (gala_zoom_parent_class)->finalize (obj);
#line 1209 "Zoom.c"
}

 G_GNUC_NO_INLINE static GType
gala_zoom_get_type_once (void)
{
	static const GTypeInfo g_define_type_info = { sizeof (GalaZoomClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) gala_zoom_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (GalaZoom), 0, (GInstanceInitFunc) gala_zoom_instance_init, NULL };
	GType gala_zoom_type_id;
	gala_zoom_type_id = g_type_register_static (G_TYPE_OBJECT, "GalaZoom", &g_define_type_info, 0);
	GalaZoom_private_offset = g_type_add_instance_private (gala_zoom_type_id, sizeof (GalaZoomPrivate));
	return gala_zoom_type_id;
}

GType
gala_zoom_get_type (void)
{
	static gsize gala_zoom_type_id__once = 0;
	if (g_once_init_enter (&gala_zoom_type_id__once)) {
		GType gala_zoom_type_id;
		gala_zoom_type_id = gala_zoom_get_type_once ();
		g_once_init_leave (&gala_zoom_type_id__once, gala_zoom_type_id);
	}
	return gala_zoom_type_id__once;
}

static void
_vala_gala_zoom_get_property (GObject * object,
                              guint property_id,
                              GValue * value,
                              GParamSpec * pspec)
{
	GalaZoom * self;
	self = G_TYPE_CHECK_INSTANCE_CAST (object, GALA_TYPE_ZOOM, GalaZoom);
#line 8 "../src/Zoom.vala"
	switch (property_id) {
#line 8 "../src/Zoom.vala"
		case GALA_ZOOM_WM_PROPERTY:
#line 8 "../src/Zoom.vala"
		g_value_set_object (value, gala_zoom_get_wm (self));
#line 8 "../src/Zoom.vala"
		break;
#line 1250 "Zoom.c"
		default:
#line 8 "../src/Zoom.vala"
		G_OBJECT_WARN_INVALID_PROPERTY_ID (object, property_id, pspec);
#line 8 "../src/Zoom.vala"
		break;
#line 1256 "Zoom.c"
	}
}

static void
_vala_gala_zoom_set_property (GObject * object,
                              guint property_id,
                              const GValue * value,
                              GParamSpec * pspec)
{
	GalaZoom * self;
	self = G_TYPE_CHECK_INSTANCE_CAST (object, GALA_TYPE_ZOOM, GalaZoom);
#line 8 "../src/Zoom.vala"
	switch (property_id) {
#line 8 "../src/Zoom.vala"
		case GALA_ZOOM_WM_PROPERTY:
#line 8 "../src/Zoom.vala"
		gala_zoom_set_wm (self, g_value_get_object (value));
#line 8 "../src/Zoom.vala"
		break;
#line 1276 "Zoom.c"
		default:
#line 8 "../src/Zoom.vala"
		G_OBJECT_WARN_INVALID_PROPERTY_ID (object, property_id, pspec);
#line 8 "../src/Zoom.vala"
		break;
#line 1282 "Zoom.c"
	}
}

