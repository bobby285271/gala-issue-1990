/* Main.c generated by valac 0.56.17, the Vala compiler
 * generated from Main.vala, do not modify */

/*
 * Copyright 2024 elementary, Inc. (https://elementary.io)
 * SPDX-License-Identifier: GPL-3.0-or-later
 */

#include <gtk/gtk.h>
#include <glib-object.h>
#include <gio/gio.h>
#include <stdlib.h>
#include <string.h>
#include <glib.h>
#include <granite.h>
#include <gdk/gdk.h>
#include <locale.h>
#include <glib/gi18n-lib.h>
#include "config.h"

#if !defined(VALA_STRICT_C)
#if !defined(__clang__) && defined(__GNUC__) && (__GNUC__ >= 14)
#pragma GCC diagnostic warning "-Wincompatible-pointer-types"
#elif defined(__clang__) && (__clang_major__ >= 16)
#pragma clang diagnostic ignored "-Wincompatible-function-pointer-types"
#pragma clang diagnostic ignored "-Wincompatible-pointer-types"
#endif
#endif
#if !defined(VALA_EXTERN)
#if defined(_MSC_VER)
#define VALA_EXTERN __declspec(dllexport) extern
#elif __GNUC__ >= 4
#define VALA_EXTERN __attribute__((visibility("default"))) extern
#else
#define VALA_EXTERN extern
#endif
#endif

#define GALA_DAEMON_TYPE_APPLICATION (gala_daemon_application_get_type ())
#define GALA_DAEMON_APPLICATION(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), GALA_DAEMON_TYPE_APPLICATION, GalaDaemonApplication))
#define GALA_DAEMON_APPLICATION_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), GALA_DAEMON_TYPE_APPLICATION, GalaDaemonApplicationClass))
#define GALA_DAEMON_IS_APPLICATION(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), GALA_DAEMON_TYPE_APPLICATION))
#define GALA_DAEMON_IS_APPLICATION_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), GALA_DAEMON_TYPE_APPLICATION))
#define GALA_DAEMON_APPLICATION_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), GALA_DAEMON_TYPE_APPLICATION, GalaDaemonApplicationClass))

typedef struct _GalaDaemonApplication GalaDaemonApplication;
typedef struct _GalaDaemonApplicationClass GalaDaemonApplicationClass;
typedef struct _GalaDaemonApplicationPrivate GalaDaemonApplicationPrivate;
enum  {
	GALA_DAEMON_APPLICATION_0_PROPERTY,
	GALA_DAEMON_APPLICATION_NUM_PROPERTIES
};
static GParamSpec* gala_daemon_application_properties[GALA_DAEMON_APPLICATION_NUM_PROPERTIES];
typedef struct _Block1Data Block1Data;
#define _g_object_unref0(var) ((var == NULL) ? NULL : (var = (g_object_unref (var), NULL)))

#define GALA_DAEMON_TYPE_DBUS (gala_daemon_dbus_get_type ())
#define GALA_DAEMON_DBUS(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), GALA_DAEMON_TYPE_DBUS, GalaDaemonDBus))
#define GALA_DAEMON_DBUS_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), GALA_DAEMON_TYPE_DBUS, GalaDaemonDBusClass))
#define GALA_DAEMON_IS_DBUS(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), GALA_DAEMON_TYPE_DBUS))
#define GALA_DAEMON_IS_DBUS_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), GALA_DAEMON_TYPE_DBUS))
#define GALA_DAEMON_DBUS_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), GALA_DAEMON_TYPE_DBUS, GalaDaemonDBusClass))

typedef struct _GalaDaemonDBus GalaDaemonDBus;
typedef struct _GalaDaemonDBusClass GalaDaemonDBusClass;

struct _GalaDaemonApplication {
	GtkApplication parent_instance;
	GalaDaemonApplicationPrivate * priv;
};

struct _GalaDaemonApplicationClass {
	GtkApplicationClass parent_class;
};

struct _Block1Data {
	int _ref_count_;
	GalaDaemonApplication* self;
	GraniteSettings* granite_settings;
	GtkSettings* gtk_settings;
};

static gpointer gala_daemon_application_parent_class = NULL;

VALA_EXTERN GType gala_daemon_application_get_type (void) G_GNUC_CONST ;
G_DEFINE_AUTOPTR_CLEANUP_FUNC (GalaDaemonApplication, g_object_unref)
VALA_EXTERN GalaDaemonApplication* gala_daemon_application_new (void);
VALA_EXTERN GalaDaemonApplication* gala_daemon_application_construct (GType object_type);
static void gala_daemon_application_real_startup (GApplication* base);
static Block1Data* block1_data_ref (Block1Data* _data1_);
static void block1_data_unref (void * _userdata_);
static void __lambda4_ (Block1Data* _data1_);
static void ___lambda4__g_object_notify (GObject* _sender,
                                  GParamSpec* pspec,
                                  gpointer self);
static void gala_daemon_application_real_activate (GApplication* base);
static gboolean gala_daemon_application_real_dbus_register (GApplication* base,
                                                     GDBusConnection* connection,
                                                     const gchar* object_path,
                                                     GError** error);
VALA_EXTERN GalaDaemonDBus* gala_daemon_dbus_new (void);
VALA_EXTERN GalaDaemonDBus* gala_daemon_dbus_construct (GType object_type);
VALA_EXTERN GType gala_daemon_dbus_get_type (void) G_GNUC_CONST ;
G_DEFINE_AUTOPTR_CLEANUP_FUNC (GalaDaemonDBus, g_object_unref)
VALA_EXTERN guint gala_daemon_dbus_register_object (void* object,
                                        GDBusConnection* connection,
                                        const gchar* path,
                                        GError** error);
static GType gala_daemon_application_get_type_once (void);
static gint _vala_main (gchar** args,
                 gint args_length1);

GalaDaemonApplication*
gala_daemon_application_construct (GType object_type)
{
	GalaDaemonApplication * self = NULL;
#line 8 "../daemon-gtk3/Main.vala"
	self = (GalaDaemonApplication*) g_object_new (object_type, "application-id", "org.pantheon.gala.daemon", NULL);
#line 7 "../daemon-gtk3/Main.vala"
	return self;
#line 122 "Main.c"
}

GalaDaemonApplication*
gala_daemon_application_new (void)
{
#line 7 "../daemon-gtk3/Main.vala"
	return gala_daemon_application_construct (GALA_DAEMON_TYPE_APPLICATION);
#line 130 "Main.c"
}

static Block1Data*
block1_data_ref (Block1Data* _data1_)
{
#line 11 "../daemon-gtk3/Main.vala"
	g_atomic_int_inc (&_data1_->_ref_count_);
#line 11 "../daemon-gtk3/Main.vala"
	return _data1_;
#line 140 "Main.c"
}

static void
block1_data_unref (void * _userdata_)
{
	Block1Data* _data1_;
	_data1_ = (Block1Data*) _userdata_;
#line 11 "../daemon-gtk3/Main.vala"
	if (g_atomic_int_dec_and_test (&_data1_->_ref_count_)) {
#line 150 "Main.c"
		GalaDaemonApplication* self;
#line 11 "../daemon-gtk3/Main.vala"
		self = _data1_->self;
#line 11 "../daemon-gtk3/Main.vala"
		_g_object_unref0 (_data1_->gtk_settings);
#line 11 "../daemon-gtk3/Main.vala"
		_g_object_unref0 (_data1_->granite_settings);
#line 11 "../daemon-gtk3/Main.vala"
		_g_object_unref0 (self);
#line 11 "../daemon-gtk3/Main.vala"
		g_slice_free (Block1Data, _data1_);
#line 162 "Main.c"
	}
}

static gpointer
_g_object_ref0 (gpointer self)
{
#line 14 "../daemon-gtk3/Main.vala"
	return self ? g_object_ref (self) : NULL;
#line 171 "Main.c"
}

static void
__lambda4_ (Block1Data* _data1_)
{
	GalaDaemonApplication* self;
	GraniteSettingsColorScheme _tmp0_;
	GraniteSettingsColorScheme _tmp1_;
#line 19 "../daemon-gtk3/Main.vala"
	self = _data1_->self;
#line 20 "../daemon-gtk3/Main.vala"
	_tmp0_ = granite_settings_get_prefers_color_scheme (_data1_->granite_settings);
#line 20 "../daemon-gtk3/Main.vala"
	_tmp1_ = _tmp0_;
#line 20 "../daemon-gtk3/Main.vala"
	g_object_set (_data1_->gtk_settings, "gtk-application-prefer-dark-theme", _tmp1_ == GRANITE_SETTINGS_COLOR_SCHEME_DARK, NULL);
#line 188 "Main.c"
}

static void
___lambda4__g_object_notify (GObject* _sender,
                             GParamSpec* pspec,
                             gpointer self)
{
#line 19 "../daemon-gtk3/Main.vala"
	__lambda4_ (self);
#line 198 "Main.c"
}

static void
gala_daemon_application_real_startup (GApplication* base)
{
	GalaDaemonApplication * self;
	Block1Data* _data1_;
	GraniteSettings* _tmp0_;
	GraniteSettings* _tmp1_;
	GtkSettings* _tmp2_;
	GtkSettings* _tmp3_;
	GraniteSettingsColorScheme _tmp4_;
	GraniteSettingsColorScheme _tmp5_;
	GtkCssProvider* app_provider = NULL;
	GtkCssProvider* _tmp6_;
	GdkScreen* _tmp7_;
#line 11 "../daemon-gtk3/Main.vala"
	self = (GalaDaemonApplication*) base;
#line 11 "../daemon-gtk3/Main.vala"
	_data1_ = g_slice_new0 (Block1Data);
#line 11 "../daemon-gtk3/Main.vala"
	_data1_->_ref_count_ = 1;
#line 11 "../daemon-gtk3/Main.vala"
	_data1_->self = g_object_ref (self);
#line 12 "../daemon-gtk3/Main.vala"
	G_APPLICATION_CLASS (gala_daemon_application_parent_class)->startup ((GApplication*) G_TYPE_CHECK_INSTANCE_CAST (self, gtk_application_get_type (), GtkApplication));
#line 14 "../daemon-gtk3/Main.vala"
	_tmp0_ = granite_settings_get_default ();
#line 14 "../daemon-gtk3/Main.vala"
	_tmp1_ = _g_object_ref0 (_tmp0_);
#line 14 "../daemon-gtk3/Main.vala"
	_data1_->granite_settings = _tmp1_;
#line 15 "../daemon-gtk3/Main.vala"
	_tmp2_ = gtk_settings_get_default ();
#line 15 "../daemon-gtk3/Main.vala"
	_tmp3_ = _g_object_ref0 (_tmp2_);
#line 15 "../daemon-gtk3/Main.vala"
	_data1_->gtk_settings = _tmp3_;
#line 17 "../daemon-gtk3/Main.vala"
	_tmp4_ = granite_settings_get_prefers_color_scheme (_data1_->granite_settings);
#line 17 "../daemon-gtk3/Main.vala"
	_tmp5_ = _tmp4_;
#line 17 "../daemon-gtk3/Main.vala"
	g_object_set (_data1_->gtk_settings, "gtk-application-prefer-dark-theme", _tmp5_ == GRANITE_SETTINGS_COLOR_SCHEME_DARK, NULL);
#line 19 "../daemon-gtk3/Main.vala"
	g_signal_connect_data ((GObject*) _data1_->granite_settings, "notify::prefers-color-scheme", (GCallback) ___lambda4__g_object_notify, block1_data_ref (_data1_), (GClosureNotify) block1_data_unref, 0);
#line 23 "../daemon-gtk3/Main.vala"
	_tmp6_ = gtk_css_provider_new ();
#line 23 "../daemon-gtk3/Main.vala"
	app_provider = _tmp6_;
#line 24 "../daemon-gtk3/Main.vala"
	gtk_css_provider_load_from_resource (app_provider, "io/elementary/desktop/gala-daemon/gala-daemon.css");
#line 25 "../daemon-gtk3/Main.vala"
	_tmp7_ = gdk_screen_get_default ();
#line 25 "../daemon-gtk3/Main.vala"
	gtk_style_context_add_provider_for_screen (_tmp7_, (GtkStyleProvider*) app_provider, (guint) GTK_STYLE_PROVIDER_PRIORITY_APPLICATION);
#line 11 "../daemon-gtk3/Main.vala"
	_g_object_unref0 (app_provider);
#line 11 "../daemon-gtk3/Main.vala"
	block1_data_unref (_data1_);
#line 11 "../daemon-gtk3/Main.vala"
	_data1_ = NULL;
#line 261 "Main.c"
}

static void
gala_daemon_application_real_activate (GApplication* base)
{
	GalaDaemonApplication * self;
#line 28 "../daemon-gtk3/Main.vala"
	self = (GalaDaemonApplication*) base;
#line 29 "../daemon-gtk3/Main.vala"
	g_application_hold ((GApplication*) self);
#line 272 "Main.c"
}

static gboolean
gala_daemon_application_real_dbus_register (GApplication* base,
                                            GDBusConnection* connection,
                                            const gchar* object_path,
                                            GError** error)
{
	GalaDaemonApplication * self;
	GalaDaemonDBus* _tmp1_;
	GalaDaemonDBus* _tmp2_;
	GError* _inner_error0_ = NULL;
	gboolean result;
#line 32 "../daemon-gtk3/Main.vala"
	self = (GalaDaemonApplication*) base;
#line 32 "../daemon-gtk3/Main.vala"
	g_return_val_if_fail (connection != NULL, FALSE);
#line 32 "../daemon-gtk3/Main.vala"
	g_return_val_if_fail (object_path != NULL, FALSE);
#line 33 "../daemon-gtk3/Main.vala"
	G_APPLICATION_CLASS (gala_daemon_application_parent_class)->dbus_register ((GApplication*) G_TYPE_CHECK_INSTANCE_CAST (self, gtk_application_get_type (), GtkApplication), connection, object_path, &_inner_error0_);
#line 33 "../daemon-gtk3/Main.vala"
	if (G_UNLIKELY (_inner_error0_ != NULL)) {
#line 296 "Main.c"
		gboolean _tmp0_ = FALSE;
#line 33 "../daemon-gtk3/Main.vala"
		g_propagate_error (error, _inner_error0_);
#line 33 "../daemon-gtk3/Main.vala"
		return _tmp0_;
#line 302 "Main.c"
	}
#line 35 "../daemon-gtk3/Main.vala"
	_tmp1_ = gala_daemon_dbus_new ();
#line 35 "../daemon-gtk3/Main.vala"
	_tmp2_ = _tmp1_;
#line 35 "../daemon-gtk3/Main.vala"
	gala_daemon_dbus_register_object (_tmp2_, connection, object_path, &_inner_error0_);
#line 35 "../daemon-gtk3/Main.vala"
	_g_object_unref0 (_tmp2_);
#line 35 "../daemon-gtk3/Main.vala"
	if (G_UNLIKELY (_inner_error0_ != NULL)) {
#line 314 "Main.c"
		gboolean _tmp3_ = FALSE;
#line 35 "../daemon-gtk3/Main.vala"
		g_propagate_error (error, _inner_error0_);
#line 35 "../daemon-gtk3/Main.vala"
		return _tmp3_;
#line 320 "Main.c"
	}
#line 37 "../daemon-gtk3/Main.vala"
	result = TRUE;
#line 37 "../daemon-gtk3/Main.vala"
	return result;
#line 326 "Main.c"
}

static void
gala_daemon_application_class_init (GalaDaemonApplicationClass * klass,
                                    gpointer klass_data)
{
#line 6 "../daemon-gtk3/Main.vala"
	gala_daemon_application_parent_class = g_type_class_peek_parent (klass);
#line 6 "../daemon-gtk3/Main.vala"
	((GApplicationClass *) klass)->startup = (void (*) (GApplication*)) gala_daemon_application_real_startup;
#line 6 "../daemon-gtk3/Main.vala"
	((GApplicationClass *) klass)->activate = (void (*) (GApplication*)) gala_daemon_application_real_activate;
#line 6 "../daemon-gtk3/Main.vala"
	((GApplicationClass *) klass)->dbus_register = (gboolean (*) (GApplication*, GDBusConnection*, const gchar*, GError**)) gala_daemon_application_real_dbus_register;
#line 341 "Main.c"
}

static void
gala_daemon_application_instance_init (GalaDaemonApplication * self,
                                       gpointer klass)
{
}

 G_GNUC_NO_INLINE static GType
gala_daemon_application_get_type_once (void)
{
	static const GTypeInfo g_define_type_info = { sizeof (GalaDaemonApplicationClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) gala_daemon_application_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (GalaDaemonApplication), 0, (GInstanceInitFunc) gala_daemon_application_instance_init, NULL };
	GType gala_daemon_application_type_id;
	gala_daemon_application_type_id = g_type_register_static (gtk_application_get_type (), "GalaDaemonApplication", &g_define_type_info, 0);
	return gala_daemon_application_type_id;
}

GType
gala_daemon_application_get_type (void)
{
	static gsize gala_daemon_application_type_id__once = 0;
	if (g_once_init_enter (&gala_daemon_application_type_id__once)) {
		GType gala_daemon_application_type_id;
		gala_daemon_application_type_id = gala_daemon_application_get_type_once ();
		g_once_init_leave (&gala_daemon_application_type_id__once, gala_daemon_application_type_id);
	}
	return gala_daemon_application_type_id__once;
}

static gint
_vala_main (gchar** args,
            gint args_length1)
{
	GalaDaemonApplication* app = NULL;
	GalaDaemonApplication* _tmp0_;
	gint result;
#line 42 "../daemon-gtk3/Main.vala"
	setlocale (LC_ALL, "");
#line 43 "../daemon-gtk3/Main.vala"
	bindtextdomain (GETTEXT_PACKAGE, LOCALEDIR);
#line 44 "../daemon-gtk3/Main.vala"
	bind_textdomain_codeset (GETTEXT_PACKAGE, "UTF-8");
#line 45 "../daemon-gtk3/Main.vala"
	textdomain (GETTEXT_PACKAGE);
#line 47 "../daemon-gtk3/Main.vala"
	_tmp0_ = gala_daemon_application_new ();
#line 47 "../daemon-gtk3/Main.vala"
	app = _tmp0_;
#line 48 "../daemon-gtk3/Main.vala"
	result = g_application_run ((GApplication*) app, (gint) 0, NULL);
#line 48 "../daemon-gtk3/Main.vala"
	_g_object_unref0 (app);
#line 48 "../daemon-gtk3/Main.vala"
	return result;
#line 396 "Main.c"
}

int
main (int argc,
      char ** argv)
{
#line 41 "../daemon-gtk3/Main.vala"
	return _vala_main (argv, argc);
#line 405 "Main.c"
}

