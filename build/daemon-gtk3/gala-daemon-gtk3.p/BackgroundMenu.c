/* BackgroundMenu.c generated by valac 0.56.17, the Vala compiler
 * generated from BackgroundMenu.vala, do not modify */

/*
 * Copyright 2024 elementary, Inc. (https://elementary.io)
 * SPDX-License-Identifier: GPL-3.0-or-later
 */

#include <gtk/gtk.h>
#include <glib-object.h>
#include <stdlib.h>
#include <string.h>
#include <glib.h>
#include <gio/gio.h>
#include <granite.h>
#include <glib/gi18n-lib.h>

#define GALA_DAEMON_BACKGROUND_MENU_ACTION_GROUP_PREFIX "background-menu"
#define GALA_DAEMON_BACKGROUND_MENU_ACTION_PREFIX GALA_DAEMON_BACKGROUND_MENU_ACTION_GROUP_PREFIX "."
#if !defined(VALA_STRICT_C)
#if !defined(__clang__) && defined(__GNUC__) && (__GNUC__ >= 14)
#pragma GCC diagnostic warning "-Wincompatible-pointer-types"
#elif defined(__clang__) && (__clang_major__ >= 16)
#pragma clang diagnostic ignored "-Wincompatible-function-pointer-types"
#pragma clang diagnostic ignored "-Wincompatible-pointer-types"
#endif
#endif
#if !defined(VALA_EXTERN)
#if defined(_MSC_VER)
#define VALA_EXTERN __declspec(dllexport) extern
#elif __GNUC__ >= 4
#define VALA_EXTERN __attribute__((visibility("default"))) extern
#else
#define VALA_EXTERN extern
#endif
#endif

#define GALA_DAEMON_TYPE_BACKGROUND_MENU (gala_daemon_background_menu_get_type ())
#define GALA_DAEMON_BACKGROUND_MENU(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), GALA_DAEMON_TYPE_BACKGROUND_MENU, GalaDaemonBackgroundMenu))
#define GALA_DAEMON_BACKGROUND_MENU_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), GALA_DAEMON_TYPE_BACKGROUND_MENU, GalaDaemonBackgroundMenuClass))
#define GALA_DAEMON_IS_BACKGROUND_MENU(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), GALA_DAEMON_TYPE_BACKGROUND_MENU))
#define GALA_DAEMON_IS_BACKGROUND_MENU_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), GALA_DAEMON_TYPE_BACKGROUND_MENU))
#define GALA_DAEMON_BACKGROUND_MENU_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), GALA_DAEMON_TYPE_BACKGROUND_MENU, GalaDaemonBackgroundMenuClass))

typedef struct _GalaDaemonBackgroundMenu GalaDaemonBackgroundMenu;
typedef struct _GalaDaemonBackgroundMenuClass GalaDaemonBackgroundMenuClass;
typedef struct _GalaDaemonBackgroundMenuPrivate GalaDaemonBackgroundMenuPrivate;
enum  {
	GALA_DAEMON_BACKGROUND_MENU_0_PROPERTY,
	GALA_DAEMON_BACKGROUND_MENU_NUM_PROPERTIES
};
static GParamSpec* gala_daemon_background_menu_properties[GALA_DAEMON_BACKGROUND_MENU_NUM_PROPERTIES];
#define _g_object_unref0(var) ((var == NULL) ? NULL : (var = (g_object_unref (var), NULL)))
#define _g_error_free0(var) ((var == NULL) ? NULL : (var = (g_error_free (var), NULL)))
#define _g_free0(var) (var = (g_free (var), NULL))
#define _g_variant_unref0(var) ((var == NULL) ? NULL : (var = (g_variant_unref (var), NULL)))

struct _GalaDaemonBackgroundMenu {
	GtkMenu parent_instance;
	GalaDaemonBackgroundMenuPrivate * priv;
};

struct _GalaDaemonBackgroundMenuClass {
	GtkMenuClass parent_class;
};

static gpointer gala_daemon_background_menu_parent_class = NULL;

VALA_EXTERN GType gala_daemon_background_menu_get_type (void) G_GNUC_CONST ;
G_DEFINE_AUTOPTR_CLEANUP_FUNC (GalaDaemonBackgroundMenu, g_object_unref)
static void gala_daemon_background_menu_action_launch (GalaDaemonBackgroundMenu* self,
                                                GSimpleAction* action,
                                                GVariant* variant);
static void _gtk_widget_destroy_gtk_dialog_response (GtkDialog* _sender,
                                              gint response_id,
                                              gpointer self);
VALA_EXTERN GalaDaemonBackgroundMenu* gala_daemon_background_menu_new (void);
VALA_EXTERN GalaDaemonBackgroundMenu* gala_daemon_background_menu_construct (GType object_type);
static GObject * gala_daemon_background_menu_constructor (GType type,
                                                   guint n_construct_properties,
                                                   GObjectConstructParam * construct_properties);
static void _gala_daemon_background_menu_action_launch_g_simple_action_activate (GSimpleAction* _sender,
                                                                          GVariant* parameter,
                                                                          gpointer self);
static GType gala_daemon_background_menu_get_type_once (void);

static void
_gtk_widget_destroy_gtk_dialog_response (GtkDialog* _sender,
                                         gint response_id,
                                         gpointer self)
{
#line 54 "../daemon-gtk3/BackgroundMenu.vala"
	gtk_widget_destroy ((GtkWidget*) self);
#line 95 "BackgroundMenu.c"
}

static void
gala_daemon_background_menu_action_launch (GalaDaemonBackgroundMenu* self,
                                           GSimpleAction* action,
                                           GVariant* variant)
{
	GError* _inner_error0_ = NULL;
#line 42 "../daemon-gtk3/BackgroundMenu.vala"
	g_return_if_fail (self != NULL);
#line 42 "../daemon-gtk3/BackgroundMenu.vala"
	g_return_if_fail (action != NULL);
#line 108 "BackgroundMenu.c"
	{
		const gchar* _tmp0_;
#line 44 "../daemon-gtk3/BackgroundMenu.vala"
		_tmp0_ = g_variant_get_string (variant, NULL);
#line 44 "../daemon-gtk3/BackgroundMenu.vala"
		g_app_info_launch_default_for_uri (_tmp0_, NULL, &_inner_error0_);
#line 44 "../daemon-gtk3/BackgroundMenu.vala"
		if (G_UNLIKELY (_inner_error0_ != NULL)) {
#line 117 "BackgroundMenu.c"
			goto __catch0_g_error;
		}
	}
	goto __finally0;
	__catch0_g_error:
	{
		GError* e = NULL;
		GraniteMessageDialog* message_dialog = NULL;
		GraniteMessageDialog* _tmp1_;
		GraniteMessageDialog* _tmp2_;
		GError* _tmp3_;
		const gchar* _tmp4_;
		GraniteMessageDialog* _tmp5_;
		GraniteMessageDialog* _tmp6_;
		GraniteMessageDialog* _tmp7_;
#line 43 "../daemon-gtk3/BackgroundMenu.vala"
		e = _inner_error0_;
#line 43 "../daemon-gtk3/BackgroundMenu.vala"
		_inner_error0_ = NULL;
#line 46 "../daemon-gtk3/BackgroundMenu.vala"
		_tmp1_ = granite_message_dialog_new_with_image_from_icon_name (_ ("Failed to open System Settings"), _ ("A handler for the “settings://” URI scheme must be installed."), "dialog-error", GTK_BUTTONS_CLOSE);
#line 46 "../daemon-gtk3/BackgroundMenu.vala"
		g_object_ref_sink (_tmp1_);
#line 46 "../daemon-gtk3/BackgroundMenu.vala"
		message_dialog = _tmp1_;
#line 52 "../daemon-gtk3/BackgroundMenu.vala"
		_tmp2_ = message_dialog;
#line 52 "../daemon-gtk3/BackgroundMenu.vala"
		_tmp3_ = e;
#line 52 "../daemon-gtk3/BackgroundMenu.vala"
		_tmp4_ = _tmp3_->message;
#line 52 "../daemon-gtk3/BackgroundMenu.vala"
		granite_message_dialog_show_error_details (_tmp2_, _tmp4_);
#line 53 "../daemon-gtk3/BackgroundMenu.vala"
		_tmp5_ = message_dialog;
#line 53 "../daemon-gtk3/BackgroundMenu.vala"
		gtk_window_present ((GtkWindow*) _tmp5_);
#line 54 "../daemon-gtk3/BackgroundMenu.vala"
		_tmp6_ = message_dialog;
#line 54 "../daemon-gtk3/BackgroundMenu.vala"
		_tmp7_ = message_dialog;
#line 54 "../daemon-gtk3/BackgroundMenu.vala"
		g_signal_connect_object ((GtkDialog*) _tmp6_, "response", (GCallback) _gtk_widget_destroy_gtk_dialog_response, (GtkWidget*) _tmp7_, 0);
#line 43 "../daemon-gtk3/BackgroundMenu.vala"
		_g_object_unref0 (message_dialog);
#line 43 "../daemon-gtk3/BackgroundMenu.vala"
		_g_error_free0 (e);
#line 165 "BackgroundMenu.c"
	}
	__finally0:
#line 43 "../daemon-gtk3/BackgroundMenu.vala"
	if (G_UNLIKELY (_inner_error0_ != NULL)) {
#line 43 "../daemon-gtk3/BackgroundMenu.vala"
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error0_->message, g_quark_to_string (_inner_error0_->domain), _inner_error0_->code);
#line 43 "../daemon-gtk3/BackgroundMenu.vala"
		g_clear_error (&_inner_error0_);
#line 43 "../daemon-gtk3/BackgroundMenu.vala"
		return;
#line 176 "BackgroundMenu.c"
	}
}

GalaDaemonBackgroundMenu*
gala_daemon_background_menu_construct (GType object_type)
{
	GalaDaemonBackgroundMenu * self = NULL;
#line 6 "../daemon-gtk3/BackgroundMenu.vala"
	self = (GalaDaemonBackgroundMenu*) g_object_new (object_type, NULL);
#line 6 "../daemon-gtk3/BackgroundMenu.vala"
	return self;
#line 188 "BackgroundMenu.c"
}

GalaDaemonBackgroundMenu*
gala_daemon_background_menu_new (void)
{
#line 6 "../daemon-gtk3/BackgroundMenu.vala"
	return gala_daemon_background_menu_construct (GALA_DAEMON_TYPE_BACKGROUND_MENU);
#line 196 "BackgroundMenu.c"
}

static void
_gala_daemon_background_menu_action_launch_g_simple_action_activate (GSimpleAction* _sender,
                                                                     GVariant* parameter,
                                                                     gpointer self)
{
#line 34 "../daemon-gtk3/BackgroundMenu.vala"
	gala_daemon_background_menu_action_launch ((GalaDaemonBackgroundMenu*) self, _sender, parameter);
#line 206 "BackgroundMenu.c"
}

static GObject *
gala_daemon_background_menu_constructor (GType type,
                                         guint n_construct_properties,
                                         GObjectConstructParam * construct_properties)
{
	GObject * obj;
	GObjectClass * parent_class;
	GalaDaemonBackgroundMenu * self;
	GtkMenuItem* change_wallpaper = NULL;
	gchar* _tmp0_;
	GVariant* _tmp1_;
	GtkMenuItem* _tmp2_ = NULL;
	GtkMenuItem* display_settings = NULL;
	gchar* _tmp3_;
	GVariant* _tmp4_;
	GtkMenuItem* _tmp5_ = NULL;
	GtkMenuItem* system_settings = NULL;
	gchar* _tmp6_;
	GVariant* _tmp7_;
	GtkMenuItem* _tmp8_ = NULL;
	GtkMenuItem* _tmp9_;
	GtkMenuItem* _tmp10_;
	GtkSeparatorMenuItem* _tmp11_;
	GtkSeparatorMenuItem* _tmp12_;
	GtkMenuItem* _tmp13_;
	GSimpleAction* launch_action = NULL;
	const GVariantType* _tmp14_;
	GSimpleAction* _tmp15_;
	GSimpleAction* _tmp16_;
	GSimpleActionGroup* action_group = NULL;
	GSimpleActionGroup* _tmp17_;
	GSimpleActionGroup* _tmp18_;
	GSimpleAction* _tmp19_;
	GSimpleActionGroup* _tmp20_;
#line 10 "../daemon-gtk3/BackgroundMenu.vala"
	parent_class = G_OBJECT_CLASS (gala_daemon_background_menu_parent_class);
#line 10 "../daemon-gtk3/BackgroundMenu.vala"
	obj = parent_class->constructor (type, n_construct_properties, construct_properties);
#line 10 "../daemon-gtk3/BackgroundMenu.vala"
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, GALA_DAEMON_TYPE_BACKGROUND_MENU, GalaDaemonBackgroundMenu);
#line 11 "../daemon-gtk3/BackgroundMenu.vala"
	_tmp0_ = g_strdup (GALA_DAEMON_BACKGROUND_MENU_ACTION_PREFIX "launch-uri");
#line 11 "../daemon-gtk3/BackgroundMenu.vala"
	_tmp1_ = g_variant_new_string ("settings://desktop/appearance/wallpaper");
#line 11 "../daemon-gtk3/BackgroundMenu.vala"
	g_variant_ref_sink (_tmp1_);
#line 11 "../daemon-gtk3/BackgroundMenu.vala"
	_tmp2_ = (GtkMenuItem*) gtk_menu_item_new_with_label (_ ("Change Wallpaper…"));
#line 11 "../daemon-gtk3/BackgroundMenu.vala"
	gtk_actionable_set_action_name ((GtkActionable*) _tmp2_, _tmp0_);
#line 11 "../daemon-gtk3/BackgroundMenu.vala"
	_g_free0 (_tmp0_);
#line 11 "../daemon-gtk3/BackgroundMenu.vala"
	g_object_set ((GtkActionable*) _tmp2_, "action-target", _tmp1_, NULL);
#line 11 "../daemon-gtk3/BackgroundMenu.vala"
	_g_variant_unref0 (_tmp1_);
#line 11 "../daemon-gtk3/BackgroundMenu.vala"
	g_object_ref_sink (_tmp2_);
#line 11 "../daemon-gtk3/BackgroundMenu.vala"
	change_wallpaper = _tmp2_;
#line 16 "../daemon-gtk3/BackgroundMenu.vala"
	_tmp3_ = g_strdup (GALA_DAEMON_BACKGROUND_MENU_ACTION_PREFIX "launch-uri");
#line 16 "../daemon-gtk3/BackgroundMenu.vala"
	_tmp4_ = g_variant_new_string ("settings://display");
#line 16 "../daemon-gtk3/BackgroundMenu.vala"
	g_variant_ref_sink (_tmp4_);
#line 16 "../daemon-gtk3/BackgroundMenu.vala"
	_tmp5_ = (GtkMenuItem*) gtk_menu_item_new_with_label (_ ("Display Settings…"));
#line 16 "../daemon-gtk3/BackgroundMenu.vala"
	gtk_actionable_set_action_name ((GtkActionable*) _tmp5_, _tmp3_);
#line 16 "../daemon-gtk3/BackgroundMenu.vala"
	_g_free0 (_tmp3_);
#line 16 "../daemon-gtk3/BackgroundMenu.vala"
	g_object_set ((GtkActionable*) _tmp5_, "action-target", _tmp4_, NULL);
#line 16 "../daemon-gtk3/BackgroundMenu.vala"
	_g_variant_unref0 (_tmp4_);
#line 16 "../daemon-gtk3/BackgroundMenu.vala"
	g_object_ref_sink (_tmp5_);
#line 16 "../daemon-gtk3/BackgroundMenu.vala"
	display_settings = _tmp5_;
#line 22 "../daemon-gtk3/BackgroundMenu.vala"
	_tmp6_ = g_strdup (GALA_DAEMON_BACKGROUND_MENU_ACTION_PREFIX "launch-uri");
#line 22 "../daemon-gtk3/BackgroundMenu.vala"
	_tmp7_ = g_variant_new_string ("settings://");
#line 22 "../daemon-gtk3/BackgroundMenu.vala"
	g_variant_ref_sink (_tmp7_);
#line 22 "../daemon-gtk3/BackgroundMenu.vala"
	_tmp8_ = (GtkMenuItem*) gtk_menu_item_new_with_label (_ ("System Settings…"));
#line 22 "../daemon-gtk3/BackgroundMenu.vala"
	gtk_actionable_set_action_name ((GtkActionable*) _tmp8_, _tmp6_);
#line 22 "../daemon-gtk3/BackgroundMenu.vala"
	_g_free0 (_tmp6_);
#line 22 "../daemon-gtk3/BackgroundMenu.vala"
	g_object_set ((GtkActionable*) _tmp8_, "action-target", _tmp7_, NULL);
#line 22 "../daemon-gtk3/BackgroundMenu.vala"
	_g_variant_unref0 (_tmp7_);
#line 22 "../daemon-gtk3/BackgroundMenu.vala"
	g_object_ref_sink (_tmp8_);
#line 22 "../daemon-gtk3/BackgroundMenu.vala"
	system_settings = _tmp8_;
#line 27 "../daemon-gtk3/BackgroundMenu.vala"
	_tmp9_ = change_wallpaper;
#line 27 "../daemon-gtk3/BackgroundMenu.vala"
	gtk_menu_shell_append ((GtkMenuShell*) self, _tmp9_);
#line 28 "../daemon-gtk3/BackgroundMenu.vala"
	_tmp10_ = display_settings;
#line 28 "../daemon-gtk3/BackgroundMenu.vala"
	gtk_menu_shell_append ((GtkMenuShell*) self, _tmp10_);
#line 29 "../daemon-gtk3/BackgroundMenu.vala"
	_tmp11_ = (GtkSeparatorMenuItem*) gtk_separator_menu_item_new ();
#line 29 "../daemon-gtk3/BackgroundMenu.vala"
	g_object_ref_sink (_tmp11_);
#line 29 "../daemon-gtk3/BackgroundMenu.vala"
	_tmp12_ = _tmp11_;
#line 29 "../daemon-gtk3/BackgroundMenu.vala"
	gtk_menu_shell_append ((GtkMenuShell*) self, (GtkMenuItem*) _tmp12_);
#line 29 "../daemon-gtk3/BackgroundMenu.vala"
	_g_object_unref0 (_tmp12_);
#line 30 "../daemon-gtk3/BackgroundMenu.vala"
	_tmp13_ = system_settings;
#line 30 "../daemon-gtk3/BackgroundMenu.vala"
	gtk_menu_shell_append ((GtkMenuShell*) self, _tmp13_);
#line 31 "../daemon-gtk3/BackgroundMenu.vala"
	gtk_widget_show_all ((GtkWidget*) self);
#line 33 "../daemon-gtk3/BackgroundMenu.vala"
	_tmp14_ = G_VARIANT_TYPE_STRING;
#line 33 "../daemon-gtk3/BackgroundMenu.vala"
	_tmp15_ = g_simple_action_new ("launch-uri", _tmp14_);
#line 33 "../daemon-gtk3/BackgroundMenu.vala"
	launch_action = _tmp15_;
#line 34 "../daemon-gtk3/BackgroundMenu.vala"
	_tmp16_ = launch_action;
#line 34 "../daemon-gtk3/BackgroundMenu.vala"
	g_signal_connect_object (_tmp16_, "activate", (GCallback) _gala_daemon_background_menu_action_launch_g_simple_action_activate, self, 0);
#line 36 "../daemon-gtk3/BackgroundMenu.vala"
	_tmp17_ = g_simple_action_group_new ();
#line 36 "../daemon-gtk3/BackgroundMenu.vala"
	action_group = _tmp17_;
#line 37 "../daemon-gtk3/BackgroundMenu.vala"
	_tmp18_ = action_group;
#line 37 "../daemon-gtk3/BackgroundMenu.vala"
	_tmp19_ = launch_action;
#line 37 "../daemon-gtk3/BackgroundMenu.vala"
	g_action_map_add_action ((GActionMap*) _tmp18_, (GAction*) _tmp19_);
#line 39 "../daemon-gtk3/BackgroundMenu.vala"
	_tmp20_ = action_group;
#line 39 "../daemon-gtk3/BackgroundMenu.vala"
	gtk_widget_insert_action_group ((GtkWidget*) self, GALA_DAEMON_BACKGROUND_MENU_ACTION_GROUP_PREFIX, (GActionGroup*) _tmp20_);
#line 10 "../daemon-gtk3/BackgroundMenu.vala"
	_g_object_unref0 (action_group);
#line 10 "../daemon-gtk3/BackgroundMenu.vala"
	_g_object_unref0 (launch_action);
#line 10 "../daemon-gtk3/BackgroundMenu.vala"
	_g_object_unref0 (system_settings);
#line 10 "../daemon-gtk3/BackgroundMenu.vala"
	_g_object_unref0 (display_settings);
#line 10 "../daemon-gtk3/BackgroundMenu.vala"
	_g_object_unref0 (change_wallpaper);
#line 10 "../daemon-gtk3/BackgroundMenu.vala"
	return obj;
#line 369 "BackgroundMenu.c"
}

static void
gala_daemon_background_menu_class_init (GalaDaemonBackgroundMenuClass * klass,
                                        gpointer klass_data)
{
#line 6 "../daemon-gtk3/BackgroundMenu.vala"
	gala_daemon_background_menu_parent_class = g_type_class_peek_parent (klass);
#line 6 "../daemon-gtk3/BackgroundMenu.vala"
	G_OBJECT_CLASS (klass)->constructor = gala_daemon_background_menu_constructor;
#line 380 "BackgroundMenu.c"
}

static void
gala_daemon_background_menu_instance_init (GalaDaemonBackgroundMenu * self,
                                           gpointer klass)
{
}

 G_GNUC_NO_INLINE static GType
gala_daemon_background_menu_get_type_once (void)
{
	static const GTypeInfo g_define_type_info = { sizeof (GalaDaemonBackgroundMenuClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) gala_daemon_background_menu_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (GalaDaemonBackgroundMenu), 0, (GInstanceInitFunc) gala_daemon_background_menu_instance_init, NULL };
	GType gala_daemon_background_menu_type_id;
	gala_daemon_background_menu_type_id = g_type_register_static (gtk_menu_get_type (), "GalaDaemonBackgroundMenu", &g_define_type_info, 0);
	return gala_daemon_background_menu_type_id;
}

GType
gala_daemon_background_menu_get_type (void)
{
	static gsize gala_daemon_background_menu_type_id__once = 0;
	if (g_once_init_enter (&gala_daemon_background_menu_type_id__once)) {
		GType gala_daemon_background_menu_type_id;
		gala_daemon_background_menu_type_id = gala_daemon_background_menu_get_type_once ();
		g_once_init_leave (&gala_daemon_background_menu_type_id__once, gala_daemon_background_menu_type_id);
	}
	return gala_daemon_background_menu_type_id__once;
}

