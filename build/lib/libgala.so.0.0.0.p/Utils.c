/* Utils.c generated by valac 0.56.17, the Vala compiler
 * generated from Utils.vala, do not modify */

/**/
/*  Copyright (C) 2012 Tom Beckmann, Rico Tzschichholz*/
/**/
/*  This program is free software: you can redistribute it and/or modify*/
/*  it under the terms of the GNU General Public License as published by*/
/*  the Free Software Foundation, either version 3 of the License, or*/
/*  (at your option) any later version.*/
/**/
/*  This program is distributed in the hope that it will be useful,*/
/*  but WITHOUT ANY WARRANTY; without even the implied warranty of*/
/*  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the*/
/*  GNU General Public License for more details.*/
/**/
/*  You should have received a copy of the GNU General Public License*/
/*  along with this program.  If not, see <http://www.gnu.org/licenses/>.*/
/**/

#include "gala.h"
#include <gee.h>
#include <glib-object.h>
#include <glib.h>
#include <gdk-pixbuf/gdk-pixbuf.h>
#include <gio/gdesktopappinfo.h>
#include <meta/window.h>
#include <gtk/gtk.h>
#include <stdlib.h>
#include <string.h>
#include <meta/group.h>
#include <gio/gio.h>
#include <float.h>
#include <math.h>
#include <meta/workspace.h>
#include <meta/meta-window-actor.h>
#include <mtk/mtk.h>
#include <clutter/clutter.h>
#include "config.h"
#include <cogl/cogl.h>
#include <gobject/gvaluecollector.h>

#if !defined(VALA_STRICT_C)
#if !defined(__clang__) && defined(__GNUC__) && (__GNUC__ >= 14)
#pragma GCC diagnostic warning "-Wincompatible-pointer-types"
#elif defined(__clang__) && (__clang_major__ >= 16)
#pragma clang diagnostic ignored "-Wincompatible-function-pointer-types"
#pragma clang diagnostic ignored "-Wincompatible-pointer-types"
#endif
#endif

#define GALA_UTILS_TYPE_CACHED_ICON (gala_utils_cached_icon_get_type ())
typedef struct _GalaUtilsCachedIcon GalaUtilsCachedIcon;
typedef struct _Block4Data Block4Data;
#define _g_object_unref0(var) ((var == NULL) ? NULL : (var = (g_object_unref (var), NULL)))
#define _g_free0(var) (var = (g_free (var), NULL))
#define _gala_utils_cached_icon_free0(var) ((var == NULL) ? NULL : (var = (gala_utils_cached_icon_free (var), NULL)))
#define _g_error_free0(var) ((var == NULL) ? NULL : (var = (g_error_free (var), NULL)))
typedef struct _GalaParamSpecUtils GalaParamSpecUtils;

struct _GalaUtilsCachedIcon {
	GdkPixbuf* icon;
	gint icon_size;
	gint scale;
};

struct _Block4Data {
	int _ref_count_;
	GDesktopAppInfo* desktop_app;
};

struct _GalaParamSpecUtils {
	GParamSpec parent_instance;
};

static gpointer gala_utils_parent_class = NULL;
static GeeHashMap* gala_utils_resize_pixbufs;
static GeeHashMap* gala_utils_resize_pixbufs = NULL;
static GeeHashMultiMap* gala_utils_icon_cache;
static GeeHashMultiMap* gala_utils_icon_cache = NULL;
static GeeHashMap* gala_utils_window_to_desktop_cache;
static GeeHashMap* gala_utils_window_to_desktop_cache = NULL;
static GeeArrayList* gala_utils_unknown_icon_cache;
static GeeArrayList* gala_utils_unknown_icon_cache = NULL;
static GalaAppCache* gala_utils_app_cache;
static GalaAppCache* gala_utils_app_cache = NULL;
static GtkIconTheme* gala_utils_icon_theme;
static GtkIconTheme* gala_utils_icon_theme = NULL;
static GtkCssProvider* gala_utils_gala_css;
static GtkCssProvider* gala_utils_gala_css = NULL;

static GType gala_utils_cached_icon_get_type (void) G_GNUC_CONST  G_GNUC_UNUSED ;
static GalaUtilsCachedIcon* gala_utils_cached_icon_dup (const GalaUtilsCachedIcon* self);
static void gala_utils_cached_icon_free (GalaUtilsCachedIcon* self);
static void gala_utils_cached_icon_copy (const GalaUtilsCachedIcon* self,
                                  GalaUtilsCachedIcon* dest);
static void gala_utils_cached_icon_destroy (GalaUtilsCachedIcon* self);
static Block4Data* block4_data_ref (Block4Data* _data4_);
static void block4_data_unref (void * _userdata_);
static GdkPixbuf* gala_utils_get_icon_for_desktop_app_info (GDesktopAppInfo* desktop,
                                                     gint icon_size,
                                                     gint scale);
static gboolean gala_utils_check_app_prefix (GDesktopAppInfo* app,
                                      const gchar* sandbox_id);
static GDesktopAppInfo* gala_utils_lookup_desktop_wmclass (const gchar* wm_class);
static GDesktopAppInfo* gala_utils_get_app_from_id (const gchar* id);
static void ____lambda9_ (Block4Data* _data4_,
                   MetaWindow* window);
static void _____lambda9__gfunc (gconstpointer data,
                          gpointer self);
static gchar** _vala_array_dup3 (gchar** self,
                          gssize length);
static void _gala_utils___lambda10_ (void);
static void __gala_utils___lambda10__gala_app_cache_changed (GalaAppCache* _sender,
                                                      gpointer self);
static void gala_utils_finalize (GalaUtils * obj);
static GType gala_utils_get_type_once (void);
static void _vala_array_destroy (gpointer array,
                          gssize array_length,
                          GDestroyNotify destroy_func);
static void _vala_array_free (gpointer array,
                       gssize array_length,
                       GDestroyNotify destroy_func);
static gssize _vala_array_length (gpointer array);

static Block4Data*
block4_data_ref (Block4Data* _data4_)
{
#line 50 "../lib/Utils.vala"
	g_atomic_int_inc (&_data4_->_ref_count_);
#line 50 "../lib/Utils.vala"
	return _data4_;
#line 134 "Utils.c"
}

static void
block4_data_unref (void * _userdata_)
{
	Block4Data* _data4_;
	_data4_ = (Block4Data*) _userdata_;
#line 50 "../lib/Utils.vala"
	if (g_atomic_int_dec_and_test (&_data4_->_ref_count_)) {
#line 50 "../lib/Utils.vala"
		_g_object_unref0 (_data4_->desktop_app);
#line 50 "../lib/Utils.vala"
		g_slice_free (Block4Data, _data4_);
#line 148 "Utils.c"
	}
}

static gpointer
_g_object_ref0 (gpointer self)
{
#line 51 "../lib/Utils.vala"
	return self ? g_object_ref (self) : NULL;
#line 157 "Utils.c"
}

static void
____lambda9_ (Block4Data* _data4_,
              MetaWindow* window)
{
	GeeHashMap* _tmp0_;
	gpointer _tmp1_;
	GDesktopAppInfo* _tmp2_;
	gboolean _tmp3_;
#line 132 "../lib/Utils.vala"
	g_return_if_fail (window != NULL);
#line 133 "../lib/Utils.vala"
	if (meta_window_get_window_type (window) != META_WINDOW_NORMAL) {
#line 134 "../lib/Utils.vala"
		return;
#line 174 "Utils.c"
	}
#line 137 "../lib/Utils.vala"
	_tmp0_ = gala_utils_window_to_desktop_cache;
#line 137 "../lib/Utils.vala"
	_tmp1_ = gee_abstract_map_get ((GeeAbstractMap*) _tmp0_, window);
#line 137 "../lib/Utils.vala"
	_tmp2_ = (GDesktopAppInfo*) _tmp1_;
#line 137 "../lib/Utils.vala"
	_tmp3_ = _tmp2_ != NULL;
#line 137 "../lib/Utils.vala"
	_g_object_unref0 (_tmp2_);
#line 137 "../lib/Utils.vala"
	if (_tmp3_) {
#line 188 "Utils.c"
		GeeHashMap* _tmp4_;
		gpointer _tmp5_;
#line 138 "../lib/Utils.vala"
		_tmp4_ = gala_utils_window_to_desktop_cache;
#line 138 "../lib/Utils.vala"
		_tmp5_ = gee_abstract_map_get ((GeeAbstractMap*) _tmp4_, window);
#line 138 "../lib/Utils.vala"
		_g_object_unref0 (_data4_->desktop_app);
#line 138 "../lib/Utils.vala"
		_data4_->desktop_app = (GDesktopAppInfo*) _tmp5_;
#line 199 "Utils.c"
	}
}

static void
_____lambda9__gfunc (gconstpointer data,
                     gpointer self)
{
#line 132 "../lib/Utils.vala"
	____lambda9_ (self, (MetaWindow*) data);
#line 209 "Utils.c"
}

GdkPixbuf*
gala_utils_get_icon_for_window (MetaWindow* window,
                                gint icon_size,
                                gint scale)
{
	Block4Data* _data4_;
	MetaWindow* transient_for = NULL;
	MetaWindow* _tmp0_;
	MetaWindow* _tmp1_;
	MetaWindow* _tmp2_;
	GeeHashMap* _tmp5_;
	gpointer _tmp6_;
	GDesktopAppInfo* _tmp7_;
	gchar* sandbox_id = NULL;
	const gchar* _tmp11_;
	gchar* _tmp12_;
	gchar* wm_instance = NULL;
	const gchar* _tmp13_;
	gchar* _tmp14_;
	GalaAppCache* _tmp15_;
	const gchar* _tmp16_;
	GDesktopAppInfo* _tmp17_;
	gboolean _tmp18_ = FALSE;
	GDesktopAppInfo* _tmp19_;
	gchar* wm_class = NULL;
	const gchar* _tmp27_;
	gchar* _tmp28_;
	GalaAppCache* _tmp29_;
	const gchar* _tmp30_;
	GDesktopAppInfo* _tmp31_;
	gboolean _tmp32_ = FALSE;
	GDesktopAppInfo* _tmp33_;
	const gchar* _tmp41_;
	GDesktopAppInfo* _tmp42_;
	gboolean _tmp43_ = FALSE;
	GDesktopAppInfo* _tmp44_;
	const gchar* _tmp52_;
	GDesktopAppInfo* _tmp53_;
	gboolean _tmp54_ = FALSE;
	GDesktopAppInfo* _tmp55_;
	const gchar* _tmp63_;
	GDesktopAppInfo* _tmp64_;
	GDesktopAppInfo* _tmp65_;
	gchar* gapplication_id = NULL;
	const gchar* _tmp71_;
	gchar* _tmp72_;
	const gchar* _tmp73_;
	GDesktopAppInfo* _tmp74_;
	GDesktopAppInfo* _tmp75_;
	GError* _inner_error0_ = NULL;
	GdkPixbuf* result;
#line 50 "../lib/Utils.vala"
	g_return_val_if_fail (window != NULL, NULL);
#line 50 "../lib/Utils.vala"
	_data4_ = g_slice_new0 (Block4Data);
#line 50 "../lib/Utils.vala"
	_data4_->_ref_count_ = 1;
#line 51 "../lib/Utils.vala"
	_tmp0_ = meta_window_get_transient_for (window);
#line 51 "../lib/Utils.vala"
	_tmp1_ = _g_object_ref0 (_tmp0_);
#line 51 "../lib/Utils.vala"
	transient_for = _tmp1_;
#line 52 "../lib/Utils.vala"
	_tmp2_ = transient_for;
#line 52 "../lib/Utils.vala"
	if (_tmp2_ != NULL) {
#line 279 "Utils.c"
		MetaWindow* _tmp3_;
		GdkPixbuf* _tmp4_;
#line 53 "../lib/Utils.vala"
		_tmp3_ = transient_for;
#line 53 "../lib/Utils.vala"
		_tmp4_ = gala_utils_get_icon_for_window (_tmp3_, icon_size, scale);
#line 53 "../lib/Utils.vala"
		result = _tmp4_;
#line 53 "../lib/Utils.vala"
		_g_object_unref0 (transient_for);
#line 53 "../lib/Utils.vala"
		block4_data_unref (_data4_);
#line 53 "../lib/Utils.vala"
		_data4_ = NULL;
#line 53 "../lib/Utils.vala"
		return result;
#line 296 "Utils.c"
	}
#line 56 "../lib/Utils.vala"
	_data4_->desktop_app = NULL;
#line 57 "../lib/Utils.vala"
	_tmp5_ = gala_utils_window_to_desktop_cache;
#line 57 "../lib/Utils.vala"
	_tmp6_ = gee_abstract_map_get ((GeeAbstractMap*) _tmp5_, window);
#line 57 "../lib/Utils.vala"
	_g_object_unref0 (_data4_->desktop_app);
#line 57 "../lib/Utils.vala"
	_data4_->desktop_app = (GDesktopAppInfo*) _tmp6_;
#line 58 "../lib/Utils.vala"
	_tmp7_ = _data4_->desktop_app;
#line 58 "../lib/Utils.vala"
	if (_tmp7_ != NULL) {
#line 312 "Utils.c"
		GdkPixbuf* icon = NULL;
		GDesktopAppInfo* _tmp8_;
		GdkPixbuf* _tmp9_;
		GdkPixbuf* _tmp10_;
#line 59 "../lib/Utils.vala"
		_tmp8_ = _data4_->desktop_app;
#line 59 "../lib/Utils.vala"
		_tmp9_ = gala_utils_get_icon_for_desktop_app_info (_tmp8_, icon_size, scale);
#line 59 "../lib/Utils.vala"
		icon = _tmp9_;
#line 60 "../lib/Utils.vala"
		_tmp10_ = icon;
#line 60 "../lib/Utils.vala"
		if (_tmp10_ != NULL) {
#line 61 "../lib/Utils.vala"
			result = icon;
#line 61 "../lib/Utils.vala"
			_g_object_unref0 (transient_for);
#line 61 "../lib/Utils.vala"
			block4_data_unref (_data4_);
#line 61 "../lib/Utils.vala"
			_data4_ = NULL;
#line 61 "../lib/Utils.vala"
			return result;
#line 337 "Utils.c"
		}
#line 58 "../lib/Utils.vala"
		_g_object_unref0 (icon);
#line 341 "Utils.c"
	}
#line 65 "../lib/Utils.vala"
	_tmp11_ = meta_window_get_sandboxed_app_id (window);
#line 65 "../lib/Utils.vala"
	_tmp12_ = g_strdup (_tmp11_);
#line 65 "../lib/Utils.vala"
	sandbox_id = _tmp12_;
#line 67 "../lib/Utils.vala"
	_tmp13_ = meta_window_get_wm_class_instance (window);
#line 67 "../lib/Utils.vala"
	_tmp14_ = g_strdup (_tmp13_);
#line 67 "../lib/Utils.vala"
	wm_instance = _tmp14_;
#line 68 "../lib/Utils.vala"
	_tmp15_ = gala_utils_app_cache;
#line 68 "../lib/Utils.vala"
	_tmp16_ = wm_instance;
#line 68 "../lib/Utils.vala"
	_tmp17_ = gala_app_cache_lookup_startup_wmclass (_tmp15_, _tmp16_);
#line 68 "../lib/Utils.vala"
	_g_object_unref0 (_data4_->desktop_app);
#line 68 "../lib/Utils.vala"
	_data4_->desktop_app = _tmp17_;
#line 69 "../lib/Utils.vala"
	_tmp19_ = _data4_->desktop_app;
#line 69 "../lib/Utils.vala"
	if (_tmp19_ != NULL) {
#line 369 "Utils.c"
		GDesktopAppInfo* _tmp20_;
		const gchar* _tmp21_;
#line 69 "../lib/Utils.vala"
		_tmp20_ = _data4_->desktop_app;
#line 69 "../lib/Utils.vala"
		_tmp21_ = sandbox_id;
#line 69 "../lib/Utils.vala"
		_tmp18_ = gala_utils_check_app_prefix (_tmp20_, _tmp21_);
#line 378 "Utils.c"
	} else {
#line 69 "../lib/Utils.vala"
		_tmp18_ = FALSE;
#line 382 "Utils.c"
	}
#line 69 "../lib/Utils.vala"
	if (_tmp18_) {
#line 386 "Utils.c"
		GdkPixbuf* icon = NULL;
		GDesktopAppInfo* _tmp22_;
		GdkPixbuf* _tmp23_;
		GdkPixbuf* _tmp24_;
#line 70 "../lib/Utils.vala"
		_tmp22_ = _data4_->desktop_app;
#line 70 "../lib/Utils.vala"
		_tmp23_ = gala_utils_get_icon_for_desktop_app_info (_tmp22_, icon_size, scale);
#line 70 "../lib/Utils.vala"
		icon = _tmp23_;
#line 71 "../lib/Utils.vala"
		_tmp24_ = icon;
#line 71 "../lib/Utils.vala"
		if (_tmp24_ != NULL) {
#line 401 "Utils.c"
			GeeHashMap* _tmp25_;
			GDesktopAppInfo* _tmp26_;
#line 72 "../lib/Utils.vala"
			_tmp25_ = gala_utils_window_to_desktop_cache;
#line 72 "../lib/Utils.vala"
			_tmp26_ = _data4_->desktop_app;
#line 72 "../lib/Utils.vala"
			gee_abstract_map_set ((GeeAbstractMap*) _tmp25_, window, _tmp26_);
#line 73 "../lib/Utils.vala"
			result = icon;
#line 73 "../lib/Utils.vala"
			_g_free0 (wm_instance);
#line 73 "../lib/Utils.vala"
			_g_free0 (sandbox_id);
#line 73 "../lib/Utils.vala"
			_g_object_unref0 (transient_for);
#line 73 "../lib/Utils.vala"
			block4_data_unref (_data4_);
#line 73 "../lib/Utils.vala"
			_data4_ = NULL;
#line 73 "../lib/Utils.vala"
			return result;
#line 424 "Utils.c"
		}
#line 69 "../lib/Utils.vala"
		_g_object_unref0 (icon);
#line 428 "Utils.c"
	}
#line 77 "../lib/Utils.vala"
	_tmp27_ = meta_window_get_wm_class (window);
#line 77 "../lib/Utils.vala"
	_tmp28_ = g_strdup (_tmp27_);
#line 77 "../lib/Utils.vala"
	wm_class = _tmp28_;
#line 78 "../lib/Utils.vala"
	_tmp29_ = gala_utils_app_cache;
#line 78 "../lib/Utils.vala"
	_tmp30_ = wm_class;
#line 78 "../lib/Utils.vala"
	_tmp31_ = gala_app_cache_lookup_startup_wmclass (_tmp29_, _tmp30_);
#line 78 "../lib/Utils.vala"
	_g_object_unref0 (_data4_->desktop_app);
#line 78 "../lib/Utils.vala"
	_data4_->desktop_app = _tmp31_;
#line 79 "../lib/Utils.vala"
	_tmp33_ = _data4_->desktop_app;
#line 79 "../lib/Utils.vala"
	if (_tmp33_ != NULL) {
#line 450 "Utils.c"
		GDesktopAppInfo* _tmp34_;
		const gchar* _tmp35_;
#line 79 "../lib/Utils.vala"
		_tmp34_ = _data4_->desktop_app;
#line 79 "../lib/Utils.vala"
		_tmp35_ = sandbox_id;
#line 79 "../lib/Utils.vala"
		_tmp32_ = gala_utils_check_app_prefix (_tmp34_, _tmp35_);
#line 459 "Utils.c"
	} else {
#line 79 "../lib/Utils.vala"
		_tmp32_ = FALSE;
#line 463 "Utils.c"
	}
#line 79 "../lib/Utils.vala"
	if (_tmp32_) {
#line 467 "Utils.c"
		GdkPixbuf* icon = NULL;
		GDesktopAppInfo* _tmp36_;
		GdkPixbuf* _tmp37_;
		GdkPixbuf* _tmp38_;
#line 80 "../lib/Utils.vala"
		_tmp36_ = _data4_->desktop_app;
#line 80 "../lib/Utils.vala"
		_tmp37_ = gala_utils_get_icon_for_desktop_app_info (_tmp36_, icon_size, scale);
#line 80 "../lib/Utils.vala"
		icon = _tmp37_;
#line 81 "../lib/Utils.vala"
		_tmp38_ = icon;
#line 81 "../lib/Utils.vala"
		if (_tmp38_ != NULL) {
#line 482 "Utils.c"
			GeeHashMap* _tmp39_;
			GDesktopAppInfo* _tmp40_;
#line 82 "../lib/Utils.vala"
			_tmp39_ = gala_utils_window_to_desktop_cache;
#line 82 "../lib/Utils.vala"
			_tmp40_ = _data4_->desktop_app;
#line 82 "../lib/Utils.vala"
			gee_abstract_map_set ((GeeAbstractMap*) _tmp39_, window, _tmp40_);
#line 83 "../lib/Utils.vala"
			result = icon;
#line 83 "../lib/Utils.vala"
			_g_free0 (wm_class);
#line 83 "../lib/Utils.vala"
			_g_free0 (wm_instance);
#line 83 "../lib/Utils.vala"
			_g_free0 (sandbox_id);
#line 83 "../lib/Utils.vala"
			_g_object_unref0 (transient_for);
#line 83 "../lib/Utils.vala"
			block4_data_unref (_data4_);
#line 83 "../lib/Utils.vala"
			_data4_ = NULL;
#line 83 "../lib/Utils.vala"
			return result;
#line 507 "Utils.c"
		}
#line 79 "../lib/Utils.vala"
		_g_object_unref0 (icon);
#line 511 "Utils.c"
	}
#line 87 "../lib/Utils.vala"
	_tmp41_ = wm_instance;
#line 87 "../lib/Utils.vala"
	_tmp42_ = gala_utils_lookup_desktop_wmclass (_tmp41_);
#line 87 "../lib/Utils.vala"
	_g_object_unref0 (_data4_->desktop_app);
#line 87 "../lib/Utils.vala"
	_data4_->desktop_app = _tmp42_;
#line 88 "../lib/Utils.vala"
	_tmp44_ = _data4_->desktop_app;
#line 88 "../lib/Utils.vala"
	if (_tmp44_ != NULL) {
#line 525 "Utils.c"
		GDesktopAppInfo* _tmp45_;
		const gchar* _tmp46_;
#line 88 "../lib/Utils.vala"
		_tmp45_ = _data4_->desktop_app;
#line 88 "../lib/Utils.vala"
		_tmp46_ = sandbox_id;
#line 88 "../lib/Utils.vala"
		_tmp43_ = gala_utils_check_app_prefix (_tmp45_, _tmp46_);
#line 534 "Utils.c"
	} else {
#line 88 "../lib/Utils.vala"
		_tmp43_ = FALSE;
#line 538 "Utils.c"
	}
#line 88 "../lib/Utils.vala"
	if (_tmp43_) {
#line 542 "Utils.c"
		GdkPixbuf* icon = NULL;
		GDesktopAppInfo* _tmp47_;
		GdkPixbuf* _tmp48_;
		GdkPixbuf* _tmp49_;
#line 89 "../lib/Utils.vala"
		_tmp47_ = _data4_->desktop_app;
#line 89 "../lib/Utils.vala"
		_tmp48_ = gala_utils_get_icon_for_desktop_app_info (_tmp47_, icon_size, scale);
#line 89 "../lib/Utils.vala"
		icon = _tmp48_;
#line 90 "../lib/Utils.vala"
		_tmp49_ = icon;
#line 90 "../lib/Utils.vala"
		if (_tmp49_ != NULL) {
#line 557 "Utils.c"
			GeeHashMap* _tmp50_;
			GDesktopAppInfo* _tmp51_;
#line 91 "../lib/Utils.vala"
			_tmp50_ = gala_utils_window_to_desktop_cache;
#line 91 "../lib/Utils.vala"
			_tmp51_ = _data4_->desktop_app;
#line 91 "../lib/Utils.vala"
			gee_abstract_map_set ((GeeAbstractMap*) _tmp50_, window, _tmp51_);
#line 92 "../lib/Utils.vala"
			result = icon;
#line 92 "../lib/Utils.vala"
			_g_free0 (wm_class);
#line 92 "../lib/Utils.vala"
			_g_free0 (wm_instance);
#line 92 "../lib/Utils.vala"
			_g_free0 (sandbox_id);
#line 92 "../lib/Utils.vala"
			_g_object_unref0 (transient_for);
#line 92 "../lib/Utils.vala"
			block4_data_unref (_data4_);
#line 92 "../lib/Utils.vala"
			_data4_ = NULL;
#line 92 "../lib/Utils.vala"
			return result;
#line 582 "Utils.c"
		}
#line 88 "../lib/Utils.vala"
		_g_object_unref0 (icon);
#line 586 "Utils.c"
	}
#line 96 "../lib/Utils.vala"
	_tmp52_ = wm_class;
#line 96 "../lib/Utils.vala"
	_tmp53_ = gala_utils_lookup_desktop_wmclass (_tmp52_);
#line 96 "../lib/Utils.vala"
	_g_object_unref0 (_data4_->desktop_app);
#line 96 "../lib/Utils.vala"
	_data4_->desktop_app = _tmp53_;
#line 97 "../lib/Utils.vala"
	_tmp55_ = _data4_->desktop_app;
#line 97 "../lib/Utils.vala"
	if (_tmp55_ != NULL) {
#line 600 "Utils.c"
		GDesktopAppInfo* _tmp56_;
		const gchar* _tmp57_;
#line 97 "../lib/Utils.vala"
		_tmp56_ = _data4_->desktop_app;
#line 97 "../lib/Utils.vala"
		_tmp57_ = sandbox_id;
#line 97 "../lib/Utils.vala"
		_tmp54_ = gala_utils_check_app_prefix (_tmp56_, _tmp57_);
#line 609 "Utils.c"
	} else {
#line 97 "../lib/Utils.vala"
		_tmp54_ = FALSE;
#line 613 "Utils.c"
	}
#line 97 "../lib/Utils.vala"
	if (_tmp54_) {
#line 617 "Utils.c"
		GdkPixbuf* icon = NULL;
		GDesktopAppInfo* _tmp58_;
		GdkPixbuf* _tmp59_;
		GdkPixbuf* _tmp60_;
#line 98 "../lib/Utils.vala"
		_tmp58_ = _data4_->desktop_app;
#line 98 "../lib/Utils.vala"
		_tmp59_ = gala_utils_get_icon_for_desktop_app_info (_tmp58_, icon_size, scale);
#line 98 "../lib/Utils.vala"
		icon = _tmp59_;
#line 99 "../lib/Utils.vala"
		_tmp60_ = icon;
#line 99 "../lib/Utils.vala"
		if (_tmp60_ != NULL) {
#line 632 "Utils.c"
			GeeHashMap* _tmp61_;
			GDesktopAppInfo* _tmp62_;
#line 100 "../lib/Utils.vala"
			_tmp61_ = gala_utils_window_to_desktop_cache;
#line 100 "../lib/Utils.vala"
			_tmp62_ = _data4_->desktop_app;
#line 100 "../lib/Utils.vala"
			gee_abstract_map_set ((GeeAbstractMap*) _tmp61_, window, _tmp62_);
#line 101 "../lib/Utils.vala"
			result = icon;
#line 101 "../lib/Utils.vala"
			_g_free0 (wm_class);
#line 101 "../lib/Utils.vala"
			_g_free0 (wm_instance);
#line 101 "../lib/Utils.vala"
			_g_free0 (sandbox_id);
#line 101 "../lib/Utils.vala"
			_g_object_unref0 (transient_for);
#line 101 "../lib/Utils.vala"
			block4_data_unref (_data4_);
#line 101 "../lib/Utils.vala"
			_data4_ = NULL;
#line 101 "../lib/Utils.vala"
			return result;
#line 657 "Utils.c"
		}
#line 97 "../lib/Utils.vala"
		_g_object_unref0 (icon);
#line 661 "Utils.c"
	}
#line 105 "../lib/Utils.vala"
	_tmp63_ = sandbox_id;
#line 105 "../lib/Utils.vala"
	_tmp64_ = gala_utils_get_app_from_id (_tmp63_);
#line 105 "../lib/Utils.vala"
	_g_object_unref0 (_data4_->desktop_app);
#line 105 "../lib/Utils.vala"
	_data4_->desktop_app = _tmp64_;
#line 106 "../lib/Utils.vala"
	_tmp65_ = _data4_->desktop_app;
#line 106 "../lib/Utils.vala"
	if (_tmp65_ != NULL) {
#line 675 "Utils.c"
		GdkPixbuf* icon = NULL;
		GDesktopAppInfo* _tmp66_;
		GdkPixbuf* _tmp67_;
		GdkPixbuf* _tmp68_;
#line 107 "../lib/Utils.vala"
		_tmp66_ = _data4_->desktop_app;
#line 107 "../lib/Utils.vala"
		_tmp67_ = gala_utils_get_icon_for_desktop_app_info (_tmp66_, icon_size, scale);
#line 107 "../lib/Utils.vala"
		icon = _tmp67_;
#line 108 "../lib/Utils.vala"
		_tmp68_ = icon;
#line 108 "../lib/Utils.vala"
		if (_tmp68_ != NULL) {
#line 690 "Utils.c"
			GeeHashMap* _tmp69_;
			GDesktopAppInfo* _tmp70_;
#line 109 "../lib/Utils.vala"
			_tmp69_ = gala_utils_window_to_desktop_cache;
#line 109 "../lib/Utils.vala"
			_tmp70_ = _data4_->desktop_app;
#line 109 "../lib/Utils.vala"
			gee_abstract_map_set ((GeeAbstractMap*) _tmp69_, window, _tmp70_);
#line 110 "../lib/Utils.vala"
			result = icon;
#line 110 "../lib/Utils.vala"
			_g_free0 (wm_class);
#line 110 "../lib/Utils.vala"
			_g_free0 (wm_instance);
#line 110 "../lib/Utils.vala"
			_g_free0 (sandbox_id);
#line 110 "../lib/Utils.vala"
			_g_object_unref0 (transient_for);
#line 110 "../lib/Utils.vala"
			block4_data_unref (_data4_);
#line 110 "../lib/Utils.vala"
			_data4_ = NULL;
#line 110 "../lib/Utils.vala"
			return result;
#line 715 "Utils.c"
		}
#line 106 "../lib/Utils.vala"
		_g_object_unref0 (icon);
#line 719 "Utils.c"
	}
#line 114 "../lib/Utils.vala"
	_tmp71_ = meta_window_get_gtk_application_id (window);
#line 114 "../lib/Utils.vala"
	_tmp72_ = g_strdup (_tmp71_);
#line 114 "../lib/Utils.vala"
	gapplication_id = _tmp72_;
#line 115 "../lib/Utils.vala"
	_tmp73_ = gapplication_id;
#line 115 "../lib/Utils.vala"
	_tmp74_ = gala_utils_get_app_from_id (_tmp73_);
#line 115 "../lib/Utils.vala"
	_g_object_unref0 (_data4_->desktop_app);
#line 115 "../lib/Utils.vala"
	_data4_->desktop_app = _tmp74_;
#line 116 "../lib/Utils.vala"
	_tmp75_ = _data4_->desktop_app;
#line 116 "../lib/Utils.vala"
	if (_tmp75_ != NULL) {
#line 739 "Utils.c"
		GdkPixbuf* icon = NULL;
		GDesktopAppInfo* _tmp76_;
		GdkPixbuf* _tmp77_;
		GdkPixbuf* _tmp78_;
#line 117 "../lib/Utils.vala"
		_tmp76_ = _data4_->desktop_app;
#line 117 "../lib/Utils.vala"
		_tmp77_ = gala_utils_get_icon_for_desktop_app_info (_tmp76_, icon_size, scale);
#line 117 "../lib/Utils.vala"
		icon = _tmp77_;
#line 118 "../lib/Utils.vala"
		_tmp78_ = icon;
#line 118 "../lib/Utils.vala"
		if (_tmp78_ != NULL) {
#line 754 "Utils.c"
			GeeHashMap* _tmp79_;
			GDesktopAppInfo* _tmp80_;
#line 119 "../lib/Utils.vala"
			_tmp79_ = gala_utils_window_to_desktop_cache;
#line 119 "../lib/Utils.vala"
			_tmp80_ = _data4_->desktop_app;
#line 119 "../lib/Utils.vala"
			gee_abstract_map_set ((GeeAbstractMap*) _tmp79_, window, _tmp80_);
#line 120 "../lib/Utils.vala"
			result = icon;
#line 120 "../lib/Utils.vala"
			_g_free0 (gapplication_id);
#line 120 "../lib/Utils.vala"
			_g_free0 (wm_class);
#line 120 "../lib/Utils.vala"
			_g_free0 (wm_instance);
#line 120 "../lib/Utils.vala"
			_g_free0 (sandbox_id);
#line 120 "../lib/Utils.vala"
			_g_object_unref0 (transient_for);
#line 120 "../lib/Utils.vala"
			block4_data_unref (_data4_);
#line 120 "../lib/Utils.vala"
			_data4_ = NULL;
#line 120 "../lib/Utils.vala"
			return result;
#line 781 "Utils.c"
		}
#line 116 "../lib/Utils.vala"
		_g_object_unref0 (icon);
#line 785 "Utils.c"
	}
#line 124 "../lib/Utils.vala"
	if (meta_window_get_client_type (window) == META_WINDOW_CLIENT_TYPE_X11) {
#line 789 "Utils.c"
		MetaGroup* group = NULL;
		MetaGroup* _tmp81_;
		MetaGroup* _tmp82_;
#line 126 "../lib/Utils.vala"
		_tmp81_ = meta_window_x11_get_group (window);
#line 126 "../lib/Utils.vala"
		group = _tmp81_;
#line 130 "../lib/Utils.vala"
		_tmp82_ = group;
#line 130 "../lib/Utils.vala"
		if (_tmp82_ != NULL) {
#line 801 "Utils.c"
			GSList* group_windows = NULL;
			MetaGroup* _tmp83_;
			GSList* _tmp84_;
			GSList* _tmp85_;
			GDesktopAppInfo* _tmp86_;
#line 131 "../lib/Utils.vala"
			_tmp83_ = group;
#line 131 "../lib/Utils.vala"
			_tmp84_ = meta_group_list_windows (_tmp83_);
#line 131 "../lib/Utils.vala"
			group_windows = _tmp84_;
#line 132 "../lib/Utils.vala"
			_tmp85_ = group_windows;
#line 132 "../lib/Utils.vala"
			g_slist_foreach (_tmp85_, _____lambda9__gfunc, _data4_);
#line 142 "../lib/Utils.vala"
			_tmp86_ = _data4_->desktop_app;
#line 142 "../lib/Utils.vala"
			if (_tmp86_ != NULL) {
#line 821 "Utils.c"
				GdkPixbuf* icon = NULL;
				GDesktopAppInfo* _tmp87_;
				GdkPixbuf* _tmp88_;
				GdkPixbuf* _tmp89_;
#line 143 "../lib/Utils.vala"
				_tmp87_ = _data4_->desktop_app;
#line 143 "../lib/Utils.vala"
				_tmp88_ = gala_utils_get_icon_for_desktop_app_info (_tmp87_, icon_size, scale);
#line 143 "../lib/Utils.vala"
				icon = _tmp88_;
#line 144 "../lib/Utils.vala"
				_tmp89_ = icon;
#line 144 "../lib/Utils.vala"
				if (_tmp89_ != NULL) {
#line 836 "Utils.c"
					GeeHashMap* _tmp90_;
					GDesktopAppInfo* _tmp91_;
#line 145 "../lib/Utils.vala"
					_tmp90_ = gala_utils_window_to_desktop_cache;
#line 145 "../lib/Utils.vala"
					_tmp91_ = _data4_->desktop_app;
#line 145 "../lib/Utils.vala"
					gee_abstract_map_set ((GeeAbstractMap*) _tmp90_, window, _tmp91_);
#line 146 "../lib/Utils.vala"
					result = icon;
#line 146 "../lib/Utils.vala"
					(group_windows == NULL) ? NULL : (group_windows = (g_slist_free (group_windows), NULL));
#line 146 "../lib/Utils.vala"
					_g_free0 (gapplication_id);
#line 146 "../lib/Utils.vala"
					_g_free0 (wm_class);
#line 146 "../lib/Utils.vala"
					_g_free0 (wm_instance);
#line 146 "../lib/Utils.vala"
					_g_free0 (sandbox_id);
#line 146 "../lib/Utils.vala"
					_g_object_unref0 (transient_for);
#line 146 "../lib/Utils.vala"
					block4_data_unref (_data4_);
#line 146 "../lib/Utils.vala"
					_data4_ = NULL;
#line 146 "../lib/Utils.vala"
					return result;
#line 865 "Utils.c"
				}
#line 142 "../lib/Utils.vala"
				_g_object_unref0 (icon);
#line 869 "Utils.c"
			}
#line 130 "../lib/Utils.vala"
			(group_windows == NULL) ? NULL : (group_windows = (g_slist_free (group_windows), NULL));
#line 873 "Utils.c"
		}
	}
	{
		GeeArrayList* _icon_list = NULL;
		GeeArrayList* _tmp92_;
		gint _icon_size = 0;
		GeeArrayList* _tmp93_;
		gint _tmp94_;
		gint _tmp95_;
		gint _icon_index = 0;
#line 154 "../lib/Utils.vala"
		_tmp92_ = gala_utils_unknown_icon_cache;
#line 154 "../lib/Utils.vala"
		_icon_list = _tmp92_;
#line 154 "../lib/Utils.vala"
		_tmp93_ = _icon_list;
#line 154 "../lib/Utils.vala"
		_tmp94_ = gee_abstract_collection_get_size ((GeeAbstractCollection*) _tmp93_);
#line 154 "../lib/Utils.vala"
		_tmp95_ = _tmp94_;
#line 154 "../lib/Utils.vala"
		_icon_size = _tmp95_;
#line 154 "../lib/Utils.vala"
		_icon_index = -1;
#line 154 "../lib/Utils.vala"
		while (TRUE) {
#line 900 "Utils.c"
			gint _tmp96_;
			gint _tmp97_;
			GalaUtilsCachedIcon* icon = NULL;
			GeeArrayList* _tmp98_;
			gpointer _tmp99_;
			gboolean _tmp100_ = FALSE;
			GalaUtilsCachedIcon* _tmp101_;
#line 154 "../lib/Utils.vala"
			_icon_index = _icon_index + 1;
#line 154 "../lib/Utils.vala"
			_tmp96_ = _icon_index;
#line 154 "../lib/Utils.vala"
			_tmp97_ = _icon_size;
#line 154 "../lib/Utils.vala"
			if (!(_tmp96_ < _tmp97_)) {
#line 154 "../lib/Utils.vala"
				break;
#line 918 "Utils.c"
			}
#line 154 "../lib/Utils.vala"
			_tmp98_ = _icon_list;
#line 154 "../lib/Utils.vala"
			_tmp99_ = gee_abstract_list_get ((GeeAbstractList*) _tmp98_, _icon_index);
#line 154 "../lib/Utils.vala"
			icon = (GalaUtilsCachedIcon*) _tmp99_;
#line 155 "../lib/Utils.vala"
			_tmp101_ = icon;
#line 155 "../lib/Utils.vala"
			if ((*_tmp101_).icon_size == icon_size) {
#line 930 "Utils.c"
				GalaUtilsCachedIcon* _tmp102_;
#line 155 "../lib/Utils.vala"
				_tmp102_ = icon;
#line 155 "../lib/Utils.vala"
				_tmp100_ = (*_tmp102_).scale == scale;
#line 936 "Utils.c"
			} else {
#line 155 "../lib/Utils.vala"
				_tmp100_ = FALSE;
#line 940 "Utils.c"
			}
#line 155 "../lib/Utils.vala"
			if (_tmp100_) {
#line 944 "Utils.c"
				GalaUtilsCachedIcon* _tmp103_;
				GdkPixbuf* _tmp104_;
				GdkPixbuf* _tmp105_;
#line 156 "../lib/Utils.vala"
				_tmp103_ = icon;
#line 156 "../lib/Utils.vala"
				_tmp104_ = (*_tmp103_).icon;
#line 156 "../lib/Utils.vala"
				_tmp105_ = _g_object_ref0 (_tmp104_);
#line 156 "../lib/Utils.vala"
				result = _tmp105_;
#line 156 "../lib/Utils.vala"
				_gala_utils_cached_icon_free0 (icon);
#line 156 "../lib/Utils.vala"
				_g_free0 (gapplication_id);
#line 156 "../lib/Utils.vala"
				_g_free0 (wm_class);
#line 156 "../lib/Utils.vala"
				_g_free0 (wm_instance);
#line 156 "../lib/Utils.vala"
				_g_free0 (sandbox_id);
#line 156 "../lib/Utils.vala"
				_g_object_unref0 (transient_for);
#line 156 "../lib/Utils.vala"
				block4_data_unref (_data4_);
#line 156 "../lib/Utils.vala"
				_data4_ = NULL;
#line 156 "../lib/Utils.vala"
				return result;
#line 974 "Utils.c"
			}
#line 154 "../lib/Utils.vala"
			_gala_utils_cached_icon_free0 (icon);
#line 978 "Utils.c"
		}
	}
	{
		GdkPixbuf* icon = NULL;
		GtkIconTheme* _tmp106_;
		GdkPixbuf* _tmp107_;
		GeeArrayList* _tmp108_;
		GdkPixbuf* _tmp109_;
		GdkPixbuf* _tmp110_;
		GalaUtilsCachedIcon _tmp111_ = {0};
		GalaUtilsCachedIcon _tmp112_;
		GalaUtilsCachedIcon _tmp113_;
#line 162 "../lib/Utils.vala"
		_tmp106_ = gala_utils_icon_theme;
#line 162 "../lib/Utils.vala"
		_tmp107_ = gtk_icon_theme_load_icon_for_scale (_tmp106_, "application-default-icon", icon_size, scale, 0, &_inner_error0_);
#line 162 "../lib/Utils.vala"
		icon = _tmp107_;
#line 162 "../lib/Utils.vala"
		if (G_UNLIKELY (_inner_error0_ != NULL)) {
#line 999 "Utils.c"
			goto __catch0_g_error;
		}
#line 163 "../lib/Utils.vala"
		_tmp108_ = gala_utils_unknown_icon_cache;
#line 163 "../lib/Utils.vala"
		_tmp109_ = icon;
#line 163 "../lib/Utils.vala"
		_tmp110_ = _g_object_ref0 (_tmp109_);
#line 163 "../lib/Utils.vala"
		memset (&_tmp111_, 0, sizeof (GalaUtilsCachedIcon));
#line 163 "../lib/Utils.vala"
		_g_object_unref0 (_tmp111_.icon);
#line 163 "../lib/Utils.vala"
		_tmp111_.icon = _tmp110_;
#line 163 "../lib/Utils.vala"
		_tmp111_.icon_size = icon_size;
#line 163 "../lib/Utils.vala"
		_tmp111_.scale = scale;
#line 163 "../lib/Utils.vala"
		_tmp112_ = _tmp111_;
#line 163 "../lib/Utils.vala"
		_tmp113_ = _tmp112_;
#line 163 "../lib/Utils.vala"
		gee_abstract_collection_add ((GeeAbstractCollection*) _tmp108_, &_tmp113_);
#line 163 "../lib/Utils.vala"
		gala_utils_cached_icon_destroy (&_tmp112_);
#line 164 "../lib/Utils.vala"
		result = icon;
#line 164 "../lib/Utils.vala"
		_g_free0 (gapplication_id);
#line 164 "../lib/Utils.vala"
		_g_free0 (wm_class);
#line 164 "../lib/Utils.vala"
		_g_free0 (wm_instance);
#line 164 "../lib/Utils.vala"
		_g_free0 (sandbox_id);
#line 164 "../lib/Utils.vala"
		_g_object_unref0 (transient_for);
#line 164 "../lib/Utils.vala"
		block4_data_unref (_data4_);
#line 164 "../lib/Utils.vala"
		_data4_ = NULL;
#line 164 "../lib/Utils.vala"
		return result;
#line 1044 "Utils.c"
	}
	goto __finally0;
	__catch0_g_error:
	{
		GdkPixbuf* icon = NULL;
		GdkPixbuf* _tmp114_;
		GdkPixbuf* _tmp115_;
#line 161 "../lib/Utils.vala"
		g_clear_error (&_inner_error0_);
#line 166 "../lib/Utils.vala"
		_tmp114_ = gdk_pixbuf_new (GDK_COLORSPACE_RGB, TRUE, 8, icon_size * scale, icon_size * scale);
#line 166 "../lib/Utils.vala"
		icon = _tmp114_;
#line 167 "../lib/Utils.vala"
		_tmp115_ = icon;
#line 167 "../lib/Utils.vala"
		gdk_pixbuf_fill (_tmp115_, (guint32) 0x00000000);
#line 168 "../lib/Utils.vala"
		result = icon;
#line 168 "../lib/Utils.vala"
		_g_free0 (gapplication_id);
#line 168 "../lib/Utils.vala"
		_g_free0 (wm_class);
#line 168 "../lib/Utils.vala"
		_g_free0 (wm_instance);
#line 168 "../lib/Utils.vala"
		_g_free0 (sandbox_id);
#line 168 "../lib/Utils.vala"
		_g_object_unref0 (transient_for);
#line 168 "../lib/Utils.vala"
		block4_data_unref (_data4_);
#line 168 "../lib/Utils.vala"
		_data4_ = NULL;
#line 168 "../lib/Utils.vala"
		return result;
#line 1080 "Utils.c"
	}
	__finally0:
#line 161 "../lib/Utils.vala"
	_g_free0 (gapplication_id);
#line 161 "../lib/Utils.vala"
	_g_free0 (wm_class);
#line 161 "../lib/Utils.vala"
	_g_free0 (wm_instance);
#line 161 "../lib/Utils.vala"
	_g_free0 (sandbox_id);
#line 161 "../lib/Utils.vala"
	_g_object_unref0 (transient_for);
#line 161 "../lib/Utils.vala"
	block4_data_unref (_data4_);
#line 161 "../lib/Utils.vala"
	_data4_ = NULL;
#line 161 "../lib/Utils.vala"
	g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error0_->message, g_quark_to_string (_inner_error0_->domain), _inner_error0_->code);
#line 161 "../lib/Utils.vala"
	g_clear_error (&_inner_error0_);
#line 161 "../lib/Utils.vala"
	return NULL;
#line 1103 "Utils.c"
}

static gboolean
gala_utils_check_app_prefix (GDesktopAppInfo* app,
                             const gchar* sandbox_id)
{
	gchar* prefix = NULL;
	gchar* _tmp0_;
	const gchar* _tmp1_;
	const gchar* _tmp2_;
	gboolean result;
#line 172 "../lib/Utils.vala"
	g_return_val_if_fail (app != NULL, FALSE);
#line 173 "../lib/Utils.vala"
	if (sandbox_id == NULL) {
#line 174 "../lib/Utils.vala"
		result = TRUE;
#line 174 "../lib/Utils.vala"
		return result;
#line 1123 "Utils.c"
	}
#line 177 "../lib/Utils.vala"
	_tmp0_ = g_strdup_printf ("%s.", sandbox_id);
#line 177 "../lib/Utils.vala"
	prefix = _tmp0_;
#line 179 "../lib/Utils.vala"
	_tmp1_ = g_app_info_get_id ((GAppInfo*) app);
#line 179 "../lib/Utils.vala"
	_tmp2_ = prefix;
#line 179 "../lib/Utils.vala"
	if (g_str_has_prefix (_tmp1_, _tmp2_)) {
#line 180 "../lib/Utils.vala"
		result = TRUE;
#line 180 "../lib/Utils.vala"
		_g_free0 (prefix);
#line 180 "../lib/Utils.vala"
		return result;
#line 1141 "Utils.c"
	}
#line 183 "../lib/Utils.vala"
	result = FALSE;
#line 183 "../lib/Utils.vala"
	_g_free0 (prefix);
#line 183 "../lib/Utils.vala"
	return result;
#line 1149 "Utils.c"
}

void
gala_utils_clear_window_cache (MetaWindow* window)
{
	GDesktopAppInfo* desktop = NULL;
	GeeHashMap* _tmp0_;
	gpointer _tmp1_;
	GDesktopAppInfo* _tmp2_;
#line 186 "../lib/Utils.vala"
	g_return_if_fail (window != NULL);
#line 187 "../lib/Utils.vala"
	_tmp0_ = gala_utils_window_to_desktop_cache;
#line 187 "../lib/Utils.vala"
	_tmp1_ = gee_abstract_map_get ((GeeAbstractMap*) _tmp0_, window);
#line 187 "../lib/Utils.vala"
	desktop = (GDesktopAppInfo*) _tmp1_;
#line 188 "../lib/Utils.vala"
	_tmp2_ = desktop;
#line 188 "../lib/Utils.vala"
	if (_tmp2_ != NULL) {
#line 1171 "Utils.c"
		GeeHashMultiMap* _tmp3_;
		GDesktopAppInfo* _tmp4_;
		GeeHashMap* _tmp5_;
#line 189 "../lib/Utils.vala"
		_tmp3_ = gala_utils_icon_cache;
#line 189 "../lib/Utils.vala"
		_tmp4_ = desktop;
#line 189 "../lib/Utils.vala"
		gee_multi_map_remove_all ((GeeMultiMap*) _tmp3_, _tmp4_);
#line 190 "../lib/Utils.vala"
		_tmp5_ = gala_utils_window_to_desktop_cache;
#line 190 "../lib/Utils.vala"
		gee_abstract_map_unset ((GeeAbstractMap*) _tmp5_, window, NULL);
#line 1185 "Utils.c"
	}
#line 186 "../lib/Utils.vala"
	_g_object_unref0 (desktop);
#line 1189 "Utils.c"
}

static GDesktopAppInfo*
gala_utils_get_app_from_id (const gchar* id)
{
	gchar* desktop_file = NULL;
	gchar* _tmp0_;
	GalaAppCache* _tmp1_;
	const gchar* _tmp2_;
	GDesktopAppInfo* _tmp3_;
	GDesktopAppInfo* _tmp4_;
	GDesktopAppInfo* result;
#line 195 "../lib/Utils.vala"
	if (id == NULL) {
#line 196 "../lib/Utils.vala"
		result = NULL;
#line 196 "../lib/Utils.vala"
		return result;
#line 1208 "Utils.c"
	}
#line 199 "../lib/Utils.vala"
	_tmp0_ = g_strdup_printf ("%s.desktop", id);
#line 199 "../lib/Utils.vala"
	desktop_file = _tmp0_;
#line 200 "../lib/Utils.vala"
	_tmp1_ = gala_utils_app_cache;
#line 200 "../lib/Utils.vala"
	_tmp2_ = desktop_file;
#line 200 "../lib/Utils.vala"
	_tmp3_ = gala_app_cache_lookup_id (_tmp1_, _tmp2_);
#line 200 "../lib/Utils.vala"
	_tmp4_ = _g_object_ref0 (_tmp3_);
#line 200 "../lib/Utils.vala"
	result = _tmp4_;
#line 200 "../lib/Utils.vala"
	_g_free0 (desktop_file);
#line 200 "../lib/Utils.vala"
	return result;
#line 1228 "Utils.c"
}

static gchar*
string_delimit (const gchar* self,
                const gchar* delimiters,
                gchar new_delimiter)
{
	gchar* _result_ = NULL;
	gchar* _tmp0_;
	gchar* result;
#line 1421 "glib-2.0.vapi"
	g_return_val_if_fail (self != NULL, NULL);
#line 1421 "glib-2.0.vapi"
	g_return_val_if_fail (delimiters != NULL, NULL);
#line 1422 "glib-2.0.vapi"
	_tmp0_ = g_strdup (self);
#line 1422 "glib-2.0.vapi"
	_result_ = _tmp0_;
#line 1423 "glib-2.0.vapi"
	g_strdelimit (_result_, delimiters, new_delimiter);
#line 1424 "glib-2.0.vapi"
	result = _result_;
#line 1424 "glib-2.0.vapi"
	return result;
#line 1253 "Utils.c"
}

static GDesktopAppInfo*
gala_utils_lookup_desktop_wmclass (const gchar* wm_class)
{
	GDesktopAppInfo* desktop_info = NULL;
	GDesktopAppInfo* _tmp0_;
	GDesktopAppInfo* _tmp1_;
	gchar* canonicalized = NULL;
	gchar* _tmp2_;
	gchar* _tmp3_;
	gchar* _tmp4_;
	gchar* _tmp5_;
	const gchar* _tmp6_;
	GDesktopAppInfo* _tmp7_;
	GDesktopAppInfo* result;
#line 204 "../lib/Utils.vala"
	if (wm_class == NULL) {
#line 205 "../lib/Utils.vala"
		result = NULL;
#line 205 "../lib/Utils.vala"
		return result;
#line 1276 "Utils.c"
	}
#line 208 "../lib/Utils.vala"
	_tmp0_ = gala_utils_get_app_from_id (wm_class);
#line 208 "../lib/Utils.vala"
	desktop_info = _tmp0_;
#line 210 "../lib/Utils.vala"
	_tmp1_ = desktop_info;
#line 210 "../lib/Utils.vala"
	if (_tmp1_ != NULL) {
#line 211 "../lib/Utils.vala"
		result = desktop_info;
#line 211 "../lib/Utils.vala"
		return result;
#line 1290 "Utils.c"
	}
#line 214 "../lib/Utils.vala"
	_tmp2_ = g_ascii_strdown (wm_class, (gssize) -1);
#line 214 "../lib/Utils.vala"
	_tmp3_ = _tmp2_;
#line 214 "../lib/Utils.vala"
	_tmp4_ = string_delimit (_tmp3_, " ", '-');
#line 214 "../lib/Utils.vala"
	_tmp5_ = _tmp4_;
#line 214 "../lib/Utils.vala"
	_g_free0 (_tmp3_);
#line 214 "../lib/Utils.vala"
	canonicalized = _tmp5_;
#line 215 "../lib/Utils.vala"
	_tmp6_ = canonicalized;
#line 215 "../lib/Utils.vala"
	_tmp7_ = gala_utils_get_app_from_id (_tmp6_);
#line 215 "../lib/Utils.vala"
	result = _tmp7_;
#line 215 "../lib/Utils.vala"
	_g_free0 (canonicalized);
#line 215 "../lib/Utils.vala"
	_g_object_unref0 (desktop_info);
#line 215 "../lib/Utils.vala"
	return result;
#line 1316 "Utils.c"
}

static gchar**
_vala_array_dup3 (gchar** self,
                  gssize length)
{
#line 230 "../lib/Utils.vala"
	if (length >= 0) {
#line 1325 "Utils.c"
		gchar** result;
		gssize i;
#line 230 "../lib/Utils.vala"
		result = g_new0 (gchar*, length + 1);
#line 230 "../lib/Utils.vala"
		for (i = 0; i < length; i++) {
#line 1332 "Utils.c"
			gchar* _tmp0_;
#line 230 "../lib/Utils.vala"
			_tmp0_ = g_strdup (self[i]);
#line 230 "../lib/Utils.vala"
			result[i] = _tmp0_;
#line 1338 "Utils.c"
		}
#line 230 "../lib/Utils.vala"
		return result;
#line 1342 "Utils.c"
	}
#line 230 "../lib/Utils.vala"
	return NULL;
#line 1346 "Utils.c"
}

static GdkPixbuf*
gala_utils_get_icon_for_desktop_app_info (GDesktopAppInfo* desktop,
                                          gint icon_size,
                                          gint scale)
{
	GeeHashMultiMap* _tmp0_;
	GIcon* icon = NULL;
	GIcon* _tmp15_;
	GIcon* _tmp16_;
	GIcon* _tmp17_;
	GError* _inner_error0_ = NULL;
	GdkPixbuf* result;
#line 218 "../lib/Utils.vala"
	g_return_val_if_fail (desktop != NULL, NULL);
#line 219 "../lib/Utils.vala"
	_tmp0_ = gala_utils_icon_cache;
#line 219 "../lib/Utils.vala"
	if (gee_multi_map_contains ((GeeMultiMap*) _tmp0_, desktop)) {
#line 1367 "Utils.c"
		{
			GeeIterator* _icon_it = NULL;
			GeeHashMultiMap* _tmp1_;
			GeeCollection* _tmp2_;
			GeeCollection* _tmp3_;
			GeeIterator* _tmp4_;
			GeeIterator* _tmp5_;
#line 220 "../lib/Utils.vala"
			_tmp1_ = gala_utils_icon_cache;
#line 220 "../lib/Utils.vala"
			_tmp2_ = gee_multi_map_get ((GeeMultiMap*) _tmp1_, desktop);
#line 220 "../lib/Utils.vala"
			_tmp3_ = _tmp2_;
#line 220 "../lib/Utils.vala"
			_tmp4_ = gee_iterable_iterator ((GeeIterable*) _tmp3_);
#line 220 "../lib/Utils.vala"
			_tmp5_ = _tmp4_;
#line 220 "../lib/Utils.vala"
			_g_object_unref0 (_tmp3_);
#line 220 "../lib/Utils.vala"
			_icon_it = _tmp5_;
#line 220 "../lib/Utils.vala"
			while (TRUE) {
#line 1391 "Utils.c"
				GeeIterator* _tmp6_;
				GalaUtilsCachedIcon* icon = NULL;
				GeeIterator* _tmp7_;
				gpointer _tmp8_;
				gboolean _tmp9_ = FALSE;
				GalaUtilsCachedIcon* _tmp10_;
#line 220 "../lib/Utils.vala"
				_tmp6_ = _icon_it;
#line 220 "../lib/Utils.vala"
				if (!gee_iterator_next (_tmp6_)) {
#line 220 "../lib/Utils.vala"
					break;
#line 1404 "Utils.c"
				}
#line 220 "../lib/Utils.vala"
				_tmp7_ = _icon_it;
#line 220 "../lib/Utils.vala"
				_tmp8_ = gee_iterator_get (_tmp7_);
#line 220 "../lib/Utils.vala"
				icon = (GalaUtilsCachedIcon*) _tmp8_;
#line 221 "../lib/Utils.vala"
				_tmp10_ = icon;
#line 221 "../lib/Utils.vala"
				if ((*_tmp10_).icon_size == icon_size) {
#line 1416 "Utils.c"
					GalaUtilsCachedIcon* _tmp11_;
#line 221 "../lib/Utils.vala"
					_tmp11_ = icon;
#line 221 "../lib/Utils.vala"
					_tmp9_ = (*_tmp11_).scale == scale;
#line 1422 "Utils.c"
				} else {
#line 221 "../lib/Utils.vala"
					_tmp9_ = FALSE;
#line 1426 "Utils.c"
				}
#line 221 "../lib/Utils.vala"
				if (_tmp9_) {
#line 1430 "Utils.c"
					GalaUtilsCachedIcon* _tmp12_;
					GdkPixbuf* _tmp13_;
					GdkPixbuf* _tmp14_;
#line 222 "../lib/Utils.vala"
					_tmp12_ = icon;
#line 222 "../lib/Utils.vala"
					_tmp13_ = (*_tmp12_).icon;
#line 222 "../lib/Utils.vala"
					_tmp14_ = _g_object_ref0 (_tmp13_);
#line 222 "../lib/Utils.vala"
					result = _tmp14_;
#line 222 "../lib/Utils.vala"
					_gala_utils_cached_icon_free0 (icon);
#line 222 "../lib/Utils.vala"
					_g_object_unref0 (_icon_it);
#line 222 "../lib/Utils.vala"
					return result;
#line 1448 "Utils.c"
				}
#line 220 "../lib/Utils.vala"
				_gala_utils_cached_icon_free0 (icon);
#line 1452 "Utils.c"
			}
#line 220 "../lib/Utils.vala"
			_g_object_unref0 (_icon_it);
#line 1456 "Utils.c"
		}
	}
#line 227 "../lib/Utils.vala"
	_tmp15_ = g_app_info_get_icon ((GAppInfo*) desktop);
#line 227 "../lib/Utils.vala"
	_tmp16_ = _g_object_ref0 (_tmp15_);
#line 227 "../lib/Utils.vala"
	icon = _tmp16_;
#line 229 "../lib/Utils.vala"
	_tmp17_ = icon;
#line 229 "../lib/Utils.vala"
	if (G_TYPE_CHECK_INSTANCE_TYPE (_tmp17_, g_themed_icon_get_type ())) {
#line 1469 "Utils.c"
		gchar** icon_names = NULL;
		GIcon* _tmp18_;
		gchar** _tmp19_;
		gchar** _tmp20_;
		gchar** _tmp21_;
		gint _tmp21__length1;
		gint icon_names_length1;
		gint _icon_names_size_;
		GtkIconInfo* icon_info = NULL;
		GtkIconTheme* _tmp22_;
		gchar** _tmp23_;
		gint _tmp23__length1;
		GtkIconInfo* _tmp24_;
		GtkIconInfo* _tmp25_;
#line 230 "../lib/Utils.vala"
		_tmp18_ = icon;
#line 230 "../lib/Utils.vala"
		_tmp20_ = _tmp19_ = g_themed_icon_get_names (G_TYPE_CHECK_INSTANCE_CAST (_tmp18_, g_themed_icon_get_type (), GThemedIcon));
#line 230 "../lib/Utils.vala"
		_tmp21_ = (_tmp20_ != NULL) ? _vala_array_dup3 (_tmp20_, _vala_array_length (_tmp19_)) : _tmp20_;
#line 230 "../lib/Utils.vala"
		_tmp21__length1 = _vala_array_length (_tmp19_);
#line 230 "../lib/Utils.vala"
		icon_names = _tmp21_;
#line 230 "../lib/Utils.vala"
		icon_names_length1 = _tmp21__length1;
#line 230 "../lib/Utils.vala"
		_icon_names_size_ = icon_names_length1;
#line 231 "../lib/Utils.vala"
		_tmp22_ = gala_utils_icon_theme;
#line 231 "../lib/Utils.vala"
		_tmp23_ = icon_names;
#line 231 "../lib/Utils.vala"
		_tmp23__length1 = icon_names_length1;
#line 231 "../lib/Utils.vala"
		_tmp24_ = gtk_icon_theme_choose_icon_for_scale (_tmp22_, _tmp23_, icon_size, scale, 0);
#line 231 "../lib/Utils.vala"
		icon_info = _tmp24_;
#line 233 "../lib/Utils.vala"
		_tmp25_ = icon_info;
#line 233 "../lib/Utils.vala"
		if (_tmp25_ == NULL) {
#line 234 "../lib/Utils.vala"
			result = NULL;
#line 234 "../lib/Utils.vala"
			_g_object_unref0 (icon_info);
#line 234 "../lib/Utils.vala"
			icon_names = (_vala_array_free (icon_names, icon_names_length1, (GDestroyNotify) g_free), NULL);
#line 234 "../lib/Utils.vala"
			_g_object_unref0 (icon);
#line 234 "../lib/Utils.vala"
			return result;
#line 1522 "Utils.c"
		}
		{
			GdkPixbuf* pixbuf = NULL;
			GtkIconInfo* _tmp26_;
			GdkPixbuf* _tmp27_;
			GeeHashMultiMap* _tmp28_;
			GdkPixbuf* _tmp29_;
			GdkPixbuf* _tmp30_;
			GalaUtilsCachedIcon _tmp31_ = {0};
			GalaUtilsCachedIcon _tmp32_;
			GalaUtilsCachedIcon _tmp33_;
#line 238 "../lib/Utils.vala"
			_tmp26_ = icon_info;
#line 238 "../lib/Utils.vala"
			_tmp27_ = gtk_icon_info_load_icon (_tmp26_, &_inner_error0_);
#line 238 "../lib/Utils.vala"
			pixbuf = _tmp27_;
#line 238 "../lib/Utils.vala"
			if (G_UNLIKELY (_inner_error0_ != NULL)) {
#line 1542 "Utils.c"
				goto __catch0_g_error;
			}
#line 239 "../lib/Utils.vala"
			_tmp28_ = gala_utils_icon_cache;
#line 239 "../lib/Utils.vala"
			_tmp29_ = pixbuf;
#line 239 "../lib/Utils.vala"
			_tmp30_ = _g_object_ref0 (_tmp29_);
#line 239 "../lib/Utils.vala"
			memset (&_tmp31_, 0, sizeof (GalaUtilsCachedIcon));
#line 239 "../lib/Utils.vala"
			_g_object_unref0 (_tmp31_.icon);
#line 239 "../lib/Utils.vala"
			_tmp31_.icon = _tmp30_;
#line 239 "../lib/Utils.vala"
			_tmp31_.icon_size = icon_size;
#line 239 "../lib/Utils.vala"
			_tmp31_.scale = scale;
#line 239 "../lib/Utils.vala"
			_tmp32_ = _tmp31_;
#line 239 "../lib/Utils.vala"
			_tmp33_ = _tmp32_;
#line 239 "../lib/Utils.vala"
			gee_multi_map_set ((GeeMultiMap*) _tmp28_, desktop, &_tmp33_);
#line 239 "../lib/Utils.vala"
			gala_utils_cached_icon_destroy (&_tmp32_);
#line 240 "../lib/Utils.vala"
			result = pixbuf;
#line 240 "../lib/Utils.vala"
			_g_object_unref0 (icon_info);
#line 240 "../lib/Utils.vala"
			icon_names = (_vala_array_free (icon_names, icon_names_length1, (GDestroyNotify) g_free), NULL);
#line 240 "../lib/Utils.vala"
			_g_object_unref0 (icon);
#line 240 "../lib/Utils.vala"
			return result;
#line 1579 "Utils.c"
		}
		goto __finally0;
		__catch0_g_error:
		{
#line 237 "../lib/Utils.vala"
			g_clear_error (&_inner_error0_);
#line 242 "../lib/Utils.vala"
			result = NULL;
#line 242 "../lib/Utils.vala"
			_g_object_unref0 (icon_info);
#line 242 "../lib/Utils.vala"
			icon_names = (_vala_array_free (icon_names, icon_names_length1, (GDestroyNotify) g_free), NULL);
#line 242 "../lib/Utils.vala"
			_g_object_unref0 (icon);
#line 242 "../lib/Utils.vala"
			return result;
#line 1596 "Utils.c"
		}
		__finally0:
#line 237 "../lib/Utils.vala"
		_g_object_unref0 (icon_info);
#line 237 "../lib/Utils.vala"
		icon_names = (_vala_array_free (icon_names, icon_names_length1, (GDestroyNotify) g_free), NULL);
#line 237 "../lib/Utils.vala"
		_g_object_unref0 (icon);
#line 237 "../lib/Utils.vala"
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error0_->message, g_quark_to_string (_inner_error0_->domain), _inner_error0_->code);
#line 237 "../lib/Utils.vala"
		g_clear_error (&_inner_error0_);
#line 237 "../lib/Utils.vala"
		return NULL;
#line 1611 "Utils.c"
	} else {
		GIcon* _tmp34_;
#line 244 "../lib/Utils.vala"
		_tmp34_ = icon;
#line 244 "../lib/Utils.vala"
		if (G_TYPE_CHECK_INSTANCE_TYPE (_tmp34_, g_file_icon_get_type ())) {
#line 1618 "Utils.c"
			GFile* file = NULL;
			GIcon* _tmp35_;
			GFile* _tmp36_;
			GFile* _tmp37_;
			GFile* _tmp38_;
			gint size_with_scale = 0;
#line 245 "../lib/Utils.vala"
			_tmp35_ = icon;
#line 245 "../lib/Utils.vala"
			_tmp36_ = g_file_icon_get_file (G_TYPE_CHECK_INSTANCE_CAST (_tmp35_, g_file_icon_get_type (), GFileIcon));
#line 245 "../lib/Utils.vala"
			_tmp37_ = _tmp36_;
#line 245 "../lib/Utils.vala"
			_tmp38_ = _g_object_ref0 (_tmp37_);
#line 245 "../lib/Utils.vala"
			file = _tmp38_;
#line 246 "../lib/Utils.vala"
			size_with_scale = icon_size * scale;
#line 1637 "Utils.c"
			{
				GFileInputStream* _tmp39_ = NULL;
				GFile* _tmp40_;
				GFileInputStream* _tmp41_;
				GdkPixbuf* pixbuf = NULL;
				GdkPixbuf* _tmp42_;
				GeeHashMultiMap* _tmp43_;
				GdkPixbuf* _tmp44_;
				GdkPixbuf* _tmp45_;
				GalaUtilsCachedIcon _tmp46_ = {0};
				GalaUtilsCachedIcon _tmp47_;
				GalaUtilsCachedIcon _tmp48_;
#line 248 "../lib/Utils.vala"
				_tmp40_ = file;
#line 248 "../lib/Utils.vala"
				_tmp41_ = g_file_read (_tmp40_, NULL, &_inner_error0_);
#line 248 "../lib/Utils.vala"
				_tmp39_ = _tmp41_;
#line 248 "../lib/Utils.vala"
				if (G_UNLIKELY (_inner_error0_ != NULL)) {
#line 1658 "Utils.c"
					goto __catch1_g_error;
				}
#line 248 "../lib/Utils.vala"
				_tmp42_ = gdk_pixbuf_new_from_stream_at_scale ((GInputStream*) _tmp39_, size_with_scale, size_with_scale, TRUE, NULL, &_inner_error0_);
#line 248 "../lib/Utils.vala"
				pixbuf = _tmp42_;
#line 248 "../lib/Utils.vala"
				if (G_UNLIKELY (_inner_error0_ != NULL)) {
#line 248 "../lib/Utils.vala"
					_g_object_unref0 (_tmp39_);
#line 1669 "Utils.c"
					goto __catch1_g_error;
				}
#line 249 "../lib/Utils.vala"
				_tmp43_ = gala_utils_icon_cache;
#line 249 "../lib/Utils.vala"
				_tmp44_ = pixbuf;
#line 249 "../lib/Utils.vala"
				_tmp45_ = _g_object_ref0 (_tmp44_);
#line 249 "../lib/Utils.vala"
				memset (&_tmp46_, 0, sizeof (GalaUtilsCachedIcon));
#line 249 "../lib/Utils.vala"
				_g_object_unref0 (_tmp46_.icon);
#line 249 "../lib/Utils.vala"
				_tmp46_.icon = _tmp45_;
#line 249 "../lib/Utils.vala"
				_tmp46_.icon_size = icon_size;
#line 249 "../lib/Utils.vala"
				_tmp46_.scale = scale;
#line 249 "../lib/Utils.vala"
				_tmp47_ = _tmp46_;
#line 249 "../lib/Utils.vala"
				_tmp48_ = _tmp47_;
#line 249 "../lib/Utils.vala"
				gee_multi_map_set ((GeeMultiMap*) _tmp43_, desktop, &_tmp48_);
#line 249 "../lib/Utils.vala"
				gala_utils_cached_icon_destroy (&_tmp47_);
#line 250 "../lib/Utils.vala"
				result = pixbuf;
#line 250 "../lib/Utils.vala"
				_g_object_unref0 (_tmp39_);
#line 250 "../lib/Utils.vala"
				_g_object_unref0 (file);
#line 250 "../lib/Utils.vala"
				_g_object_unref0 (icon);
#line 250 "../lib/Utils.vala"
				return result;
#line 1706 "Utils.c"
			}
			goto __finally1;
			__catch1_g_error:
			{
#line 247 "../lib/Utils.vala"
				g_clear_error (&_inner_error0_);
#line 252 "../lib/Utils.vala"
				result = NULL;
#line 252 "../lib/Utils.vala"
				_g_object_unref0 (file);
#line 252 "../lib/Utils.vala"
				_g_object_unref0 (icon);
#line 252 "../lib/Utils.vala"
				return result;
#line 1721 "Utils.c"
			}
			__finally1:
#line 247 "../lib/Utils.vala"
			_g_object_unref0 (file);
#line 247 "../lib/Utils.vala"
			_g_object_unref0 (icon);
#line 247 "../lib/Utils.vala"
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error0_->message, g_quark_to_string (_inner_error0_->domain), _inner_error0_->code);
#line 247 "../lib/Utils.vala"
			g_clear_error (&_inner_error0_);
#line 247 "../lib/Utils.vala"
			return NULL;
#line 1734 "Utils.c"
		}
	}
#line 256 "../lib/Utils.vala"
	result = NULL;
#line 256 "../lib/Utils.vala"
	_g_object_unref0 (icon);
#line 256 "../lib/Utils.vala"
	return result;
#line 1743 "Utils.c"
}

/**
         * Multiplies an integer by a floating scaling factor, and then
         * returns the result rounded to the nearest integer
         */
gint
gala_utils_scale_to_int (gint value,
                         gfloat scale_factor)
{
	gint result;
#line 264 "../lib/Utils.vala"
	result = (gint) round ((gdouble) (((gfloat) value) * scale_factor));
#line 264 "../lib/Utils.vala"
	return result;
#line 1759 "Utils.c"
}

/**
         * Get the number of toplevel windows on a workspace excluding those that are
         * on all workspaces
         *
         * @param workspace The workspace on which to count the windows
         */
guint
gala_utils_get_n_windows (MetaWorkspace* workspace,
                          gboolean on_primary)
{
	gint n = 0;
	GList* _tmp0_;
	guint result;
#line 273 "../lib/Utils.vala"
	g_return_val_if_fail (workspace != NULL, 0U);
#line 274 "../lib/Utils.vala"
	n = 0;
#line 275 "../lib/Utils.vala"
	_tmp0_ = meta_workspace_list_windows (workspace);
#line 1781 "Utils.c"
	{
		GList* window_collection = NULL;
		GList* window_it = NULL;
#line 275 "../lib/Utils.vala"
		window_collection = _tmp0_;
#line 275 "../lib/Utils.vala"
		for (window_it = window_collection; window_it != NULL; window_it = window_it->next) {
#line 1789 "Utils.c"
			MetaWindow* window = NULL;
#line 275 "../lib/Utils.vala"
			window = (MetaWindow*) window_it->data;
#line 1793 "Utils.c"
			{
				MetaWindow* _tmp1_;
				gboolean _tmp2_;
				gboolean _tmp3_;
				gboolean _tmp4_ = FALSE;
				gboolean _tmp5_ = FALSE;
				gboolean _tmp6_ = FALSE;
				MetaWindow* _tmp7_;
				MetaWindowType _tmp8_;
				MetaWindowType _tmp9_;
#line 276 "../lib/Utils.vala"
				_tmp1_ = window;
#line 276 "../lib/Utils.vala"
				g_object_get (_tmp1_, "on-all-workspaces", &_tmp2_, NULL);
#line 276 "../lib/Utils.vala"
				_tmp3_ = _tmp2_;
#line 276 "../lib/Utils.vala"
				if (_tmp3_) {
#line 277 "../lib/Utils.vala"
					continue;
#line 1814 "Utils.c"
				}
#line 281 "../lib/Utils.vala"
				_tmp7_ = window;
#line 281 "../lib/Utils.vala"
				_tmp8_ = meta_window_get_window_type (_tmp7_);
#line 281 "../lib/Utils.vala"
				_tmp9_ = _tmp8_;
#line 281 "../lib/Utils.vala"
				if (_tmp9_ == META_WINDOW_NORMAL) {
#line 281 "../lib/Utils.vala"
					_tmp6_ = TRUE;
#line 1826 "Utils.c"
				} else {
					MetaWindow* _tmp10_;
					MetaWindowType _tmp11_;
					MetaWindowType _tmp12_;
#line 282 "../lib/Utils.vala"
					_tmp10_ = window;
#line 282 "../lib/Utils.vala"
					_tmp11_ = meta_window_get_window_type (_tmp10_);
#line 282 "../lib/Utils.vala"
					_tmp12_ = _tmp11_;
#line 282 "../lib/Utils.vala"
					_tmp6_ = _tmp12_ == META_WINDOW_DIALOG;
#line 1839 "Utils.c"
				}
#line 281 "../lib/Utils.vala"
				if (_tmp6_) {
#line 281 "../lib/Utils.vala"
					_tmp5_ = TRUE;
#line 1845 "Utils.c"
				} else {
					MetaWindow* _tmp13_;
					MetaWindowType _tmp14_;
					MetaWindowType _tmp15_;
#line 283 "../lib/Utils.vala"
					_tmp13_ = window;
#line 283 "../lib/Utils.vala"
					_tmp14_ = meta_window_get_window_type (_tmp13_);
#line 283 "../lib/Utils.vala"
					_tmp15_ = _tmp14_;
#line 283 "../lib/Utils.vala"
					_tmp5_ = _tmp15_ == META_WINDOW_MODAL_DIALOG;
#line 1858 "Utils.c"
				}
#line 281 "../lib/Utils.vala"
				if (_tmp5_) {
#line 1862 "Utils.c"
					gboolean _tmp16_ = FALSE;
#line 284 "../lib/Utils.vala"
					if (!on_primary) {
#line 284 "../lib/Utils.vala"
						_tmp16_ = TRUE;
#line 1868 "Utils.c"
					} else {
						gboolean _tmp17_ = FALSE;
#line 284 "../lib/Utils.vala"
						if (on_primary) {
#line 1873 "Utils.c"
							MetaWindow* _tmp18_;
#line 284 "../lib/Utils.vala"
							_tmp18_ = window;
#line 284 "../lib/Utils.vala"
							_tmp17_ = meta_window_is_on_primary_monitor (_tmp18_);
#line 1879 "Utils.c"
						} else {
#line 284 "../lib/Utils.vala"
							_tmp17_ = FALSE;
#line 1883 "Utils.c"
						}
#line 284 "../lib/Utils.vala"
						_tmp16_ = _tmp17_;
#line 1887 "Utils.c"
					}
#line 284 "../lib/Utils.vala"
					_tmp4_ = _tmp16_;
#line 1891 "Utils.c"
				} else {
#line 281 "../lib/Utils.vala"
					_tmp4_ = FALSE;
#line 1895 "Utils.c"
				}
#line 280 "../lib/Utils.vala"
				if (_tmp4_) {
#line 1899 "Utils.c"
					gint _tmp19_;
#line 285 "../lib/Utils.vala"
					_tmp19_ = n;
#line 285 "../lib/Utils.vala"
					n = _tmp19_ + 1;
#line 1905 "Utils.c"
				}
			}
		}
#line 275 "../lib/Utils.vala"
		(window_collection == NULL) ? NULL : (window_collection = (g_list_free (window_collection), NULL));
#line 1911 "Utils.c"
	}
#line 289 "../lib/Utils.vala"
	result = (guint) n;
#line 289 "../lib/Utils.vala"
	return result;
#line 1917 "Utils.c"
}

/**
         * Creates an actor showing the current contents of the given WindowActor.
         *
         * @param actor      The actor from which to create a snapshot
         * @param inner_rect The inner (actually visible) rectangle of the window
         *
         * @return           A copy of the actor at that time or %NULL
         */
ClutterActor*
gala_utils_get_window_actor_snapshot (MetaWindowActor* actor,
                                      MtkRectangle* inner_rect)
{
	ClutterContent* content = NULL;
	ClutterContent* _tmp6_;
	ClutterActor* container = NULL;
	ClutterActor* _tmp7_;
	ClutterActor* _tmp8_;
	MtkRectangle _tmp9_;
	MtkRectangle _tmp10_;
	ClutterActor* _tmp11_;
	ClutterContent* _tmp12_;
	GError* _inner_error0_ = NULL;
	ClutterActor* result;
#line 300 "../lib/Utils.vala"
	g_return_val_if_fail (actor != NULL, NULL);
#line 300 "../lib/Utils.vala"
	g_return_val_if_fail (inner_rect != NULL, NULL);
#line 1947 "Utils.c"
	{
		ClutterContent* _tmp0_ = NULL;
		MtkRectangle _tmp1_;
		ClutterContent* _tmp2_;
		ClutterContent* _tmp3_;
#line 311 "../lib/Utils.vala"
		_tmp1_ = *inner_rect;
#line 311 "../lib/Utils.vala"
		_tmp2_ = meta_window_actor_paint_to_content (actor, &_tmp1_, &_inner_error0_);
#line 311 "../lib/Utils.vala"
		_tmp0_ = _tmp2_;
#line 311 "../lib/Utils.vala"
		if (G_UNLIKELY (_inner_error0_ != NULL)) {
#line 1961 "Utils.c"
			goto __catch0_g_error;
		}
#line 311 "../lib/Utils.vala"
		_tmp3_ = _tmp0_;
#line 311 "../lib/Utils.vala"
		_tmp0_ = NULL;
#line 311 "../lib/Utils.vala"
		_g_object_unref0 (content);
#line 311 "../lib/Utils.vala"
		content = _tmp3_;
#line 310 "../lib/Utils.vala"
		_g_object_unref0 (_tmp0_);
#line 1974 "Utils.c"
	}
	goto __finally0;
	__catch0_g_error:
	{
		GError* e = NULL;
		GError* _tmp4_;
		const gchar* _tmp5_;
#line 310 "../lib/Utils.vala"
		e = _inner_error0_;
#line 310 "../lib/Utils.vala"
		_inner_error0_ = NULL;
#line 313 "../lib/Utils.vala"
		_tmp4_ = e;
#line 313 "../lib/Utils.vala"
		_tmp5_ = _tmp4_->message;
#line 313 "../lib/Utils.vala"
		g_warning ("Utils.vala:313: Could not create window snapshot: %s", _tmp5_);
#line 314 "../lib/Utils.vala"
		result = NULL;
#line 314 "../lib/Utils.vala"
		_g_error_free0 (e);
#line 314 "../lib/Utils.vala"
		_g_object_unref0 (content);
#line 314 "../lib/Utils.vala"
		return result;
#line 2000 "Utils.c"
	}
	__finally0:
#line 310 "../lib/Utils.vala"
	if (G_UNLIKELY (_inner_error0_ != NULL)) {
#line 310 "../lib/Utils.vala"
		_g_object_unref0 (content);
#line 310 "../lib/Utils.vala"
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error0_->message, g_quark_to_string (_inner_error0_->domain), _inner_error0_->code);
#line 310 "../lib/Utils.vala"
		g_clear_error (&_inner_error0_);
#line 310 "../lib/Utils.vala"
		return NULL;
#line 2013 "Utils.c"
	}
#line 317 "../lib/Utils.vala"
	_tmp6_ = content;
#line 317 "../lib/Utils.vala"
	if (_tmp6_ == NULL) {
#line 318 "../lib/Utils.vala"
		g_warning ("Utils.vala:318: Could not create window snapshot");
#line 319 "../lib/Utils.vala"
		result = NULL;
#line 319 "../lib/Utils.vala"
		_g_object_unref0 (content);
#line 319 "../lib/Utils.vala"
		return result;
#line 2027 "Utils.c"
	}
#line 322 "../lib/Utils.vala"
	_tmp7_ = clutter_actor_new ();
#line 322 "../lib/Utils.vala"
	g_object_ref_sink (_tmp7_);
#line 322 "../lib/Utils.vala"
	container = _tmp7_;
#line 323 "../lib/Utils.vala"
	_tmp8_ = container;
#line 323 "../lib/Utils.vala"
	_tmp9_ = *inner_rect;
#line 323 "../lib/Utils.vala"
	_tmp10_ = *inner_rect;
#line 323 "../lib/Utils.vala"
	clutter_actor_set_size (_tmp8_, (gfloat) _tmp9_.width, (gfloat) _tmp10_.height);
#line 324 "../lib/Utils.vala"
	_tmp11_ = container;
#line 324 "../lib/Utils.vala"
	_tmp12_ = content;
#line 324 "../lib/Utils.vala"
	clutter_actor_set_content (_tmp11_, _tmp12_);
#line 326 "../lib/Utils.vala"
	result = container;
#line 326 "../lib/Utils.vala"
	_g_object_unref0 (content);
#line 326 "../lib/Utils.vala"
	return result;
#line 2055 "Utils.c"
}

/**
         * DEPRECATED: When used with Mutter 44, this will always return 1.
         * Get the scaling factor for the monitor you are drawing to with
         * `Meta.Display.get_monitor_scale` instead
         */
gint
gala_utils_get_ui_scaling_factor (void)
{
	gint result;
#line 337 "../lib/Utils.vala"
	result = 1;
#line 337 "../lib/Utils.vala"
	return result;
#line 2071 "Utils.c"
}

/**
         * Returns the pixbuf that is used for resize buttons throughout gala at a
         * size of 36px
         *
         * @return the resize button pixbuf or null if it failed to load
         */
GdkPixbuf*
gala_utils_get_resize_button_pixbuf (gfloat scale)
{
	gint height = 0;
	GeeHashMap* _tmp0_;
	GeeHashMap* _tmp2_;
	gpointer _tmp3_;
	GdkPixbuf* _tmp4_;
	gboolean _tmp5_;
	GeeHashMap* _tmp11_;
	gpointer _tmp12_;
	GError* _inner_error0_ = NULL;
	GdkPixbuf* result;
#line 350 "../lib/Utils.vala"
	height = gala_utils_scale_to_int (36, scale);
#line 352 "../lib/Utils.vala"
	_tmp0_ = gala_utils_resize_pixbufs;
#line 352 "../lib/Utils.vala"
	if (_tmp0_ == NULL) {
#line 2099 "Utils.c"
		GeeHashMap* _tmp1_;
#line 353 "../lib/Utils.vala"
		_tmp1_ = gee_hash_map_new (G_TYPE_INT, NULL, NULL, gdk_pixbuf_get_type (), (GBoxedCopyFunc) g_object_ref, (GDestroyNotify) g_object_unref, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL);
#line 353 "../lib/Utils.vala"
		_g_object_unref0 (gala_utils_resize_pixbufs);
#line 353 "../lib/Utils.vala"
		gala_utils_resize_pixbufs = _tmp1_;
#line 2107 "Utils.c"
	}
#line 356 "../lib/Utils.vala"
	_tmp2_ = gala_utils_resize_pixbufs;
#line 356 "../lib/Utils.vala"
	_tmp3_ = gee_abstract_map_get ((GeeAbstractMap*) _tmp2_, (gpointer) ((gintptr) height));
#line 356 "../lib/Utils.vala"
	_tmp4_ = (GdkPixbuf*) _tmp3_;
#line 356 "../lib/Utils.vala"
	_tmp5_ = _tmp4_ == NULL;
#line 356 "../lib/Utils.vala"
	_g_object_unref0 (_tmp4_);
#line 356 "../lib/Utils.vala"
	if (_tmp5_) {
#line 2121 "Utils.c"
		{
			GdkPixbuf* _tmp6_ = NULL;
			GdkPixbuf* _tmp7_;
			GeeHashMap* _tmp8_;
#line 358 "../lib/Utils.vala"
			_tmp7_ = gdk_pixbuf_new_from_resource_at_scale (RESOURCEPATH "/buttons/resize.svg", -1, height, TRUE, &_inner_error0_);
#line 358 "../lib/Utils.vala"
			_tmp6_ = _tmp7_;
#line 358 "../lib/Utils.vala"
			if (G_UNLIKELY (_inner_error0_ != NULL)) {
#line 2132 "Utils.c"
				goto __catch0_g_error;
			}
#line 358 "../lib/Utils.vala"
			_tmp8_ = gala_utils_resize_pixbufs;
#line 358 "../lib/Utils.vala"
			gee_abstract_map_set ((GeeAbstractMap*) _tmp8_, (gpointer) ((gintptr) height), _tmp6_);
#line 357 "../lib/Utils.vala"
			_g_object_unref0 (_tmp6_);
#line 2141 "Utils.c"
		}
		goto __finally0;
		__catch0_g_error:
		{
			GError* e = NULL;
			GError* _tmp9_;
			const gchar* _tmp10_;
#line 357 "../lib/Utils.vala"
			e = _inner_error0_;
#line 357 "../lib/Utils.vala"
			_inner_error0_ = NULL;
#line 365 "../lib/Utils.vala"
			_tmp9_ = e;
#line 365 "../lib/Utils.vala"
			_tmp10_ = _tmp9_->message;
#line 365 "../lib/Utils.vala"
			g_warning ("Utils.vala:365: %s", _tmp10_);
#line 366 "../lib/Utils.vala"
			result = NULL;
#line 366 "../lib/Utils.vala"
			_g_error_free0 (e);
#line 366 "../lib/Utils.vala"
			return result;
#line 2165 "Utils.c"
		}
		__finally0:
#line 357 "../lib/Utils.vala"
		if (G_UNLIKELY (_inner_error0_ != NULL)) {
#line 357 "../lib/Utils.vala"
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error0_->message, g_quark_to_string (_inner_error0_->domain), _inner_error0_->code);
#line 357 "../lib/Utils.vala"
			g_clear_error (&_inner_error0_);
#line 357 "../lib/Utils.vala"
			return NULL;
#line 2176 "Utils.c"
		}
	}
#line 370 "../lib/Utils.vala"
	_tmp11_ = gala_utils_resize_pixbufs;
#line 370 "../lib/Utils.vala"
	_tmp12_ = gee_abstract_map_get ((GeeAbstractMap*) _tmp11_, (gpointer) ((gintptr) height));
#line 370 "../lib/Utils.vala"
	result = (GdkPixbuf*) _tmp12_;
#line 370 "../lib/Utils.vala"
	return result;
#line 2187 "Utils.c"
}

/**
         * Creates a new reactive ClutterActor at 36px with the resize pixbuf
         *
         * @return The resize button actor
         */
ClutterActor*
gala_utils_create_resize_button (gfloat scale)
{
	ClutterActor* texture = NULL;
	ClutterActor* _tmp0_;
	GdkPixbuf* pixbuf = NULL;
	GdkPixbuf* _tmp1_;
	ClutterActor* _tmp2_;
	GdkPixbuf* _tmp3_;
	GError* _inner_error0_ = NULL;
	ClutterActor* result;
#line 379 "../lib/Utils.vala"
	_tmp0_ = clutter_actor_new ();
#line 379 "../lib/Utils.vala"
	g_object_ref_sink (_tmp0_);
#line 379 "../lib/Utils.vala"
	texture = _tmp0_;
#line 380 "../lib/Utils.vala"
	_tmp1_ = gala_utils_get_resize_button_pixbuf (scale);
#line 380 "../lib/Utils.vala"
	pixbuf = _tmp1_;
#line 382 "../lib/Utils.vala"
	_tmp2_ = texture;
#line 382 "../lib/Utils.vala"
	clutter_actor_set_reactive (_tmp2_, TRUE);
#line 384 "../lib/Utils.vala"
	_tmp3_ = pixbuf;
#line 384 "../lib/Utils.vala"
	if (_tmp3_ != NULL) {
#line 2224 "Utils.c"
		{
			ClutterImage* image = NULL;
			ClutterImage* _tmp4_;
			CoglPixelFormat _tmp5_ = 0;
			GdkPixbuf* _tmp6_;
			CoglPixelFormat pixel_format = 0;
			ClutterImage* _tmp7_;
			GdkPixbuf* _tmp8_;
			guint8* _tmp9_;
			GdkPixbuf* _tmp10_;
			gint _tmp11_;
			gint _tmp12_;
			GdkPixbuf* _tmp13_;
			gint _tmp14_;
			gint _tmp15_;
			GdkPixbuf* _tmp16_;
			gint _tmp17_;
			gint _tmp18_;
			ClutterActor* _tmp19_;
			ClutterImage* _tmp20_;
			ClutterActor* _tmp21_;
			GdkPixbuf* _tmp22_;
			gint _tmp23_;
			gint _tmp24_;
			GdkPixbuf* _tmp25_;
			gint _tmp26_;
			gint _tmp27_;
#line 386 "../lib/Utils.vala"
			_tmp4_ = (ClutterImage*) clutter_image_new ();
#line 386 "../lib/Utils.vala"
			image = _tmp4_;
#line 387 "../lib/Utils.vala"
			_tmp6_ = pixbuf;
#line 387 "../lib/Utils.vala"
			if (gdk_pixbuf_get_has_alpha (_tmp6_)) {
#line 387 "../lib/Utils.vala"
				_tmp5_ = COGL_PIXEL_FORMAT_RGBA_8888;
#line 2262 "Utils.c"
			} else {
#line 387 "../lib/Utils.vala"
				_tmp5_ = COGL_PIXEL_FORMAT_RGB_888;
#line 2266 "Utils.c"
			}
#line 387 "../lib/Utils.vala"
			pixel_format = _tmp5_;
#line 388 "../lib/Utils.vala"
			_tmp7_ = image;
#line 388 "../lib/Utils.vala"
			_tmp8_ = pixbuf;
#line 388 "../lib/Utils.vala"
			_tmp9_ = gdk_pixbuf_get_pixels (_tmp8_);
#line 388 "../lib/Utils.vala"
			_tmp10_ = pixbuf;
#line 388 "../lib/Utils.vala"
			_tmp11_ = gdk_pixbuf_get_width (_tmp10_);
#line 388 "../lib/Utils.vala"
			_tmp12_ = _tmp11_;
#line 388 "../lib/Utils.vala"
			_tmp13_ = pixbuf;
#line 388 "../lib/Utils.vala"
			_tmp14_ = gdk_pixbuf_get_height (_tmp13_);
#line 388 "../lib/Utils.vala"
			_tmp15_ = _tmp14_;
#line 388 "../lib/Utils.vala"
			_tmp16_ = pixbuf;
#line 388 "../lib/Utils.vala"
			_tmp17_ = gdk_pixbuf_get_rowstride (_tmp16_);
#line 388 "../lib/Utils.vala"
			_tmp18_ = _tmp17_;
#line 388 "../lib/Utils.vala"
			clutter_image_set_data (_tmp7_, _tmp9_, pixel_format, (guint) _tmp12_, (guint) _tmp15_, (guint) _tmp18_, &_inner_error0_);
#line 388 "../lib/Utils.vala"
			if (G_UNLIKELY (_inner_error0_ != NULL)) {
#line 388 "../lib/Utils.vala"
				_g_object_unref0 (image);
#line 2300 "Utils.c"
				goto __catch0_g_error;
			}
#line 389 "../lib/Utils.vala"
			_tmp19_ = texture;
#line 389 "../lib/Utils.vala"
			_tmp20_ = image;
#line 389 "../lib/Utils.vala"
			clutter_actor_set_content (_tmp19_, (ClutterContent*) _tmp20_);
#line 390 "../lib/Utils.vala"
			_tmp21_ = texture;
#line 390 "../lib/Utils.vala"
			_tmp22_ = pixbuf;
#line 390 "../lib/Utils.vala"
			_tmp23_ = gdk_pixbuf_get_width (_tmp22_);
#line 390 "../lib/Utils.vala"
			_tmp24_ = _tmp23_;
#line 390 "../lib/Utils.vala"
			_tmp25_ = pixbuf;
#line 390 "../lib/Utils.vala"
			_tmp26_ = gdk_pixbuf_get_height (_tmp25_);
#line 390 "../lib/Utils.vala"
			_tmp27_ = _tmp26_;
#line 390 "../lib/Utils.vala"
			clutter_actor_set_size (_tmp21_, (gfloat) _tmp24_, (gfloat) _tmp27_);
#line 385 "../lib/Utils.vala"
			_g_object_unref0 (image);
#line 2327 "Utils.c"
		}
		goto __finally0;
		__catch0_g_error:
		{
#line 385 "../lib/Utils.vala"
			g_clear_error (&_inner_error0_);
#line 2334 "Utils.c"
		}
		__finally0:
#line 385 "../lib/Utils.vala"
		if (G_UNLIKELY (_inner_error0_ != NULL)) {
#line 385 "../lib/Utils.vala"
			_g_object_unref0 (pixbuf);
#line 385 "../lib/Utils.vala"
			_g_object_unref0 (texture);
#line 385 "../lib/Utils.vala"
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error0_->message, g_quark_to_string (_inner_error0_->domain), _inner_error0_->code);
#line 385 "../lib/Utils.vala"
			g_clear_error (&_inner_error0_);
#line 385 "../lib/Utils.vala"
			return NULL;
#line 2349 "Utils.c"
		}
	} else {
		gint size = 0;
		ClutterActor* _tmp28_;
		ClutterActor* _tmp29_;
		ClutterColor _tmp30_ = {0};
#line 396 "../lib/Utils.vala"
		size = gala_utils_scale_to_int (36, scale);
#line 397 "../lib/Utils.vala"
		_tmp28_ = texture;
#line 397 "../lib/Utils.vala"
		clutter_actor_set_size (_tmp28_, (gfloat) size, (gfloat) size);
#line 398 "../lib/Utils.vala"
		_tmp29_ = texture;
#line 398 "../lib/Utils.vala"
		_tmp30_.red = (guint8) 255;
#line 398 "../lib/Utils.vala"
		_tmp30_.green = (guint8) 0;
#line 398 "../lib/Utils.vala"
		_tmp30_.blue = (guint8) 0;
#line 398 "../lib/Utils.vala"
		_tmp30_.alpha = (guint8) 255;
#line 398 "../lib/Utils.vala"
		clutter_actor_set_background_color (_tmp29_, &_tmp30_);
#line 2374 "Utils.c"
	}
#line 401 "../lib/Utils.vala"
	result = texture;
#line 401 "../lib/Utils.vala"
	_g_object_unref0 (pixbuf);
#line 401 "../lib/Utils.vala"
	return result;
#line 2382 "Utils.c"
}

GtkCssProvider*
gala_utils_get_gala_css (void)
{
	GtkCssProvider* _tmp0_;
	GtkCssProvider* _tmp3_;
	GtkCssProvider* result;
#line 406 "../lib/Utils.vala"
	_tmp0_ = gala_utils_gala_css;
#line 406 "../lib/Utils.vala"
	if (_tmp0_ == NULL) {
#line 2395 "Utils.c"
		GtkCssProvider* _tmp1_;
		GtkCssProvider* _tmp2_;
#line 407 "../lib/Utils.vala"
		_tmp1_ = gtk_css_provider_new ();
#line 407 "../lib/Utils.vala"
		_g_object_unref0 (gala_utils_gala_css);
#line 407 "../lib/Utils.vala"
		gala_utils_gala_css = _tmp1_;
#line 408 "../lib/Utils.vala"
		_tmp2_ = gala_utils_gala_css;
#line 408 "../lib/Utils.vala"
		gtk_css_provider_load_from_resource (_tmp2_, "/io/elementary/desktop/gala/gala.css");
#line 2408 "Utils.c"
	}
#line 411 "../lib/Utils.vala"
	_tmp3_ = gala_utils_gala_css;
#line 411 "../lib/Utils.vala"
	result = _tmp3_;
#line 411 "../lib/Utils.vala"
	return result;
#line 2416 "Utils.c"
}

GalaUtils*
gala_utils_construct (GType object_type)
{
	GalaUtils* self = NULL;
#line 19 "../lib/Utils.vala"
	self = (GalaUtils*) g_type_create_instance (object_type);
#line 19 "../lib/Utils.vala"
	return self;
#line 2427 "Utils.c"
}

GalaUtils*
gala_utils_new (void)
{
#line 19 "../lib/Utils.vala"
	return gala_utils_construct (GALA_TYPE_UTILS);
#line 2435 "Utils.c"
}

static void
gala_utils_cached_icon_copy (const GalaUtilsCachedIcon* self,
                             GalaUtilsCachedIcon* dest)
{
	GdkPixbuf* _tmp0_;
	GdkPixbuf* _tmp1_;
#line 20 "../lib/Utils.vala"
	_tmp0_ = (*self).icon;
#line 20 "../lib/Utils.vala"
	_tmp1_ = _g_object_ref0 (_tmp0_);
#line 20 "../lib/Utils.vala"
	_g_object_unref0 ((*dest).icon);
#line 20 "../lib/Utils.vala"
	(*dest).icon = _tmp1_;
#line 20 "../lib/Utils.vala"
	(*dest).icon_size = (*self).icon_size;
#line 20 "../lib/Utils.vala"
	(*dest).scale = (*self).scale;
#line 2456 "Utils.c"
}

static void
gala_utils_cached_icon_destroy (GalaUtilsCachedIcon* self)
{
#line 21 "../lib/Utils.vala"
	_g_object_unref0 ((*self).icon);
#line 2464 "Utils.c"
}

static GalaUtilsCachedIcon*
gala_utils_cached_icon_dup (const GalaUtilsCachedIcon* self)
{
	GalaUtilsCachedIcon* dup;
#line 20 "../lib/Utils.vala"
	dup = g_new0 (GalaUtilsCachedIcon, 1);
#line 20 "../lib/Utils.vala"
	gala_utils_cached_icon_copy (self, dup);
#line 20 "../lib/Utils.vala"
	return dup;
#line 2477 "Utils.c"
}

static void
gala_utils_cached_icon_free (GalaUtilsCachedIcon* self)
{
#line 20 "../lib/Utils.vala"
	gala_utils_cached_icon_destroy (self);
#line 20 "../lib/Utils.vala"
	g_free (self);
#line 2487 "Utils.c"
}

 G_GNUC_NO_INLINE static GType
gala_utils_cached_icon_get_type_once (void)
{
	GType gala_utils_cached_icon_type_id;
	gala_utils_cached_icon_type_id = g_boxed_type_register_static ("GalaUtilsCachedIcon", (GBoxedCopyFunc) gala_utils_cached_icon_dup, (GBoxedFreeFunc) gala_utils_cached_icon_free);
	return gala_utils_cached_icon_type_id;
}

static GType
gala_utils_cached_icon_get_type (void)
{
	static gsize gala_utils_cached_icon_type_id__once = 0;
	if (g_once_init_enter (&gala_utils_cached_icon_type_id__once)) {
		GType gala_utils_cached_icon_type_id;
		gala_utils_cached_icon_type_id = gala_utils_cached_icon_get_type_once ();
		g_once_init_leave (&gala_utils_cached_icon_type_id__once, gala_utils_cached_icon_type_id);
	}
	return gala_utils_cached_icon_type_id__once;
}

static void
_gala_utils___lambda10_ (void)
{
	GeeHashMultiMap* _tmp0_;
	GeeHashMap* _tmp1_;
#line 45 "../lib/Utils.vala"
	_tmp0_ = gala_utils_icon_cache;
#line 45 "../lib/Utils.vala"
	gee_multi_map_clear ((GeeMultiMap*) _tmp0_);
#line 46 "../lib/Utils.vala"
	_tmp1_ = gala_utils_window_to_desktop_cache;
#line 46 "../lib/Utils.vala"
	gee_abstract_map_clear ((GeeAbstractMap*) _tmp1_);
#line 2523 "Utils.c"
}

static void
__gala_utils___lambda10__gala_app_cache_changed (GalaAppCache* _sender,
                                                 gpointer self)
{
#line 44 "../lib/Utils.vala"
	_gala_utils___lambda10_ ();
#line 2532 "Utils.c"
}

static void
gala_value_utils_init (GValue* value)
{
#line 19 "../lib/Utils.vala"
	value->data[0].v_pointer = NULL;
#line 2540 "Utils.c"
}

static void
gala_value_utils_free_value (GValue* value)
{
#line 19 "../lib/Utils.vala"
	if (value->data[0].v_pointer) {
#line 19 "../lib/Utils.vala"
		gala_utils_unref (value->data[0].v_pointer);
#line 2550 "Utils.c"
	}
}

static void
gala_value_utils_copy_value (const GValue* src_value,
                             GValue* dest_value)
{
#line 19 "../lib/Utils.vala"
	if (src_value->data[0].v_pointer) {
#line 19 "../lib/Utils.vala"
		dest_value->data[0].v_pointer = gala_utils_ref (src_value->data[0].v_pointer);
#line 2562 "Utils.c"
	} else {
#line 19 "../lib/Utils.vala"
		dest_value->data[0].v_pointer = NULL;
#line 2566 "Utils.c"
	}
}

static gpointer
gala_value_utils_peek_pointer (const GValue* value)
{
#line 19 "../lib/Utils.vala"
	return value->data[0].v_pointer;
#line 2575 "Utils.c"
}

static gchar*
gala_value_utils_collect_value (GValue* value,
                                guint n_collect_values,
                                GTypeCValue* collect_values,
                                guint collect_flags)
{
#line 19 "../lib/Utils.vala"
	if (collect_values[0].v_pointer) {
#line 2586 "Utils.c"
		GalaUtils * object;
		object = collect_values[0].v_pointer;
#line 19 "../lib/Utils.vala"
		if (object->parent_instance.g_class == NULL) {
#line 19 "../lib/Utils.vala"
			return g_strconcat ("invalid unclassed object pointer for value type `", G_VALUE_TYPE_NAME (value), "'", NULL);
#line 2593 "Utils.c"
		} else if (!g_value_type_compatible (G_TYPE_FROM_INSTANCE (object), G_VALUE_TYPE (value))) {
#line 19 "../lib/Utils.vala"
			return g_strconcat ("invalid object type `", g_type_name (G_TYPE_FROM_INSTANCE (object)), "' for value type `", G_VALUE_TYPE_NAME (value), "'", NULL);
#line 2597 "Utils.c"
		}
#line 19 "../lib/Utils.vala"
		value->data[0].v_pointer = gala_utils_ref (object);
#line 2601 "Utils.c"
	} else {
#line 19 "../lib/Utils.vala"
		value->data[0].v_pointer = NULL;
#line 2605 "Utils.c"
	}
#line 19 "../lib/Utils.vala"
	return NULL;
#line 2609 "Utils.c"
}

static gchar*
gala_value_utils_lcopy_value (const GValue* value,
                              guint n_collect_values,
                              GTypeCValue* collect_values,
                              guint collect_flags)
{
	GalaUtils ** object_p;
	object_p = collect_values[0].v_pointer;
#line 19 "../lib/Utils.vala"
	if (!object_p) {
#line 19 "../lib/Utils.vala"
		return g_strdup_printf ("value location for `%s' passed as NULL", G_VALUE_TYPE_NAME (value));
#line 2624 "Utils.c"
	}
#line 19 "../lib/Utils.vala"
	if (!value->data[0].v_pointer) {
#line 19 "../lib/Utils.vala"
		*object_p = NULL;
#line 2630 "Utils.c"
	} else if (collect_flags & G_VALUE_NOCOPY_CONTENTS) {
#line 19 "../lib/Utils.vala"
		*object_p = value->data[0].v_pointer;
#line 2634 "Utils.c"
	} else {
#line 19 "../lib/Utils.vala"
		*object_p = gala_utils_ref (value->data[0].v_pointer);
#line 2638 "Utils.c"
	}
#line 19 "../lib/Utils.vala"
	return NULL;
#line 2642 "Utils.c"
}

GParamSpec*
gala_param_spec_utils (const gchar* name,
                       const gchar* nick,
                       const gchar* blurb,
                       GType object_type,
                       GParamFlags flags)
{
	GalaParamSpecUtils* spec;
#line 19 "../lib/Utils.vala"
	g_return_val_if_fail (g_type_is_a (object_type, GALA_TYPE_UTILS), NULL);
#line 19 "../lib/Utils.vala"
	spec = g_param_spec_internal (G_TYPE_PARAM_OBJECT, name, nick, blurb, flags);
#line 19 "../lib/Utils.vala"
	G_PARAM_SPEC (spec)->value_type = object_type;
#line 19 "../lib/Utils.vala"
	return G_PARAM_SPEC (spec);
#line 2661 "Utils.c"
}

gpointer
gala_value_get_utils (const GValue* value)
{
#line 19 "../lib/Utils.vala"
	g_return_val_if_fail (G_TYPE_CHECK_VALUE_TYPE (value, GALA_TYPE_UTILS), NULL);
#line 19 "../lib/Utils.vala"
	return value->data[0].v_pointer;
#line 2671 "Utils.c"
}

void
gala_value_set_utils (GValue* value,
                      gpointer v_object)
{
	GalaUtils * old;
#line 19 "../lib/Utils.vala"
	g_return_if_fail (G_TYPE_CHECK_VALUE_TYPE (value, GALA_TYPE_UTILS));
#line 19 "../lib/Utils.vala"
	old = value->data[0].v_pointer;
#line 19 "../lib/Utils.vala"
	if (v_object) {
#line 19 "../lib/Utils.vala"
		g_return_if_fail (G_TYPE_CHECK_INSTANCE_TYPE (v_object, GALA_TYPE_UTILS));
#line 19 "../lib/Utils.vala"
		g_return_if_fail (g_value_type_compatible (G_TYPE_FROM_INSTANCE (v_object), G_VALUE_TYPE (value)));
#line 19 "../lib/Utils.vala"
		value->data[0].v_pointer = v_object;
#line 19 "../lib/Utils.vala"
		gala_utils_ref (value->data[0].v_pointer);
#line 2693 "Utils.c"
	} else {
#line 19 "../lib/Utils.vala"
		value->data[0].v_pointer = NULL;
#line 2697 "Utils.c"
	}
#line 19 "../lib/Utils.vala"
	if (old) {
#line 19 "../lib/Utils.vala"
		gala_utils_unref (old);
#line 2703 "Utils.c"
	}
}

void
gala_value_take_utils (GValue* value,
                       gpointer v_object)
{
	GalaUtils * old;
#line 19 "../lib/Utils.vala"
	g_return_if_fail (G_TYPE_CHECK_VALUE_TYPE (value, GALA_TYPE_UTILS));
#line 19 "../lib/Utils.vala"
	old = value->data[0].v_pointer;
#line 19 "../lib/Utils.vala"
	if (v_object) {
#line 19 "../lib/Utils.vala"
		g_return_if_fail (G_TYPE_CHECK_INSTANCE_TYPE (v_object, GALA_TYPE_UTILS));
#line 19 "../lib/Utils.vala"
		g_return_if_fail (g_value_type_compatible (G_TYPE_FROM_INSTANCE (v_object), G_VALUE_TYPE (value)));
#line 19 "../lib/Utils.vala"
		value->data[0].v_pointer = v_object;
#line 2724 "Utils.c"
	} else {
#line 19 "../lib/Utils.vala"
		value->data[0].v_pointer = NULL;
#line 2728 "Utils.c"
	}
#line 19 "../lib/Utils.vala"
	if (old) {
#line 19 "../lib/Utils.vala"
		gala_utils_unref (old);
#line 2734 "Utils.c"
	}
}

static void
gala_utils_class_init (GalaUtilsClass * klass,
                       gpointer klass_data)
{
	GtkIconTheme* _tmp0_;
	GtkIconTheme* _tmp1_;
	GeeHashMultiMap* _tmp2_;
	GeeHashMap* _tmp3_;
	GeeArrayList* _tmp4_;
	GalaAppCache* _tmp5_;
	GalaAppCache* _tmp6_;
#line 19 "../lib/Utils.vala"
	gala_utils_parent_class = g_type_class_peek_parent (klass);
#line 19 "../lib/Utils.vala"
	((GalaUtilsClass *) klass)->finalize = gala_utils_finalize;
#line 37 "../lib/Utils.vala"
	_tmp0_ = gtk_icon_theme_new ();
#line 37 "../lib/Utils.vala"
	_g_object_unref0 (gala_utils_icon_theme);
#line 37 "../lib/Utils.vala"
	gala_utils_icon_theme = _tmp0_;
#line 38 "../lib/Utils.vala"
	_tmp1_ = gala_utils_icon_theme;
#line 38 "../lib/Utils.vala"
	gtk_icon_theme_set_custom_theme (_tmp1_, "elementary");
#line 39 "../lib/Utils.vala"
	_tmp2_ = gee_hash_multi_map_new (G_TYPE_DESKTOP_APP_INFO, (GBoxedCopyFunc) g_object_ref, (GDestroyNotify) g_object_unref, GALA_UTILS_TYPE_CACHED_ICON, (GBoxedCopyFunc) gala_utils_cached_icon_dup, (GDestroyNotify) gala_utils_cached_icon_free, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL);
#line 39 "../lib/Utils.vala"
	_g_object_unref0 (gala_utils_icon_cache);
#line 39 "../lib/Utils.vala"
	gala_utils_icon_cache = _tmp2_;
#line 40 "../lib/Utils.vala"
	_tmp3_ = gee_hash_map_new (meta_window_get_type (), (GBoxedCopyFunc) g_object_ref, (GDestroyNotify) g_object_unref, G_TYPE_DESKTOP_APP_INFO, (GBoxedCopyFunc) g_object_ref, (GDestroyNotify) g_object_unref, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL);
#line 40 "../lib/Utils.vala"
	_g_object_unref0 (gala_utils_window_to_desktop_cache);
#line 40 "../lib/Utils.vala"
	gala_utils_window_to_desktop_cache = _tmp3_;
#line 41 "../lib/Utils.vala"
	_tmp4_ = gee_array_list_new (GALA_UTILS_TYPE_CACHED_ICON, (GBoxedCopyFunc) gala_utils_cached_icon_dup, (GDestroyNotify) gala_utils_cached_icon_free, NULL, NULL, NULL);
#line 41 "../lib/Utils.vala"
	_g_object_unref0 (gala_utils_unknown_icon_cache);
#line 41 "../lib/Utils.vala"
	gala_utils_unknown_icon_cache = _tmp4_;
#line 43 "../lib/Utils.vala"
	_tmp5_ = gala_app_cache_new ();
#line 43 "../lib/Utils.vala"
	_g_object_unref0 (gala_utils_app_cache);
#line 43 "../lib/Utils.vala"
	gala_utils_app_cache = _tmp5_;
#line 44 "../lib/Utils.vala"
	_tmp6_ = gala_utils_app_cache;
#line 44 "../lib/Utils.vala"
	g_signal_connect (_tmp6_, "changed", (GCallback) __gala_utils___lambda10__gala_app_cache_changed, NULL);
#line 2791 "Utils.c"
}

static void
gala_utils_instance_init (GalaUtils * self,
                          gpointer klass)
{
#line 19 "../lib/Utils.vala"
	self->ref_count = 1;
#line 2800 "Utils.c"
}

static void
gala_utils_finalize (GalaUtils * obj)
{
	GalaUtils * self;
#line 19 "../lib/Utils.vala"
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, GALA_TYPE_UTILS, GalaUtils);
#line 19 "../lib/Utils.vala"
	g_signal_handlers_destroy (self);
#line 2811 "Utils.c"
}

 G_GNUC_NO_INLINE static GType
gala_utils_get_type_once (void)
{
	static const GTypeValueTable g_define_type_value_table = { gala_value_utils_init, gala_value_utils_free_value, gala_value_utils_copy_value, gala_value_utils_peek_pointer, "p", gala_value_utils_collect_value, "p", gala_value_utils_lcopy_value };
	static const GTypeInfo g_define_type_info = { sizeof (GalaUtilsClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) gala_utils_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (GalaUtils), 0, (GInstanceInitFunc) gala_utils_instance_init, &g_define_type_value_table };
	static const GTypeFundamentalInfo g_define_type_fundamental_info = { (G_TYPE_FLAG_CLASSED | G_TYPE_FLAG_INSTANTIATABLE | G_TYPE_FLAG_DERIVABLE | G_TYPE_FLAG_DEEP_DERIVABLE) };
	GType gala_utils_type_id;
	gala_utils_type_id = g_type_register_fundamental (g_type_fundamental_next (), "GalaUtils", &g_define_type_info, &g_define_type_fundamental_info, 0);
	return gala_utils_type_id;
}

GType
gala_utils_get_type (void)
{
	static gsize gala_utils_type_id__once = 0;
	if (g_once_init_enter (&gala_utils_type_id__once)) {
		GType gala_utils_type_id;
		gala_utils_type_id = gala_utils_get_type_once ();
		g_once_init_leave (&gala_utils_type_id__once, gala_utils_type_id);
	}
	return gala_utils_type_id__once;
}

gpointer
gala_utils_ref (gpointer instance)
{
	GalaUtils * self;
	self = instance;
#line 19 "../lib/Utils.vala"
	g_atomic_int_inc (&self->ref_count);
#line 19 "../lib/Utils.vala"
	return instance;
#line 2846 "Utils.c"
}

void
gala_utils_unref (gpointer instance)
{
	GalaUtils * self;
	self = instance;
#line 19 "../lib/Utils.vala"
	if (g_atomic_int_dec_and_test (&self->ref_count)) {
#line 19 "../lib/Utils.vala"
		GALA_UTILS_GET_CLASS (self)->finalize (self);
#line 19 "../lib/Utils.vala"
		g_type_free_instance ((GTypeInstance *) self);
#line 2860 "Utils.c"
	}
}

static void
_vala_array_destroy (gpointer array,
                     gssize array_length,
                     GDestroyNotify destroy_func)
{
	if ((array != NULL) && (destroy_func != NULL)) {
		gssize i;
		for (i = 0; i < array_length; i = i + 1) {
			if (((gpointer*) array)[i] != NULL) {
				destroy_func (((gpointer*) array)[i]);
			}
		}
	}
}

static void
_vala_array_free (gpointer array,
                  gssize array_length,
                  GDestroyNotify destroy_func)
{
	_vala_array_destroy (array, array_length, destroy_func);
	g_free (array);
}

static gssize
_vala_array_length (gpointer array)
{
	gssize length;
	length = 0;
	if (array) {
		while (((gpointer*) array)[length]) {
			length++;
		}
	}
	return length;
}

